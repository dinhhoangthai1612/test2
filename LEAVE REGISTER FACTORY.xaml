<Activity mc:Ignorable="sap sap2010" x:Class="LEAVE_REGISTER" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:d="clr-namespace:Diacritics_Converter;assembly=UiPath_Diacritics_Converter" xmlns:ee="clr-namespace:ExcelCustomActivities.Excel;assembly=ExcelCustomActivities" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="EndStatus" Type="InOutArgument(x:String)" />
    <x:Property Name="EndMessage" Type="InOutArgument(x:String)" />
    <x:Property Name="Order_Number" Type="InOutArgument(x:String)" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1194,801</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>LEAVE_REGISTER_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="50">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>UiPath.Database</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="56">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Database</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>UiPath.IntelligentOCR</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.OmniPage.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.CV</AssemblyReference>
      <AssemblyReference>UiPath.Word</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>System.Data.Entity</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <sap:WorkflowViewStateService.ViewState>
    <scg:Dictionary x:TypeArguments="x:String, x:Object">
      <x:Boolean x:Key="ShouldExpandAll">False</x:Boolean>
    </scg:Dictionary>
  </sap:WorkflowViewStateService.ViewState>
  <Flowchart DisplayName="LEAVE_REGISTER_FACTORY" sap:VirtualizedContainerService.HintSize="634,636" sap2010:WorkflowViewState.IdRef="Flowchart_1">
    <Flowchart.Variables>
      <Variable x:TypeArguments="x:String" Name="Path_Template" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_Path" />
      <Variable x:TypeArguments="x:String" Default="\\ykkvnm.com\vnmfs\YKKDATA\DEPARTMENT\Human Resources\ROBOTICS\LEAVE REGISTER FACTORY\EXCEL\" Name="Path_Excel_NT" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="wb" />
      <Variable x:TypeArguments="ui:GenericValue" Name="Day_First" />
      <Variable x:TypeArguments="ui:GenericValue" Name="MSNV" />
      <Variable x:TypeArguments="ui:GenericValue" Name="Day_Last" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_Server" />
      <Variable x:TypeArguments="x:String" Name="Mail_Server" />
      <Variable x:TypeArguments="x:String" Name="Mail_Email" />
      <Variable x:TypeArguments="x:String" Name="Mail_Password" />
      <Variable x:TypeArguments="x:String" Name="Mail_PIC" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_library" />
      <Variable x:TypeArguments="x:String" Name="Kinds_Leave_Name" />
      <Variable x:TypeArguments="ui:GenericValue" Name="Total_Leave" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_Total_Leave" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="wb_phepton" />
      <Variable x:TypeArguments="x:String" Name="cell_current" />
      <Variable x:TypeArguments="ui:GenericValue" Name="Total_Phepton" />
      <Variable x:TypeArguments="x:Boolean" Name="Check_LeaveForm" />
      <Variable x:TypeArguments="ui:GenericValue" Name="Leave_Other" />
      <Variable x:TypeArguments="ui:GenericValue" Name="Time_Leave" />
      <Variable x:TypeArguments="x:String" Name="Time_Leave_Name" />
      <Variable x:TypeArguments="x:Boolean" Name="File_Leave_Register" />
      <Variable x:TypeArguments="x:Double" Name="Total_Leave_temp" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_MSNV" />
      <Variable x:TypeArguments="x:String" Name="Day_First_Template" />
      <Variable x:TypeArguments="x:String" Name="Day_Last_Template" />
      <Variable x:TypeArguments="x:String" Name="MSNV_Name" />
      <Variable x:TypeArguments="x:String" Name="MSNV_Name_Temp" />
      <Variable x:TypeArguments="x:String" Name="MSNV_Name_Temp1" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="wb_log" />
      <Variable x:TypeArguments="x:String" Name="row_current" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_schedule" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_workers" />
      <Variable x:TypeArguments="ui:GenericValue" Name="location_factory" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_Error" />
      <Variable x:TypeArguments="sd:DataRow" Name="dataRow" />
      <Variable x:TypeArguments="x:Int32" Name="row_excel" />
    </Flowchart.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
        <av:Size x:Key="ShapeSize">60,75</av:Size>
        <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,126.04</av:PointCollection>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Flowchart.StartNode>
      <x:Reference>__ReferenceID1</x:Reference>
    </Flowchart.StartNode>
    <FlowStep x:Name="__ReferenceID1">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">200,126.04</av:Point>
          <av:Size x:Key="ShapeSize">200,66</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">300,192.04 300,246.04</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <Sequence DisplayName="Setting SQL" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Lấy Mail bộ phận RPA" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="338,118" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_2" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
          <ui:InvokeWorkflowFile.Arguments>
            <InArgument x:TypeArguments="x:String" x:Key="Query">SELECT * FROM RPALIB.LIBRARY_NT WHERE Name IN ('PIC')</InArgument>
            <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_library]</OutArgument>
          </ui:InvokeWorkflowFile.Arguments>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
        </ui:InvokeWorkflowFile>
        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Lấy tài khoản Mail" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="338,118" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_3" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
          <ui:InvokeWorkflowFile.Arguments>
            <InArgument x:TypeArguments="x:String" x:Key="Query">SELECT * FROM RPALIB.LIBRARY_NT WHERE Name IN ('MailAddress_Outlook','MailPassword_Outlook','MailServer') ORDER BY UPPER(NAME) ASC</InArgument>
            <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_Server]</OutArgument>
          </ui:InvokeWorkflowFile.Arguments>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
        </ui:InvokeWorkflowFile>
        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="338,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_1" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
          <ui:InvokeWorkflowFile.Arguments>
            <InArgument x:TypeArguments="x:String" x:Key="Query">SELECT * FROM RPALIB.LIBRARY_NT WHERE Name IN ('ServerTemp') ORDER BY UPPER(NAME) ASC</InArgument>
            <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_Path]</OutArgument>
          </ui:InvokeWorkflowFile.Arguments>
        </ui:InvokeWorkflowFile>
        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,253" sap2010:WorkflowViewState.IdRef="MultipleAssign_3">
          <ui:MultipleAssign.AssignOperations>
            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_6">
                <ui:AssignOperation.To>
                  <OutArgument x:TypeArguments="x:String">[Mail_Server]</OutArgument>
                </ui:AssignOperation.To>
                <ui:AssignOperation.Value>
                  <InArgument x:TypeArguments="x:String">[dt_Server.Rows(2)(1).ToString]</InArgument>
                </ui:AssignOperation.Value>
              </ui:AssignOperation>
              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_7">
                <ui:AssignOperation.To>
                  <OutArgument x:TypeArguments="x:String">[Mail_Email]</OutArgument>
                </ui:AssignOperation.To>
                <ui:AssignOperation.Value>
                  <InArgument x:TypeArguments="x:String">[dt_Server.Rows(0)(1).ToString]</InArgument>
                </ui:AssignOperation.Value>
              </ui:AssignOperation>
              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_8">
                <ui:AssignOperation.To>
                  <OutArgument x:TypeArguments="x:String">[Mail_Password]</OutArgument>
                </ui:AssignOperation.To>
                <ui:AssignOperation.Value>
                  <InArgument x:TypeArguments="x:String">[dt_Server.Rows(1)(1).ToString]</InArgument>
                </ui:AssignOperation.Value>
              </ui:AssignOperation>
              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_9">
                <ui:AssignOperation.To>
                  <OutArgument x:TypeArguments="x:String">[Mail_PIC]</OutArgument>
                </ui:AssignOperation.To>
                <ui:AssignOperation.Value>
                  <InArgument x:TypeArguments="x:String">nhihty@ykk.com,ductnm@ykk.com,anhduc@ykk.com.vn</InArgument>
                </ui:AssignOperation.Value>
              </ui:AssignOperation>
              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_10">
                <ui:AssignOperation.To>
                  <OutArgument x:TypeArguments="x:String">[Path_Template]</OutArgument>
                </ui:AssignOperation.To>
                <ui:AssignOperation.Value>
                  <InArgument x:TypeArguments="x:String">[dt_Path.Rows(0)(1).ToString]</InArgument>
                </ui:AssignOperation.Value>
              </ui:AssignOperation>
              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_40">
                <ui:AssignOperation.To>
                  <OutArgument x:TypeArguments="x:String">[EndMessage]</OutArgument>
                </ui:AssignOperation.To>
                <ui:AssignOperation.Value>
                  <InArgument x:TypeArguments="x:String">False</InArgument>
                </ui:AssignOperation.Value>
              </ui:AssignOperation>
            </scg:List>
          </ui:MultipleAssign.AssignOperations>
        </ui:MultipleAssign>
      </Sequence>
      <FlowStep.Next>
        <FlowStep x:Name="__ReferenceID0">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:Point x:Key="ShapeLocation">200,246.04</av:Point>
              <av:Size x:Key="ShapeSize">200,66</av:Size>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Sequence DisplayName="Read and check data" sap:VirtualizedContainerService.HintSize="242,143" sap2010:WorkflowViewState.IdRef="Sequence_2">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="1588,5063" sap2010:WorkflowViewState.IdRef="ForEach`1_2" Values="[Directory.GetFiles(Path_Excel_NT,&quot;*.xls*&quot;)]">
              <ui:ForEach.Body>
                <ActivityAction x:TypeArguments="x:String">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="x:String" Name="File" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="1552,4929" sap2010:WorkflowViewState.IdRef="Sequence_3">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="1510,160" sap2010:WorkflowViewState.IdRef="MultipleAssign_119">
                      <ui:MultipleAssign.AssignOperations>
                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_305">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="x:String">[EndMessage]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="x:String">True</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_306">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="x:Int32">[row_excel]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="x:Int32">4</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_337">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="ui:GenericValue">[location_factory]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="ui:GenericValue">["NT"]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                        </scg:List>
                      </ui:MultipleAssign.AssignOperations>
                    </ui:MultipleAssign>
                    <ui:ExcelApplicationScope Password="{x:Null}" sap2010:Annotation.AnnotationText="Excel này ghi log để nhận biết file nào bị lỗi để dễ tìm" CreateNewFile="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="1510,93" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_5" Workbook="[wb_log]" WorkbookPath="\\ykkvnm.com\vnmfs\YKKDATA\DEPARTMENT\Human Resources\ROBOTICS\LEAVE REGISTER\EXCEL\Status Log\Status Log.xlsx">
                      <ui:ExcelApplicationScope.Body>
                        <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                          </ActivityAction.Argument>
                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="713,752" sap2010:WorkflowViewState.IdRef="Sequence_101">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:ExcelLookUpRange Range="{x:Null}" DisplayName="LookUp Range" sap:VirtualizedContainerService.HintSize="671,87" sap2010:WorkflowViewState.IdRef="ExcelLookUpRange_3" Result="[row_current]" SheetName="[wb_log.GetSheets(0)]" Value="[Path.GetFileName(File)]" />
                            <If Condition="[String.IsNullOrEmpty(row_current)]" sap:VirtualizedContainerService.HintSize="671,474" sap2010:WorkflowViewState.IdRef="If_82">
                              <If.Then>
                                <Sequence DisplayName="Write data" sap:VirtualizedContainerService.HintSize="382,327" sap2010:WorkflowViewState.IdRef="Sequence_107">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ee:MoveVerticalActivity MoveColumn="{x:Null}" MoveCount="{x:Null}" BaseCell="A1048576" ClipboardCopyFlg="False" CurrentCell="[row_current]" DisplayName="Move vertical activity" sap:VirtualizedContainerService.HintSize="340,144" sap2010:WorkflowViewState.IdRef="MoveVerticalActivity_2" MoveDirection="Up" MoveLastDataRowFlg="True" MoveNextFlg="False" SheetName="[wb_log.GetSheets(0)]" WorkBook="[wb_log]" />
                                  <If Condition="[row_current = &quot;A1&quot;]" sap:VirtualizedContainerService.HintSize="340,51" sap2010:WorkflowViewState.IdRef="If_81">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <Sequence DisplayName="Write first row" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_102">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:ExcelWriteCell Cell="A2" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_22" SheetName="[wb_log.GetSheets(0)]" Text="[DateTime.Now.ToString]" />
                                        <ui:ExcelWriteCell Cell="B2" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_23" SheetName="[wb_log.GetSheets(0)]" Text="[Path.GetFileName(File)]" />
                                      </Sequence>
                                    </If.Then>
                                    <If.Else>
                                      <Sequence DisplayName="Write row continue" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_103">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:ExcelWriteCell Cell="[&quot;A&quot; + Convert.ToInt32(Convert.ToInt32(row_current.Remove(0,1)) + 1).ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_24" SheetName="[wb_log.GetSheets(0)]" Text="[DateTime.Now.ToString]" />
                                        <ui:ExcelWriteCell Cell="[&quot;B&quot; + Convert.ToInt32(Convert.ToInt32(row_current.Remove(0,1)) + 1).ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_25" SheetName="[wb_log.GetSheets(0)]" Text="[Path.GetFileName(File)]" />
                                      </Sequence>
                                    </If.Else>
                                  </If>
                                </Sequence>
                              </If.Then>
                            </If>
                            <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="671,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_5" Workbook="[wb_log]" />
                          </Sequence>
                        </ActivityAction>
                      </ui:ExcelApplicationScope.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:ExcelApplicationScope>
                    <ui:MoveFile ContinueOnError="{x:Null}" Destination="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="1510,157" sap2010:WorkflowViewState.IdRef="MoveFile_1" Overwrite="True" Path="[File]" />
                    <ui:ExcelApplicationScope Password="{x:Null}" sap2010:Annotation.AnnotationText="Bắt đầu quy trình kiểm tra điều kiện hợp lệ" CreateNewFile="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="1510,93" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_1" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                      <ui:ExcelApplicationScope.Body>
                        <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                          </ActivityAction.Argument>
                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,603" sap2010:WorkflowViewState.IdRef="Sequence_4">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:InvokeVBA OutputValue="{x:Null}" CodeFilePath="VBA.txt" DisplayName="Invoke VBA" EntryMethodName="DeleteHidedSheet" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeVBA_2" />
                            <ui:InvokeVBA OutputValue="{x:Null}" CodeFilePath="VBA.txt" DisplayName="Invoke VBA" EntryMethodName="convert_unicode" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeVBA_1" />
                            <ui:ExcelReadRange AddHeaders="False" DataTable="[dt_workers]" DisplayName="Read Range List Workers" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_4" Range="C4:J1000" SheetName="[wb.GetSheets(0)]" />
                            <ui:FilterDataTable DataTable="[dt_workers]" DisplayName="Filter Data Table" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="FilterDataTable_5" OutputDataTable="[dt_workers]" SelectColumnsMode="Keep">
                              <ui:FilterDataTable.Filters>
                                <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                  <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="NOTEMPTY">
                                    <ui:FilterOperationArgument.Column>
                                      <InArgument x:TypeArguments="x:String">["Column0"]</InArgument>
                                    </ui:FilterOperationArgument.Column>
                                  </ui:FilterOperationArgument>
                                </scg:List>
                              </ui:FilterDataTable.Filters>
                              <ui:FilterDataTable.SelectColumns>
                                <scg:List x:TypeArguments="InArgument" Capacity="4">
                                  <x:Null />
                                </scg:List>
                              </ui:FilterDataTable.SelectColumns>
                            </ui:FilterDataTable>
                            <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_2" Workbook="[wb]" />
                          </Sequence>
                        </ActivityAction>
                      </ui:ExcelApplicationScope.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:ExcelApplicationScope>
                    <ui:BuildDataTable DataTable="[dt_Error]" DisplayName="Build Data Table" sap:VirtualizedContainerService.HintSize="1510,59" sap2010:WorkflowViewState.IdRef="BuildDataTable_1" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;MSNV&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;100&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;FullName&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Note&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
                    <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dt_workers]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="1510,3764" sap2010:WorkflowViewState.IdRef="ForEachRow_3">
                      <ui:ForEachRow.Body>
                        <ActivityAction x:TypeArguments="sd:DataRow">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                          </ActivityAction.Argument>
                          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="1460,3616" sap2010:WorkflowViewState.IdRef="Sequence_159">
                            <Sequence.Variables>
                              <Variable x:TypeArguments="sd:DataTable" Name="dt_Calendar_HR" />
                              <Variable x:TypeArguments="x:Boolean" Name="check_Calendar_HR" />
                            </Sequence.Variables>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <TryCatch DisplayName="Try Catch convert DateTime" sap:VirtualizedContainerService.HintSize="1418,51" sap2010:WorkflowViewState.IdRef="TryCatch_1">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <TryCatch.Try>
                                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_126">
                                  <ui:MultipleAssign.AssignOperations>
                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_338">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:Object">[row(3)]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:Object">[Convert.ToDateTime(row(3).ToString).ToShortDateString]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_339">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:Object">[row(4)]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:Object">[Convert.ToDateTime(row(4).ToString).ToShortDateString]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                    </scg:List>
                                  </ui:MultipleAssign.AssignOperations>
                                </ui:MultipleAssign>
                              </TryCatch.Try>
                              <TryCatch.Catches>
                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_1">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ActivityAction x:TypeArguments="s:Exception">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                    </ActivityAction.Argument>
                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_127">
                                      <ui:MultipleAssign.AssignOperations>
                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_340">
                                            <ui:AssignOperation.To>
                                              <OutArgument x:TypeArguments="x:Object">[row(3)]</OutArgument>
                                            </ui:AssignOperation.To>
                                            <ui:AssignOperation.Value>
                                              <InArgument x:TypeArguments="x:Object">[Convert.ToDateTime(row(3).ToString.Split("/"c)(1) + "/" + row(3).ToString.Split("/"c)(0) + "/" + row(3).ToString.Split("/"c)(2)).ToShortDateString]</InArgument>
                                            </ui:AssignOperation.Value>
                                          </ui:AssignOperation>
                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_341">
                                            <ui:AssignOperation.To>
                                              <OutArgument x:TypeArguments="x:Object">[row(4)]</OutArgument>
                                            </ui:AssignOperation.To>
                                            <ui:AssignOperation.Value>
                                              <InArgument x:TypeArguments="x:Object">[Convert.ToDateTime(row(4).ToString.Split("/"c)(1) + "/" + row(4).ToString.Split("/"c)(0) + "/" + row(4).ToString.Split("/"c)(2)).ToShortDateString]</InArgument>
                                            </ui:AssignOperation.Value>
                                          </ui:AssignOperation>
                                        </scg:List>
                                      </ui:MultipleAssign.AssignOperations>
                                    </ui:MultipleAssign>
                                  </ActivityAction>
                                </Catch>
                              </TryCatch.Catches>
                            </TryCatch>
                            <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="1418,346" sap2010:WorkflowViewState.IdRef="MultipleAssign_84">
                              <ui:MultipleAssign.AssignOperations>
                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_175">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="ui:GenericValue">[MSNV]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="ui:GenericValue">[row(0).ToString]</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_176">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="x:String">[MSNV_Name]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="x:String">[row(1).ToString]</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_177">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="ui:GenericValue">[Day_First]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="ui:GenericValue">[row(3).ToString]</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_178">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="ui:GenericValue">[Day_Last]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="ui:GenericValue">[row(4).ToString]</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_179">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="ui:GenericValue">[Total_Leave]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="ui:GenericValue">[row(5).ToString]</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_181">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="ui:GenericValue">[Time_Leave]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="ui:GenericValue">[row(6).ToString]</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_234">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="x:String">[Kinds_Leave_Name]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="x:String">[row(7).ToString]</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_294">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_343">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="ui:GenericValue">[Leave_Other]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="ui:GenericValue">[""]</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                </scg:List>
                              </ui:MultipleAssign.AssignOperations>
                            </ui:MultipleAssign>
                            <ui:ExcelApplicationScope Password="{x:Null}" AutoSave="False" CreateNewFile="False" DisplayName="Excel &quot;Phep ton&quot;" sap:VirtualizedContainerService.HintSize="1418,671" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_12" ReadOnly="True" Workbook="[wb_phepton]" WorkbookPath="\\ykkvnm.com\vnmfs\YKKDATA\DEPARTMENT\Human Resources\ROBOTICS\LEAVE REGISTER\PHEP TON.xlsx">
                              <ui:ExcelApplicationScope.Body>
                                <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                  </ActivityAction.Argument>
                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="843,562" sap2010:WorkflowViewState.IdRef="Sequence_222">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:ExcelLookUpRange Range="{x:Null}" DisplayName="LookUp Range" sap:VirtualizedContainerService.HintSize="801,87" sap2010:WorkflowViewState.IdRef="ExcelLookUpRange_6" Result="[cell_current]" SheetName="[wb_phepton.GetSheets(0)]" Value="[MSNV]" />
                                    <If sap2010:Annotation.AnnotationText="Kiểm tra nếu MSNV có tồn tại thì xử lý theo quy trình" Condition="[String.IsNullOrEmpty(cell_current)]" sap:VirtualizedContainerService.HintSize="801,244" sap2010:WorkflowViewState.IdRef="If_188">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <Sequence DisplayName="Message error and send mail" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_219">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_117">
                                            <ui:MultipleAssign.AssignOperations>
                                              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_295">
                                                  <ui:AssignOperation.To>
                                                    <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                  </ui:AssignOperation.To>
                                                  <ui:AssignOperation.Value>
                                                    <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                  </ui:AssignOperation.Value>
                                                </ui:AssignOperation>
                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_296">
                                                  <ui:AssignOperation.To>
                                                    <OutArgument x:TypeArguments="sd:DataRow">[dataRow]</OutArgument>
                                                  </ui:AssignOperation.To>
                                                  <ui:AssignOperation.Value>
                                                    <InArgument x:TypeArguments="sd:DataRow">[dt_Error.NewRow]</InArgument>
                                                  </ui:AssignOperation.Value>
                                                </ui:AssignOperation>
                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_297">
                                                  <ui:AssignOperation.To>
                                                    <OutArgument x:TypeArguments="x:Object">[dataRow("MSNV")]</OutArgument>
                                                  </ui:AssignOperation.To>
                                                  <ui:AssignOperation.Value>
                                                    <InArgument x:TypeArguments="x:Object">[MSNV.ToString.Trim]</InArgument>
                                                  </ui:AssignOperation.Value>
                                                </ui:AssignOperation>
                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_298">
                                                  <ui:AssignOperation.To>
                                                    <OutArgument x:TypeArguments="x:Object">[dataRow("FullName")]</OutArgument>
                                                  </ui:AssignOperation.To>
                                                  <ui:AssignOperation.Value>
                                                    <InArgument x:TypeArguments="x:Object">[row(1).ToString.Trim]</InArgument>
                                                  </ui:AssignOperation.Value>
                                                </ui:AssignOperation>
                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_299">
                                                  <ui:AssignOperation.To>
                                                    <OutArgument x:TypeArguments="x:Object">[dataRow("Note")]</OutArgument>
                                                  </ui:AssignOperation.To>
                                                  <ui:AssignOperation.Value>
                                                    <InArgument x:TypeArguments="x:Object">["Không tìm thấy mã số nhân viên"]</InArgument>
                                                  </ui:AssignOperation.Value>
                                                </ui:AssignOperation>
                                              </scg:List>
                                            </ui:MultipleAssign.AssignOperations>
                                          </ui:MultipleAssign>
                                          <ui:AddDataRow ArrayRow="{x:Null}" DataRow="[dataRow]" DataTable="[dt_Error]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="AddDataRow_13" />
                                          <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel log staff" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_14" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                            <ui:ExcelApplicationScope.Body>
                                              <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                </ActivityAction.Argument>
                                                <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,278" sap2010:WorkflowViewState.IdRef="Sequence_226">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_excel.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_62" SheetName="[wb.GetSheets(0)]" Text="Không tìm thấy mã số nhân viên" />
                                                  <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_14" Workbook="[wb]" />
                                                </Sequence>
                                              </ActivityAction>
                                            </ui:ExcelApplicationScope.Body>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:ExcelApplicationScope>
                                        </Sequence>
                                      </If.Then>
                                      <If.Else>
                                        <Sequence DisplayName="Get data MSNV" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_221">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:ExcelReadCell Cell="[&quot;P&quot; + cell_current.Remove(0,1)]" DisplayName="Read Cell" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadCell_18" SheetName="[wb_phepton.GetSheets(0)]">
                                            <ui:ExcelReadCell.Result>
                                              <OutArgument x:TypeArguments="ui:GenericValue">[Total_Phepton]</OutArgument>
                                            </ui:ExcelReadCell.Result>
                                          </ui:ExcelReadCell>
                                          <ui:ExcelReadCell Cell="[&quot;B&quot; + cell_current.Remove(0,1)]" DisplayName="Read Cell" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadCell_19" SheetName="[wb_phepton.GetSheets(0)]">
                                            <ui:ExcelReadCell.Result>
                                              <OutArgument x:TypeArguments="x:String">[MSNV_Name_Temp1]</OutArgument>
                                            </ui:ExcelReadCell.Result>
                                          </ui:ExcelReadCell>
                                          <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_144">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[MSNV_Name_Temp]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[MSNV_Name]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <d:Convert_Accents DisplayName="Convert Accents &quot;MSNV_Name_Temp&quot;" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Convert_Accents_5" Input="[MSNV_Name_Temp]" Output="[MSNV_Name_Temp]" />
                                          <d:Convert_Diacritics DisplayName="Convert Diacritics &quot;MSNV_Name_Temp&quot;" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Convert_Diacritics_5" Input="[MSNV_Name_Temp]" Output="[MSNV_Name_Temp]" />
                                          <d:Convert_Accents DisplayName="Convert Accents &quot;MSNV_Name_Temp1&quot;" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Convert_Accents_6" Input="[MSNV_Name_Temp1]" Output="[MSNV_Name_Temp1]" />
                                          <d:Convert_Diacritics DisplayName="Convert Diacritics &quot;MSNV_Name_Temp1&quot;" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Convert_Diacritics_6" Input="[MSNV_Name_Temp1]" Output="[MSNV_Name_Temp1]" />
                                          <If sap2010:Annotation.AnnotationText="Kiểm tra tên có giống với tên trên form nghỉ phép không" Condition="[MSNV_Name_Temp.ToLower.Replace(&quot; &quot;,&quot;&quot;) = MSNV_Name_Temp1.ToLower.Replace(&quot; &quot;,&quot;&quot;) And MSNV.Trim.Length = 8]" sap:VirtualizedContainerService.HintSize="334,93" sap2010:WorkflowViewState.IdRef="If_187">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Else>
                                              <Sequence DisplayName="Message error and send mail" sap:VirtualizedContainerService.HintSize="380,467" sap2010:WorkflowViewState.IdRef="Sequence_220">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_118">
                                                  <ui:MultipleAssign.AssignOperations>
                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_300">
                                                        <ui:AssignOperation.To>
                                                          <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                        </ui:AssignOperation.To>
                                                        <ui:AssignOperation.Value>
                                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                        </ui:AssignOperation.Value>
                                                      </ui:AssignOperation>
                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_301">
                                                        <ui:AssignOperation.To>
                                                          <OutArgument x:TypeArguments="sd:DataRow">[dataRow]</OutArgument>
                                                        </ui:AssignOperation.To>
                                                        <ui:AssignOperation.Value>
                                                          <InArgument x:TypeArguments="sd:DataRow">[dt_Error.NewRow]</InArgument>
                                                        </ui:AssignOperation.Value>
                                                      </ui:AssignOperation>
                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_302">
                                                        <ui:AssignOperation.To>
                                                          <OutArgument x:TypeArguments="x:Object">[dataRow("MSNV")]</OutArgument>
                                                        </ui:AssignOperation.To>
                                                        <ui:AssignOperation.Value>
                                                          <InArgument x:TypeArguments="x:Object">[MSNV.ToString.Trim]</InArgument>
                                                        </ui:AssignOperation.Value>
                                                      </ui:AssignOperation>
                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_303">
                                                        <ui:AssignOperation.To>
                                                          <OutArgument x:TypeArguments="x:Object">[dataRow("FullName")]</OutArgument>
                                                        </ui:AssignOperation.To>
                                                        <ui:AssignOperation.Value>
                                                          <InArgument x:TypeArguments="x:Object">[row(1).ToString.Trim]</InArgument>
                                                        </ui:AssignOperation.Value>
                                                      </ui:AssignOperation>
                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_304">
                                                        <ui:AssignOperation.To>
                                                          <OutArgument x:TypeArguments="x:Object">[dataRow("Note")]</OutArgument>
                                                        </ui:AssignOperation.To>
                                                        <ui:AssignOperation.Value>
                                                          <InArgument x:TypeArguments="x:Object">["Sai tên hoặc mã số nhân viên không khớp trong dữ liệu nhân sự"]</InArgument>
                                                        </ui:AssignOperation.Value>
                                                      </ui:AssignOperation>
                                                    </scg:List>
                                                  </ui:MultipleAssign.AssignOperations>
                                                </ui:MultipleAssign>
                                                <ui:AddDataRow ArrayRow="{x:Null}" DataRow="[dataRow]" DataTable="[dt_Error]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="AddDataRow_14" />
                                                <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel log staff" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_15" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                                  <ui:ExcelApplicationScope.Body>
                                                    <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,278" sap2010:WorkflowViewState.IdRef="Sequence_227">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_excel.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_63" SheetName="[wb.GetSheets(0)]" Text="Sai tên hoặc mã số nhân viên không khớp trong dữ liệu nhân sự" />
                                                        <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_15" Workbook="[wb]" />
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </ui:ExcelApplicationScope.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:ExcelApplicationScope>
                                              </Sequence>
                                            </If.Else>
                                          </If>
                                        </Sequence>
                                      </If.Else>
                                    </If>
                                    <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="801,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_12" Workbook="[wb_phepton]" />
                                  </Sequence>
                                </ActivityAction>
                              </ui:ExcelApplicationScope.Body>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:ExcelApplicationScope>
                            <Sequence sap2010:Annotation.AnnotationText="Kiểm tra calendar bên nhân sự đã có dữ liệu tháng đó chưa nếu chưa thì dùng tạm bên Wings" DisplayName="Calendar HR" sap:VirtualizedContainerService.HintSize="1418,138" sap2010:WorkflowViewState.IdRef="Sequence_212">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign sap:VirtualizedContainerService.HintSize="863,60" sap2010:WorkflowViewState.IdRef="Assign_129">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Boolean">[check_Calendar_HR]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Calendar_HR]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="863,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_49" ProviderName="System.Data.Odbc" Sql="SELECT * FROM RPALIB.ROBOT_CALENDAR_NT WHERE SUBSTRING(DAY,1,6) = ?" ConnectionString="Dsn=RPALIB;uid=robotnt;pwd=robotnt123">
                                <ui:ExecuteQuery.Parameters>
                                  <InArgument x:TypeArguments="x:String" x:Key="Day_Frist">[Convert.ToDateTime(Day_First.ToString).ToString("yyyyMM")]</InArgument>
                                </ui:ExecuteQuery.Parameters>
                              </ui:ExecuteQuery>
                              <If sap2010:Annotation.AnnotationText="Kiểm tra nếu không có dữ liệu tháng đó đánh dấu để dùng dữ liệu Wings tạm" Condition="[dt_Calendar_HR.Rows.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="863,108" sap2010:WorkflowViewState.IdRef="If_174">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Else>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_130">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Boolean">[check_Calendar_HR]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </If.Else>
                              </If>
                              <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Calendar_HR]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="863,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_50" ProviderName="System.Data.Odbc" Sql="SELECT * FROM RPALIB.ROBOT_CALENDAR_NT WHERE SUBSTRING(DAY,1,6) = ?" ConnectionString="Dsn=RPALIB;uid=robotnt;pwd=robotnt123">
                                <ui:ExecuteQuery.Parameters>
                                  <InArgument x:TypeArguments="x:String" x:Key="Day_Last">[Convert.ToDateTime(Day_Last.ToString).ToString("yyyyMM")]</InArgument>
                                </ui:ExecuteQuery.Parameters>
                              </ui:ExecuteQuery>
                              <If sap2010:Annotation.AnnotationText="Kiểm tra nếu không có dữ liệu tháng đó đánh dấu để dùng dữ liệu Wings tạm" Condition="[dt_Calendar_HR.Rows.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="863,108" sap2010:WorkflowViewState.IdRef="If_175">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Else>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_131">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Boolean">[check_Calendar_HR]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </If.Else>
                              </If>
                              <If sap2010:Annotation.AnnotationText="Nếu kiểm tra bằng True thì dùng dữ liệu bên HR" Condition="[check_Calendar_HR = True]" sap:VirtualizedContainerService.HintSize="863,424" sap2010:WorkflowViewState.IdRef="If_177">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Total_Leave]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_51" ProviderName="System.Data.Odbc" Sql="[&quot;SELECT '&quot; + Convert.ToDateTime(Day_First.ToString).ToString(&quot;yyyyMMdd&quot;) + &quot;' AS DAY_FIRST, '&quot; + Convert.ToDateTime(Day_Last.ToString).ToString(&quot;yyyyMMdd&quot;) + &quot;' AS DAY_LAST,COUNT(DAY) AS SUM_DAY FROM RPALIB.ROBOT_CALENDAR_NT WHERE DAY BETWEEN ? AND ? AND LOCATION = 'NT'&quot;]" ConnectionString="Dsn=RPALIB;uid=ROBOTNT;pwd=ROBOTNT123">
                                    <ui:ExecuteQuery.Parameters>
                                      <InArgument x:TypeArguments="x:String" x:Key="Values_DayFirst">[Convert.ToDateTime(Day_First.ToString).ToString("yyyyMMdd")]</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="Values_DayLast">[Convert.ToDateTime(Day_Last.ToString).ToString("yyyyMMdd")]</InArgument>
                                    </ui:ExecuteQuery.Parameters>
                                  </ui:ExecuteQuery>
                                </If.Then>
                                <If.Else>
                                  <If sap2010:Annotation.AnnotationText="Lấy dữ liệu của 2 bên server khác nhau để tính tổng số ngày nghỉ" Condition="[location_factory.ToString.Trim = &quot;NT&quot;]" sap:VirtualizedContainerService.HintSize="484,245" sap2010:WorkflowViewState.IdRef="If_176">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <Sequence DisplayName="Server NT" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_223">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Total_Leave]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_66" ProviderName="System.Data.Odbc" Sql="SELECT '','',COUNT(HTYC02) AS Sum_Day FROM WAVEDLIB.C0200 WHERE DPTC02='01' AND YMDU02 BETWEEN ? AND ? AND HTYC02 = '0'" ConnectionString="Dsn=AWADLIB;uid=robotnt;pwd=robotnt123">
                                          <ui:ExecuteQuery.Parameters>
                                            <InArgument x:TypeArguments="x:String" x:Key="Day_First">[Convert.ToDateTime(Day_First.ToString).ToString("yyyyMMdd")]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="Day_Last">[Convert.ToDateTime(Day_Last.ToString).ToString("yyyyMMdd")]</InArgument>
                                          </ui:ExecuteQuery.Parameters>
                                        </ui:ExecuteQuery>
                                      </Sequence>
                                    </If.Then>
                                    <If.Else>
                                      <Sequence DisplayName="Server HN" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_224">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Total_Leave]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_67" ProviderName="System.Data.Odbc" Sql="SELECT '','',COUNT(HTYC02) AS Sum_Day FROM WAVEDLIB.C0200 WHERE DPTC02='01' AND YMDU02 BETWEEN ? AND ? AND HTYC02 = '0'" ConnectionString="Dsn=AWADLIB_HN;uid=robot;pwd=password">
                                          <ui:ExecuteQuery.Parameters>
                                            <InArgument x:TypeArguments="x:String" x:Key="Day_First">[Convert.ToDateTime(Day_First.ToString).ToString("yyyyMMdd")]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="Day_Last">[Convert.ToDateTime(Day_Last.ToString).ToString("yyyyMMdd")]</InArgument>
                                          </ui:ExecuteQuery.Parameters>
                                        </ui:ExecuteQuery>
                                      </Sequence>
                                    </If.Else>
                                  </If>
                                </If.Else>
                              </If>
                            </Sequence>
                            <Sequence DisplayName="Time Leave" sap:VirtualizedContainerService.HintSize="1418,66" sap2010:WorkflowViewState.IdRef="Sequence_153">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <If Condition="[Time_Leave.Contains(&quot;(&quot;)]" DisplayName="If Time_Leave contains" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_129">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_99">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="ui:GenericValue">[Time_Leave]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="ui:GenericValue">[Time_Leave.Substring(0,Time_Leave.IndexOf("(",0)).Trim]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </If.Then>
                              </If>
                              <Switch x:TypeArguments="x:String" sap2010:Annotation.AnnotationText="Kiểm tra mã thời gian nghỉ" DisplayName="Switch" Expression="[Time_Leave]" sap:VirtualizedContainerService.HintSize="200,82" sap2010:WorkflowViewState.IdRef="Switch`1_9">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:MultipleAssign x:Key="Cả ngày" DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_85">
                                  <ui:MultipleAssign.AssignOperations>
                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_182">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[Time_Leave_Name]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">0</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_183">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:Double">[Total_Leave_temp]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:Double">[Convert.ToDouble(dt_Total_Leave.Rows(0)(2))]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                    </scg:List>
                                  </ui:MultipleAssign.AssignOperations>
                                </ui:MultipleAssign>
                                <ui:MultipleAssign x:Key="Sáng" DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_86">
                                  <ui:MultipleAssign.AssignOperations>
                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_184">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[Time_Leave_Name]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">1</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_185">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:Double">[Total_Leave_temp]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:Double">[Convert.ToDouble(dt_Total_Leave.Rows(0)(2)) - 0.5]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                    </scg:List>
                                  </ui:MultipleAssign.AssignOperations>
                                </ui:MultipleAssign>
                                <ui:MultipleAssign x:Key="Chiều" DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_87">
                                  <ui:MultipleAssign.AssignOperations>
                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_186">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[Time_Leave_Name]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">2</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_187">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:Double">[Total_Leave_temp]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:Double">[Convert.ToDouble(dt_Total_Leave.Rows(0)(2)) - 0.5]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                    </scg:List>
                                  </ui:MultipleAssign.AssignOperations>
                                </ui:MultipleAssign>
                                <ui:MultipleAssign x:Key="Whole day" DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_88">
                                  <ui:MultipleAssign.AssignOperations>
                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_188">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[Time_Leave_Name]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">0</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_189">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:Double">[Total_Leave_temp]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:Double">[Convert.ToDouble(dt_Total_Leave.Rows(0)(2))]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                    </scg:List>
                                  </ui:MultipleAssign.AssignOperations>
                                </ui:MultipleAssign>
                                <ui:MultipleAssign x:Key="Morning" DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_89">
                                  <ui:MultipleAssign.AssignOperations>
                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_190">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[Time_Leave_Name]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">1</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_191">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:Double">[Total_Leave_temp]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:Double">[Convert.ToDouble(dt_Total_Leave.Rows(0)(2)) - 0.5]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                    </scg:List>
                                  </ui:MultipleAssign.AssignOperations>
                                </ui:MultipleAssign>
                                <ui:MultipleAssign x:Key="Afternoon" DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_90">
                                  <ui:MultipleAssign.AssignOperations>
                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_192">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[Time_Leave_Name]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">2</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_193">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:Double">[Total_Leave_temp]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:Double">[Convert.ToDouble(dt_Total_Leave.Rows(0)(2)) - 0.5]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                    </scg:List>
                                  </ui:MultipleAssign.AssignOperations>
                                </ui:MultipleAssign>
                              </Switch>
                            </Sequence>
                            <Switch x:TypeArguments="x:String" sap2010:Annotation.AnnotationText="Kiểm tra loại nghỉ phép" DisplayName="Switch Kinds of leave" Expression="[Kinds_Leave_Name]" sap:VirtualizedContainerService.HintSize="1418,341" sap2010:WorkflowViewState.IdRef="Switch`1_10">
                              <Switch.Default>
                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_112">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="ui:GenericValue">[Leave_Other]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="ui:GenericValue">[Kinds_Leave_Name]</InArgument>
                                  </Assign.Value>
                                </Assign>
                              </Switch.Default>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign x:Key="Phép năm" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_101">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[Kinds_Leave_Name]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">AL</InArgument>
                                </Assign.Value>
                              </Assign>
                              <Assign x:Key="Nghỉ bệnh" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_109">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[Kinds_Leave_Name]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">SL</InArgument>
                                </Assign.Value>
                              </Assign>
                              <Assign x:Key="Không lương" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_110">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[Kinds_Leave_Name]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">NL</InArgument>
                                </Assign.Value>
                              </Assign>
                              <Assign x:Key="Thai sản" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_111">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[Kinds_Leave_Name]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">MT</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Switch>
                            <If sap2010:Annotation.AnnotationText="Kiểm tra các trường hợp của phép nghỉ" Condition="[Check_LeaveForm = False]" sap:VirtualizedContainerService.HintSize="1418,1423" sap2010:WorkflowViewState.IdRef="If_157">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <If.Then>
                                <If sap2010:Annotation.AnnotationText="Kiểm tra ngày bắt đầu và ngày kết thúc có đúng điều kiện không" Condition="[(Convert.ToDateTime(Day_First.ToString) &lt;= Convert.ToDateTime(Day_Last.ToString)) And (Convert.ToDateTime(Day_First.ToString).Month &gt;= DateTime.Now.AddMonths(-1).Month)]" sap:VirtualizedContainerService.HintSize="1273,1244" sap2010:WorkflowViewState.IdRef="If_156">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <If sap2010:Annotation.AnnotationText="Kiểm tra tháng nếu người đó nghỉ qua tháng mới làm phép thì rơi vào trượng hợp đặc biệt" Condition="[Convert.ToDateTime(Day_First.ToString).Month &lt;&gt; DateTime.Now.AddMonths(-1).Month]" sap:VirtualizedContainerService.HintSize="1028,1065" sap2010:WorkflowViewState.IdRef="If_155">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <Sequence DisplayName="Process" sap:VirtualizedContainerService.HintSize="783,886" sap2010:WorkflowViewState.IdRef="Sequence_177">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If sap2010:Annotation.AnnotationText="Lấy dữ liệu của 2 bên server khác nhau để  kiểm tra ngày nghỉ có rơi vào lịch nghỉ của công ty hay nghỉ lễ không" Condition="[location_factory.ToString.Trim = &quot;NT&quot;]" sap:VirtualizedContainerService.HintSize="741,256" sap2010:WorkflowViewState.IdRef="If_186">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <Sequence DisplayName="Server NT" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_215">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_schedule]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_54" ProviderName="System.Data.Odbc" Sql="[&quot;SELECT HTYC02 FROM WAVEDLIB.C0200 WHERE DPTC02='01' AND YMDU02= '&quot; + Convert.ToDateTime(Day_First.ToString).ToString(&quot;yyyyMMdd&quot;) + &quot;'&quot;]" ConnectionString="Dsn=AWADLIB;uid=robotnt;pwd=robotnt123">
                                                  <ui:ExecuteQuery.Parameters>
                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                  </ui:ExecuteQuery.Parameters>
                                                </ui:ExecuteQuery>
                                                <If Condition="[Kinds_Leave_Name.Trim &lt;&gt; &quot;MT&quot;]" DisplayName="If check MT start day" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_196">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Switch x:TypeArguments="x:String" DisplayName="Switch" Expression="[dt_schedule.Rows(0)(0).ToString]" sap:VirtualizedContainerService.HintSize="496,160" sap2010:WorkflowViewState.IdRef="Switch`1_12">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign x:Key="1" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_132">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Sequence x:Key="2" sap2010:Annotation.AnnotationText="Kiểm tra calendar bên nhân sự đã có dữ liệu tháng đó chưa nếu chưa thì dùng tạm bên Wings" DisplayName="Calendar HR" sap:VirtualizedContainerService.HintSize="526,138" sap2010:WorkflowViewState.IdRef="Sequence_213">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Calendar_HR]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="484,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_55" ProviderName="System.Data.Odbc" Sql="SELECT * FROM RPALIB.ROBOT_CALENDAR_NT WHERE DAY = ?" ConnectionString="Dsn=RPALIB;uid=robotnt;pwd=robotnt123">
                                                          <ui:ExecuteQuery.Parameters>
                                                            <InArgument x:TypeArguments="x:String" x:Key="Day_Frist">[Convert.ToDateTime(Day_First.ToString).ToString("yyyyMM")]</InArgument>
                                                          </ui:ExecuteQuery.Parameters>
                                                        </ui:ExecuteQuery>
                                                        <If sap2010:Annotation.AnnotationText="Kiểm tra nếu không có dữ liệu tháng đó đánh dấu để dùng dữ liệu Wings tạm" Condition="[dt_Calendar_HR.Rows.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="484,108" sap2010:WorkflowViewState.IdRef="If_178">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Else>
                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_133">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </If.Else>
                                                        </If>
                                                        <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Calendar_HR]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="484,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_56" ProviderName="System.Data.Odbc" Sql="SELECT * FROM RPALIB.ROBOT_CALENDAR_NT WHERE DAY = ?" ConnectionString="Dsn=RPALIB;uid=robotnt;pwd=robotnt123">
                                                          <ui:ExecuteQuery.Parameters>
                                                            <InArgument x:TypeArguments="x:String" x:Key="Day_Last">[Convert.ToDateTime(Day_Last.ToString).ToString("yyyyMM")]</InArgument>
                                                          </ui:ExecuteQuery.Parameters>
                                                        </ui:ExecuteQuery>
                                                        <If sap2010:Annotation.AnnotationText="Kiểm tra nếu không có dữ liệu tháng đó đánh dấu để dùng dữ liệu Wings tạm" Condition="[dt_Calendar_HR.Rows.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="484,239" sap2010:WorkflowViewState.IdRef="If_179">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Else>
                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_134">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </If.Else>
                                                        </If>
                                                      </Sequence>
                                                    </Switch>
                                                  </If.Then>
                                                </If>
                                                <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_schedule]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_57" ProviderName="System.Data.Odbc" Sql="[&quot;SELECT HTYC02 FROM WAVEDLIB.C0200 WHERE DPTC02='01' AND YMDU02= '&quot; + Convert.ToDateTime(Day_Last.ToString).ToString(&quot;yyyyMMdd&quot;) + &quot;'&quot;]" ConnectionString="Dsn=AWADLIB;uid=robotnt;pwd=robotnt123">
                                                  <ui:ExecuteQuery.Parameters>
                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                  </ui:ExecuteQuery.Parameters>
                                                </ui:ExecuteQuery>
                                                <If Condition="[Kinds_Leave_Name.Trim &lt;&gt; &quot;MT&quot;]" DisplayName="If check MT end day" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_197">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Switch x:TypeArguments="x:String" DisplayName="Switch" Expression="[dt_schedule.Rows(0)(0).ToString]" sap:VirtualizedContainerService.HintSize="496,160" sap2010:WorkflowViewState.IdRef="Switch`1_13">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign x:Key="1" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_135">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Sequence x:Key="2" sap2010:Annotation.AnnotationText="Kiểm tra calendar bên nhân sự đã có dữ liệu tháng đó chưa nếu chưa thì dùng tạm bên Wings" DisplayName="Calendar HR" sap:VirtualizedContainerService.HintSize="376,138" sap2010:WorkflowViewState.IdRef="Sequence_214">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Calendar_HR]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_58" ProviderName="System.Data.Odbc" Sql="SELECT * FROM RPALIB.ROBOT_CALENDAR_NT WHERE DAY = ?" ConnectionString="Dsn=RPALIB;uid=robotnt;pwd=robotnt123">
                                                          <ui:ExecuteQuery.Parameters>
                                                            <InArgument x:TypeArguments="x:String" x:Key="Day_Last">[Convert.ToDateTime(Day_Last.ToString).ToString("yyyyMM")]</InArgument>
                                                          </ui:ExecuteQuery.Parameters>
                                                        </ui:ExecuteQuery>
                                                        <If sap2010:Annotation.AnnotationText="Kiểm tra nếu không có dữ liệu tháng đó đánh dấu để dùng dữ liệu Wings tạm" Condition="[dt_Calendar_HR.Rows.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="334,108" sap2010:WorkflowViewState.IdRef="If_180">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Else>
                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_136">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </If.Else>
                                                        </If>
                                                        <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Calendar_HR]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_59" ProviderName="System.Data.Odbc" Sql="SELECT * FROM RPALIB.ROBOT_CALENDAR_NT WHERE DAY = ?" ConnectionString="Dsn=RPALIB;uid=robotnt;pwd=robotnt123">
                                                          <ui:ExecuteQuery.Parameters>
                                                            <InArgument x:TypeArguments="x:String" x:Key="Day_Last">[Convert.ToDateTime(Day_Last.ToString).ToString("yyyyMM")]</InArgument>
                                                          </ui:ExecuteQuery.Parameters>
                                                        </ui:ExecuteQuery>
                                                        <If sap2010:Annotation.AnnotationText="Kiểm tra nếu không có dữ liệu tháng đó đánh dấu để dùng dữ liệu Wings tạm" Condition="[dt_Calendar_HR.Rows.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="334,108" sap2010:WorkflowViewState.IdRef="If_181">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Else>
                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_137">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </If.Else>
                                                        </If>
                                                      </Sequence>
                                                    </Switch>
                                                  </If.Then>
                                                </If>
                                              </Sequence>
                                            </If.Then>
                                            <If.Else>
                                              <Sequence DisplayName="Server HN" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_218">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_schedule]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_60" ProviderName="System.Data.Odbc" Sql="[&quot;SELECT HTYC02 FROM WAVEDLIB.C0200 WHERE DPTC02='01' AND YMDU02= '&quot; + Convert.ToDateTime(Day_First.ToString).ToString(&quot;yyyyMMdd&quot;) + &quot;'&quot;]" ConnectionString="Dsn=AWADLIB_HN;uid=robot;pwd=password">
                                                  <ui:ExecuteQuery.Parameters>
                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                  </ui:ExecuteQuery.Parameters>
                                                </ui:ExecuteQuery>
                                                <If Condition="[Kinds_Leave_Name.Trim &lt;&gt; &quot;MT&quot;]" DisplayName="If check start day" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_198">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Switch x:TypeArguments="x:String" DisplayName="Switch" Expression="[dt_schedule.Rows(0)(0).ToString]" sap:VirtualizedContainerService.HintSize="496,160" sap2010:WorkflowViewState.IdRef="Switch`1_14">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign x:Key="1" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_138">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Sequence x:Key="2" sap2010:Annotation.AnnotationText="Kiểm tra calendar bên nhân sự đã có dữ liệu tháng đó chưa nếu chưa thì dùng tạm bên Wings" DisplayName="Calendar HR" sap:VirtualizedContainerService.HintSize="526,138" sap2010:WorkflowViewState.IdRef="Sequence_216">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Calendar_HR]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="484,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_61" ProviderName="System.Data.Odbc" Sql="SELECT * FROM RPALIB.ROBOT_CALENDAR_NT WHERE DAY = ?" ConnectionString="Dsn=RPALIB;uid=robotnt;pwd=robotnt123">
                                                          <ui:ExecuteQuery.Parameters>
                                                            <InArgument x:TypeArguments="x:String" x:Key="Day_Frist">[Convert.ToDateTime(Day_First.ToString).ToString("yyyyMM")]</InArgument>
                                                          </ui:ExecuteQuery.Parameters>
                                                        </ui:ExecuteQuery>
                                                        <If sap2010:Annotation.AnnotationText="Kiểm tra nếu không có dữ liệu tháng đó đánh dấu để dùng dữ liệu Wings tạm" Condition="[dt_Calendar_HR.Rows.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="484,108" sap2010:WorkflowViewState.IdRef="If_182">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Else>
                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_139">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </If.Else>
                                                        </If>
                                                        <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Calendar_HR]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="484,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_62" ProviderName="System.Data.Odbc" Sql="SELECT * FROM RPALIB.ROBOT_CALENDAR_NT WHERE DAY = ?" ConnectionString="Dsn=RPALIB;uid=robotnt;pwd=robotnt123">
                                                          <ui:ExecuteQuery.Parameters>
                                                            <InArgument x:TypeArguments="x:String" x:Key="Day_Last">[Convert.ToDateTime(Day_Last.ToString).ToString("yyyyMM")]</InArgument>
                                                          </ui:ExecuteQuery.Parameters>
                                                        </ui:ExecuteQuery>
                                                        <If sap2010:Annotation.AnnotationText="Kiểm tra nếu không có dữ liệu tháng đó đánh dấu để dùng dữ liệu Wings tạm" Condition="[dt_Calendar_HR.Rows.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="484,239" sap2010:WorkflowViewState.IdRef="If_183">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Else>
                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_140">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </If.Else>
                                                        </If>
                                                      </Sequence>
                                                    </Switch>
                                                  </If.Then>
                                                </If>
                                                <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_schedule]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_63" ProviderName="System.Data.Odbc" Sql="[&quot;SELECT HTYC02 FROM WAVEDLIB.C0200 WHERE DPTC02='01' AND YMDU02= '&quot; + Convert.ToDateTime(Day_Last.ToString).ToString(&quot;yyyyMMdd&quot;) + &quot;'&quot;]" ConnectionString="Dsn=AWADLIB_HN;uid=robot;pwd=password">
                                                  <ui:ExecuteQuery.Parameters>
                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                  </ui:ExecuteQuery.Parameters>
                                                </ui:ExecuteQuery>
                                                <If Condition="[Kinds_Leave_Name.Trim &lt;&gt; &quot;MT&quot;]" DisplayName="If check MT end day" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_199">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Switch x:TypeArguments="x:String" DisplayName="Switch" Expression="[dt_schedule.Rows(0)(0).ToString]" sap:VirtualizedContainerService.HintSize="496,160" sap2010:WorkflowViewState.IdRef="Switch`1_15">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign x:Key="1" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_141">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Sequence x:Key="2" sap2010:Annotation.AnnotationText="Kiểm tra calendar bên nhân sự đã có dữ liệu tháng đó chưa nếu chưa thì dùng tạm bên Wings" DisplayName="Calendar HR" sap:VirtualizedContainerService.HintSize="376,138" sap2010:WorkflowViewState.IdRef="Sequence_217">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Calendar_HR]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_64" ProviderName="System.Data.Odbc" Sql="SELECT * FROM RPALIB.ROBOT_CALENDAR_NT WHERE DAY = ?" ConnectionString="Dsn=RPALIB;uid=robotnt;pwd=robotnt123">
                                                          <ui:ExecuteQuery.Parameters>
                                                            <InArgument x:TypeArguments="x:String" x:Key="Day_Last">[Convert.ToDateTime(Day_Last.ToString).ToString("yyyyMM")]</InArgument>
                                                          </ui:ExecuteQuery.Parameters>
                                                        </ui:ExecuteQuery>
                                                        <If sap2010:Annotation.AnnotationText="Kiểm tra nếu không có dữ liệu tháng đó đánh dấu để dùng dữ liệu Wings tạm" Condition="[dt_Calendar_HR.Rows.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="334,108" sap2010:WorkflowViewState.IdRef="If_184">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Else>
                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_142">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </If.Else>
                                                        </If>
                                                        <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Calendar_HR]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_65" ProviderName="System.Data.Odbc" Sql="SELECT * FROM RPALIB.ROBOT_CALENDAR_NT WHERE DAY = ?" ConnectionString="Dsn=RPALIB;uid=robotnt;pwd=robotnt123">
                                                          <ui:ExecuteQuery.Parameters>
                                                            <InArgument x:TypeArguments="x:String" x:Key="Day_Last">[Convert.ToDateTime(Day_Last.ToString).ToString("yyyyMM")]</InArgument>
                                                          </ui:ExecuteQuery.Parameters>
                                                        </ui:ExecuteQuery>
                                                        <If sap2010:Annotation.AnnotationText="Kiểm tra nếu không có dữ liệu tháng đó đánh dấu để dùng dữ liệu Wings tạm" Condition="[dt_Calendar_HR.Rows.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="334,108" sap2010:WorkflowViewState.IdRef="If_185">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Else>
                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_143">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </If.Else>
                                                        </If>
                                                      </Sequence>
                                                    </Switch>
                                                  </If.Then>
                                                </If>
                                              </Sequence>
                                            </If.Else>
                                          </If>
                                          <If sap2010:Annotation.AnnotationText="Sau khi kiểm tra tính hợp lệ của ngày đi làm và ngày nghỉ thì tiếp tục quy trình" Condition="[Check_LeaveForm = False]" sap:VirtualizedContainerService.HintSize="741,498" sap2010:WorkflowViewState.IdRef="If_154">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <Switch x:TypeArguments="x:String" DisplayName="Switch" Expression="[Kinds_Leave_Name.Trim]" sap:VirtualizedContainerService.HintSize="496,319" sap2010:WorkflowViewState.IdRef="Switch`1_17">
                                                <Switch.Default>
                                                  <If sap2010:Annotation.AnnotationText="Kiểm tra tính hợp lệ của tổng số ngày nghỉ" Condition="[convert.ToDouble(Total_Leave.ToString) = convert.ToDouble(Total_Leave_temp.ToString)]" sap:VirtualizedContainerService.HintSize="484,272" sap2010:WorkflowViewState.IdRef="If_195">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <If sap2010:Annotation.AnnotationText="Kiểm tra nếu có giá trị ở mục lý do khác thì xử lý cách khác" Condition="[Leave_Other is Nothing Or Leave_Other = &quot;&quot;]" sap:VirtualizedContainerService.HintSize="741,383" sap2010:WorkflowViewState.IdRef="If_194">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <If sap2010:Annotation.AnnotationText="Kiểm tra tính hợp lệ của phép tồn" Condition="[convert.ToDouble(Total_Leave.ToString) &lt;= Convert.ToDouble(Total_Phepton.ToString)]" sap:VirtualizedContainerService.HintSize="200,93" sap2010:WorkflowViewState.IdRef="If_190">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If.Else>
                                                              <Sequence DisplayName="Message error and send mail" sap:VirtualizedContainerService.HintSize="380,467" sap2010:WorkflowViewState.IdRef="Sequence_241">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_120">
                                                                  <ui:MultipleAssign.AssignOperations>
                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_307">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_308">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="sd:DataRow">[dataRow]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="sd:DataRow">[dt_Error.NewRow]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_309">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:Object">[dataRow("MSNV")]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:Object">[MSNV.ToString.Trim]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_310">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:Object">[dataRow("FullName")]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:Object">[row(1).ToString.Trim]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_311">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:Object">[dataRow("Note")]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:Object">["Số dư phép năm không đủ. Số dư phép năm còn lại " + Total_Phepton.ToString]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                    </scg:List>
                                                                  </ui:MultipleAssign.AssignOperations>
                                                                </ui:MultipleAssign>
                                                                <ui:AddDataRow ArrayRow="{x:Null}" DataRow="[dataRow]" DataTable="[dt_Error]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="AddDataRow_16" />
                                                                <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel log staff" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_27" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                                                  <ui:ExcelApplicationScope.Body>
                                                                    <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                      </ActivityAction.Argument>
                                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,278" sap2010:WorkflowViewState.IdRef="Sequence_240">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_excel.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_75" SheetName="[wb.GetSheets(0)]" Text="[&quot;Số dư phép năm không đủ. Số dư phép năm còn lại &quot; + Total_Phepton.ToString]" />
                                                                        <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_27" Workbook="[wb]" />
                                                                      </Sequence>
                                                                    </ActivityAction>
                                                                  </ui:ExcelApplicationScope.Body>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:ExcelApplicationScope>
                                                              </Sequence>
                                                            </If.Else>
                                                          </If>
                                                        </If.Then>
                                                        <If.Else>
                                                          <Switch x:TypeArguments="x:String" DisplayName="Switch" Expression="[Leave_Other]" sap:VirtualizedContainerService.HintSize="496,204" sap2010:WorkflowViewState.IdRef="Switch`1_16">
                                                            <Switch.Default>
                                                              <Sequence DisplayName="Message error and send mail" sap:VirtualizedContainerService.HintSize="242,296" sap2010:WorkflowViewState.IdRef="Sequence_249">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="MultipleAssign_124">
                                                                  <ui:MultipleAssign.AssignOperations>
                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_327">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_328">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="sd:DataRow">[dataRow]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="sd:DataRow">[dt_Error.NewRow]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_329">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:Object">[dataRow("MSNV")]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:Object">[MSNV.ToString.Trim]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_330">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:Object">[dataRow("FullName")]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:Object">[row(1).ToString.Trim]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_331">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:Object">[dataRow("Note")]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:Object">["Không có trường hợp nghỉ khác vui lòng xem lại loại nghỉ phép"]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_342">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[Kinds_Leave_Name]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">
                                                                            <Literal x:TypeArguments="x:String" Value="" />
                                                                          </InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                    </scg:List>
                                                                  </ui:MultipleAssign.AssignOperations>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:MultipleAssign>
                                                                <ui:AddDataRow ArrayRow="{x:Null}" DataRow="[dataRow]" DataTable="[dt_Error]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddDataRow_20" />
                                                                <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel log staff" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_31" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                                                  <ui:ExcelApplicationScope.Body>
                                                                    <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                      </ActivityAction.Argument>
                                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,278" sap2010:WorkflowViewState.IdRef="Sequence_248">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_excel.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_79" SheetName="[wb.GetSheets(0)]" Text="Không có trường hợp nghỉ khác vui lòng xem lại loại nghỉ phép" />
                                                                        <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_31" Workbook="[wb]" />
                                                                      </Sequence>
                                                                    </ActivityAction>
                                                                  </ui:ExcelApplicationScope.Body>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:ExcelApplicationScope>
                                                              </Sequence>
                                                            </Switch.Default>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If x:Key="Kết hôn" Condition="[Total_Leave_temp &lt;= 4]" DisplayName="If check total leave special" sap:VirtualizedContainerService.HintSize="507,208" sap2010:WorkflowViewState.IdRef="If_191">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_146">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[Kinds_Leave_Name]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">WED</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </If.Then>
                                                              <If.Else>
                                                                <Sequence DisplayName="Message error and send mail" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_243">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_121">
                                                                    <ui:MultipleAssign.AssignOperations>
                                                                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_312">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_313">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="sd:DataRow">[dataRow]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="sd:DataRow">[dt_Error.NewRow]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_314">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("MSNV")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">[MSNV.ToString.Trim]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_315">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("FullName")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">[row(1).ToString.Trim]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_316">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("Note")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">["Không được nghỉ hơn 4 ngày đối với trường hợp kết hôn"]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                      </scg:List>
                                                                    </ui:MultipleAssign.AssignOperations>
                                                                  </ui:MultipleAssign>
                                                                  <ui:AddDataRow ArrayRow="{x:Null}" DataRow="[dataRow]" DataTable="[dt_Error]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="AddDataRow_17" />
                                                                  <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel log staff" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_28" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                                                    <ui:ExcelApplicationScope.Body>
                                                                      <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                        <ActivityAction.Argument>
                                                                          <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                        </ActivityAction.Argument>
                                                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,278" sap2010:WorkflowViewState.IdRef="Sequence_242">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_excel.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_76" SheetName="[wb.GetSheets(0)]" Text="Không được nghỉ hơn 4 ngày đối với trường hợp kết hôn" />
                                                                          <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_28" Workbook="[wb]" />
                                                                        </Sequence>
                                                                      </ActivityAction>
                                                                    </ui:ExcelApplicationScope.Body>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </ui:ExcelApplicationScope>
                                                                </Sequence>
                                                              </If.Else>
                                                            </If>
                                                            <If x:Key="Tang chế" Condition="[Total_Leave_temp &lt;= 4]" DisplayName="If check total leave special" sap:VirtualizedContainerService.HintSize="507,208" sap2010:WorkflowViewState.IdRef="If_192">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_147">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[Kinds_Leave_Name]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">FU</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </If.Then>
                                                              <If.Else>
                                                                <Sequence DisplayName="Message error and send mail" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_245">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_122">
                                                                    <ui:MultipleAssign.AssignOperations>
                                                                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_317">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_318">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="sd:DataRow">[dataRow]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="sd:DataRow">[dt_Error.NewRow]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_319">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("MSNV")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">[MSNV.ToString.Trim]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_320">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("FullName")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">[row(1).ToString.Trim]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_321">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("Note")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">["Không được nghỉ hơn 4 ngày đối với trường hợp tang chế"]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                      </scg:List>
                                                                    </ui:MultipleAssign.AssignOperations>
                                                                  </ui:MultipleAssign>
                                                                  <ui:AddDataRow ArrayRow="{x:Null}" DataRow="[dataRow]" DataTable="[dt_Error]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="AddDataRow_18" />
                                                                  <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel log staff" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_29" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                                                    <ui:ExcelApplicationScope.Body>
                                                                      <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                        <ActivityAction.Argument>
                                                                          <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                        </ActivityAction.Argument>
                                                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,278" sap2010:WorkflowViewState.IdRef="Sequence_244">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_excel.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_77" SheetName="[wb.GetSheets(0)]" Text="Không được nghỉ hơn 4 ngày đối với trường hợp tang chế" />
                                                                          <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_29" Workbook="[wb]" />
                                                                        </Sequence>
                                                                      </ActivityAction>
                                                                    </ui:ExcelApplicationScope.Body>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </ui:ExcelApplicationScope>
                                                                </Sequence>
                                                              </If.Else>
                                                            </If>
                                                            <If x:Key="Nghỉ vợ sanh" Condition="[Total_Leave_temp &lt;= 1]" DisplayName="If check total leave special" sap:VirtualizedContainerService.HintSize="687,575" sap2010:WorkflowViewState.IdRef="If_193">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_148">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[Kinds_Leave_Name]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">HBL</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </If.Then>
                                                              <If.Else>
                                                                <Sequence DisplayName="Message error and send mail" sap:VirtualizedContainerService.HintSize="380,467" sap2010:WorkflowViewState.IdRef="Sequence_247">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_123">
                                                                    <ui:MultipleAssign.AssignOperations>
                                                                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_322">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_323">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="sd:DataRow">[dataRow]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="sd:DataRow">[dt_Error.NewRow]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_324">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("MSNV")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">[MSNV.ToString.Trim]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_325">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("FullName")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">[row(1).ToString.Trim]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_326">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("Note")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">["Không được nghỉ hơn 1 ngày đối với trường hợp nghỉ vợ sanh"]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                      </scg:List>
                                                                    </ui:MultipleAssign.AssignOperations>
                                                                  </ui:MultipleAssign>
                                                                  <ui:AddDataRow ArrayRow="{x:Null}" DataRow="[dataRow]" DataTable="[dt_Error]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="AddDataRow_19" />
                                                                  <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel log staff" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_30" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                                                    <ui:ExcelApplicationScope.Body>
                                                                      <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                        <ActivityAction.Argument>
                                                                          <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                        </ActivityAction.Argument>
                                                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,278" sap2010:WorkflowViewState.IdRef="Sequence_246">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_excel.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_78" SheetName="[wb.GetSheets(0)]" Text="Không được nghỉ hơn 1 ngày đối với trường hợp nghỉ vợ sanh" />
                                                                          <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_30" Workbook="[wb]" />
                                                                        </Sequence>
                                                                      </ActivityAction>
                                                                    </ui:ExcelApplicationScope.Body>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </ui:ExcelApplicationScope>
                                                                </Sequence>
                                                              </If.Else>
                                                            </If>
                                                            <Assign x:Key="Nghỉ bù" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_149">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[Kinds_Leave_Name]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">CL</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </Switch>
                                                        </If.Else>
                                                      </If>
                                                    </If.Then>
                                                    <If.Else>
                                                      <Sequence DisplayName="Message error and send mail" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_251">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_125">
                                                          <ui:MultipleAssign.AssignOperations>
                                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_332">
                                                                <ui:AssignOperation.To>
                                                                  <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                                </ui:AssignOperation.To>
                                                                <ui:AssignOperation.Value>
                                                                  <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                </ui:AssignOperation.Value>
                                                              </ui:AssignOperation>
                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_333">
                                                                <ui:AssignOperation.To>
                                                                  <OutArgument x:TypeArguments="sd:DataRow">[dataRow]</OutArgument>
                                                                </ui:AssignOperation.To>
                                                                <ui:AssignOperation.Value>
                                                                  <InArgument x:TypeArguments="sd:DataRow">[dt_Error.NewRow]</InArgument>
                                                                </ui:AssignOperation.Value>
                                                              </ui:AssignOperation>
                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_334">
                                                                <ui:AssignOperation.To>
                                                                  <OutArgument x:TypeArguments="x:Object">[dataRow("MSNV")]</OutArgument>
                                                                </ui:AssignOperation.To>
                                                                <ui:AssignOperation.Value>
                                                                  <InArgument x:TypeArguments="x:Object">[MSNV.ToString.Trim]</InArgument>
                                                                </ui:AssignOperation.Value>
                                                              </ui:AssignOperation>
                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_335">
                                                                <ui:AssignOperation.To>
                                                                  <OutArgument x:TypeArguments="x:Object">[dataRow("FullName")]</OutArgument>
                                                                </ui:AssignOperation.To>
                                                                <ui:AssignOperation.Value>
                                                                  <InArgument x:TypeArguments="x:Object">[row(1).ToString.Trim]</InArgument>
                                                                </ui:AssignOperation.Value>
                                                              </ui:AssignOperation>
                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_336">
                                                                <ui:AssignOperation.To>
                                                                  <OutArgument x:TypeArguments="x:Object">[dataRow("Note")]</OutArgument>
                                                                </ui:AssignOperation.To>
                                                                <ui:AssignOperation.Value>
                                                                  <InArgument x:TypeArguments="x:Object">["Tổng số thời gian nghỉ của bạn không khớp với hệ thống. Vui lòng liên hệ trực tiếp với nhân sự"]</InArgument>
                                                                </ui:AssignOperation.Value>
                                                              </ui:AssignOperation>
                                                            </scg:List>
                                                          </ui:MultipleAssign.AssignOperations>
                                                        </ui:MultipleAssign>
                                                        <ui:AddDataRow ArrayRow="{x:Null}" DataRow="[dataRow]" DataTable="[dt_Error]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="AddDataRow_21" />
                                                        <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel log staff" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_32" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                                          <ui:ExcelApplicationScope.Body>
                                                            <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,278" sap2010:WorkflowViewState.IdRef="Sequence_250">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_excel.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_80" SheetName="[wb.GetSheets(0)]" Text="Tổng số thời gian nghỉ của bạn không khớp với hệ thống. Vui lòng liên hệ trực tiếp với nhân sự" />
                                                                <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_32" Workbook="[wb]" />
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:ExcelApplicationScope.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:ExcelApplicationScope>
                                                      </Sequence>
                                                    </If.Else>
                                                  </If>
                                                </Switch.Default>
                                                <x:Null x:Key="MT" />
                                                <x:Null x:Key="SL" />
                                                <x:Null x:Key="NL" />
                                              </Switch>
                                            </If.Then>
                                            <If.Else>
                                              <Sequence DisplayName="Message error and send mail" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_176">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_104">
                                                  <ui:MultipleAssign.AssignOperations>
                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_222">
                                                        <ui:AssignOperation.To>
                                                          <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                        </ui:AssignOperation.To>
                                                        <ui:AssignOperation.Value>
                                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                        </ui:AssignOperation.Value>
                                                      </ui:AssignOperation>
                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_253">
                                                        <ui:AssignOperation.To>
                                                          <OutArgument x:TypeArguments="sd:DataRow">[dataRow]</OutArgument>
                                                        </ui:AssignOperation.To>
                                                        <ui:AssignOperation.Value>
                                                          <InArgument x:TypeArguments="sd:DataRow">[dt_Error.NewRow]</InArgument>
                                                        </ui:AssignOperation.Value>
                                                      </ui:AssignOperation>
                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_254">
                                                        <ui:AssignOperation.To>
                                                          <OutArgument x:TypeArguments="x:Object">[dataRow("MSNV")]</OutArgument>
                                                        </ui:AssignOperation.To>
                                                        <ui:AssignOperation.Value>
                                                          <InArgument x:TypeArguments="x:Object">[MSNV.ToString.Trim]</InArgument>
                                                        </ui:AssignOperation.Value>
                                                      </ui:AssignOperation>
                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_255">
                                                        <ui:AssignOperation.To>
                                                          <OutArgument x:TypeArguments="x:Object">[dataRow("FullName")]</OutArgument>
                                                        </ui:AssignOperation.To>
                                                        <ui:AssignOperation.Value>
                                                          <InArgument x:TypeArguments="x:Object">[row(1).ToString.Trim]</InArgument>
                                                        </ui:AssignOperation.Value>
                                                      </ui:AssignOperation>
                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_256">
                                                        <ui:AssignOperation.To>
                                                          <OutArgument x:TypeArguments="x:Object">[dataRow("Note")]</OutArgument>
                                                        </ui:AssignOperation.To>
                                                        <ui:AssignOperation.Value>
                                                          <InArgument x:TypeArguments="x:Object">["Ngày bắt đầu và ngày kết thúc rơi vào lịch nghỉ của công ty hoặc ngày Stock Talking. Vui lòng liên hệ trực tiếp với nhân sự về trường hợp này"]</InArgument>
                                                        </ui:AssignOperation.Value>
                                                      </ui:AssignOperation>
                                                    </scg:List>
                                                  </ui:MultipleAssign.AssignOperations>
                                                </ui:MultipleAssign>
                                                <ui:AddDataRow ArrayRow="{x:Null}" DataRow="[dataRow]" DataTable="[dt_Error]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="AddDataRow_8" />
                                                <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel log staff" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_22" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                                  <ui:ExcelApplicationScope.Body>
                                                    <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,278" sap2010:WorkflowViewState.IdRef="Sequence_235">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_excel.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_70" SheetName="[wb.GetSheets(0)]" Text="Ngày bắt đầu và ngày kết thúc rơi vào lịch nghỉ của công ty hoặc ngày Stock Talking. Vui lòng liên hệ trực tiếp với nhân sự về trường hợp này" />
                                                        <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_22" Workbook="[wb]" />
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </ui:ExcelApplicationScope.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:ExcelApplicationScope>
                                                <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="CommentOut_2">
                                                  <ui:CommentOut.Body>
                                                    <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="426,249" sap2010:WorkflowViewState.IdRef="Sequence_205">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:CopyFile ContinueOnError="{x:Null}" Destination="[Path_Excel_NT + &quot;Special Case\&quot; + Path.GetFileNameWithoutExtension(File) + &quot;.pdf&quot;]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="CopyFile_5" Overwrite="True" Path="[&quot;\\ykkvnm.com\vnmfs\YKKDATA\DEPARTMENT\Human Resources\ROBOTICS\LEAVE REGISTER\PDF\&quot; + Path.GetFileNameWithoutExtension(File) + &quot;.pdf&quot;]" />
                                                    </Sequence>
                                                  </ui:CommentOut.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:CommentOut>
                                                <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="CommentOut_3">
                                                  <ui:CommentOut.Body>
                                                    <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="376,237" sap2010:WorkflowViewState.IdRef="Sequence_206">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:SendMail Bcc="{x:Null}" From="{x:Null}" MailMessage="{x:Null}" Name="{x:Null}" TimeoutMS="{x:Null}" Body="[&quot;&lt;/p&gt;&lt;b&gt;Dear HR section&lt;/b&gt;&lt;/p&gt;&quot; +&#xA;&quot;&lt;p&gt;Below user has Start Date/End Date is none working day&lt;/p&gt;&quot; +&#xA;&quot;&lt;p&gt;Name : &quot; + MSNV_Name + &quot;&lt;br&gt;ID Number : &quot; + MSNV + &quot;&lt;br&gt;Form Code : &quot; + Path.GetFileName(File) + &quot;&lt;/p&gt;&quot;]" Cc="[Mail_PIC]" DisplayName="Send SMTP Mail Message" Email="[Mail_Email]" EnableSSL="True" sap:VirtualizedContainerService.HintSize="334,145" sap2010:WorkflowViewState.IdRef="SendMail_37" IsBodyHtml="True" Password="[Mail_Password]" Port="25" SecureConnection="Auto" Server="[Mail_Server]" Subject="[RPA] LEAVE REGISTER – SPECIAL CASE" To="ThiHang@ykk.com.vn, ThuyHoa@ykk.com.vn">
                                                        <ui:SendMail.Files>
                                                          <scg:List x:TypeArguments="InArgument(x:String)" Capacity="4">
                                                            <InArgument x:TypeArguments="x:String">[Path_Excel_NT + "Backup\" + Path.GetFileName(File).ToString]</InArgument>
                                                            <InArgument x:TypeArguments="x:String">["\\ykkvnm.com\vnmfs\YKKDATA\DEPARTMENT\Human Resources\ROBOTICS\LEAVE REGISTER\PDF\" + Path.GetFileNameWithoutExtension(File) + ".pdf"]</InArgument>
                                                          </scg:List>
                                                        </ui:SendMail.Files>
                                                      </ui:SendMail>
                                                    </Sequence>
                                                  </ui:CommentOut.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:CommentOut>
                                              </Sequence>
                                            </If.Else>
                                          </If>
                                        </Sequence>
                                      </If.Then>
                                      <If.Else>
                                        <Sequence DisplayName="Message error and send mail" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_178">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_105">
                                            <ui:MultipleAssign.AssignOperations>
                                              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_224">
                                                  <ui:AssignOperation.To>
                                                    <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                  </ui:AssignOperation.To>
                                                  <ui:AssignOperation.Value>
                                                    <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                  </ui:AssignOperation.Value>
                                                </ui:AssignOperation>
                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_249">
                                                  <ui:AssignOperation.To>
                                                    <OutArgument x:TypeArguments="sd:DataRow">[dataRow]</OutArgument>
                                                  </ui:AssignOperation.To>
                                                  <ui:AssignOperation.Value>
                                                    <InArgument x:TypeArguments="sd:DataRow">[dt_Error.NewRow]</InArgument>
                                                  </ui:AssignOperation.Value>
                                                </ui:AssignOperation>
                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_250">
                                                  <ui:AssignOperation.To>
                                                    <OutArgument x:TypeArguments="x:Object">[dataRow("MSNV")]</OutArgument>
                                                  </ui:AssignOperation.To>
                                                  <ui:AssignOperation.Value>
                                                    <InArgument x:TypeArguments="x:Object">[MSNV.ToString.Trim]</InArgument>
                                                  </ui:AssignOperation.Value>
                                                </ui:AssignOperation>
                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_251">
                                                  <ui:AssignOperation.To>
                                                    <OutArgument x:TypeArguments="x:Object">[dataRow("FullName")]</OutArgument>
                                                  </ui:AssignOperation.To>
                                                  <ui:AssignOperation.Value>
                                                    <InArgument x:TypeArguments="x:Object">[row(1).ToString.Trim]</InArgument>
                                                  </ui:AssignOperation.Value>
                                                </ui:AssignOperation>
                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_252">
                                                  <ui:AssignOperation.To>
                                                    <OutArgument x:TypeArguments="x:Object">[dataRow("Note")]</OutArgument>
                                                  </ui:AssignOperation.To>
                                                  <ui:AssignOperation.Value>
                                                    <InArgument x:TypeArguments="x:Object">["Thời gian bắt đầu nghỉ là của tháng trước nên vui lòng gửi trực tiếp với nhân sự về những trường hợp này"]</InArgument>
                                                  </ui:AssignOperation.Value>
                                                </ui:AssignOperation>
                                              </scg:List>
                                            </ui:MultipleAssign.AssignOperations>
                                          </ui:MultipleAssign>
                                          <ui:AddDataRow ArrayRow="{x:Null}" DataRow="[dataRow]" DataTable="[dt_Error]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="AddDataRow_9" />
                                          <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel log staff" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_23" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                            <ui:ExcelApplicationScope.Body>
                                              <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                </ActivityAction.Argument>
                                                <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,278" sap2010:WorkflowViewState.IdRef="Sequence_236">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_excel.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_71" SheetName="[wb.GetSheets(0)]" Text="Thời gian bắt đầu nghỉ là của tháng trước nên vui lòng gửi trực tiếp với nhân sự về những trường hợp này" />
                                                  <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_23" Workbook="[wb]" />
                                                </Sequence>
                                              </ActivityAction>
                                            </ui:ExcelApplicationScope.Body>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:ExcelApplicationScope>
                                          <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="CommentOut_1">
                                            <ui:CommentOut.Body>
                                              <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="376,237" sap2010:WorkflowViewState.IdRef="Sequence_204">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:SendMail Bcc="{x:Null}" From="{x:Null}" MailMessage="{x:Null}" Name="{x:Null}" TimeoutMS="{x:Null}" Body="[&quot;&lt;/p&gt;&lt;b&gt;Dear HR section&lt;/b&gt;&lt;/p&gt;&quot; +&#xA;&quot;&lt;p&gt;Below user has From Date information begins in the previous month&lt;/p&gt;&quot; +&#xA;&quot;&lt;p&gt;Name : &quot; + MSNV_Name + &quot;&lt;br&gt;ID Number : &quot; + MSNV + &quot;&lt;br&gt;Form Code : &quot; + Path.GetFileName(File) + &quot;&lt;/p&gt;&quot;]" Cc="[Mail_PIC]" DisplayName="Send SMTP Mail Message" Email="[Mail_Email]" EnableSSL="True" sap:VirtualizedContainerService.HintSize="334,145" sap2010:WorkflowViewState.IdRef="SendMail_38" IsBodyHtml="True" Password="[Mail_Password]" Port="25" SecureConnection="Auto" Server="[Mail_Server]" Subject="[RPA] LEAVE REGISTER – SPECIAL CASE" To="ThiHang@ykk.com.vn, ThuyHoa@ykk.com.vn">
                                                  <ui:SendMail.Files>
                                                    <scg:List x:TypeArguments="InArgument(x:String)" Capacity="4">
                                                      <InArgument x:TypeArguments="x:String">[Path_Excel_NT + "Backup\" + Path.GetFileName(File).ToString]</InArgument>
                                                      <InArgument x:TypeArguments="x:String">["\\ykkvnm.com\vnmfs\YKKDATA\DEPARTMENT\Human Resources\ROBOTICS\LEAVE REGISTER\PDF\" + Path.GetFileNameWithoutExtension(File) + ".pdf"]</InArgument>
                                                    </scg:List>
                                                  </ui:SendMail.Files>
                                                </ui:SendMail>
                                              </Sequence>
                                            </ui:CommentOut.Body>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:CommentOut>
                                        </Sequence>
                                      </If.Else>
                                    </If>
                                  </If.Then>
                                  <If.Else>
                                    <Sequence DisplayName="Message error and send mail" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_179">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_106">
                                        <ui:MultipleAssign.AssignOperations>
                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_226">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_245">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="sd:DataRow">[dataRow]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="sd:DataRow">[dt_Error.NewRow]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_246">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:Object">[dataRow("MSNV")]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:Object">[MSNV.ToString.Trim]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_247">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:Object">[dataRow("FullName")]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:Object">[row(1).ToString.Trim]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_248">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:Object">[dataRow("Note")]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:Object">["Ngày bắt đầu lớn hơn ngày kết thúc nghỉ phép"]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                          </scg:List>
                                        </ui:MultipleAssign.AssignOperations>
                                      </ui:MultipleAssign>
                                      <ui:AddDataRow ArrayRow="{x:Null}" DataRow="[dataRow]" DataTable="[dt_Error]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="AddDataRow_10" />
                                      <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel log staff" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_26" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                        <ui:ExcelApplicationScope.Body>
                                          <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                            </ActivityAction.Argument>
                                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,278" sap2010:WorkflowViewState.IdRef="Sequence_239">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_excel.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_74" SheetName="[wb.GetSheets(0)]" Text="Ngày bắt đầu lớn hơn ngày kết thúc nghỉ phép" />
                                              <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_26" Workbook="[wb]" />
                                            </Sequence>
                                          </ActivityAction>
                                        </ui:ExcelApplicationScope.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:ExcelApplicationScope>
                                    </Sequence>
                                  </If.Else>
                                </If>
                              </If.Then>
                            </If>
                            <If sap2010:Annotation.AnnotationText="Nếu điều kiện hợp lệ thì chuyển sang giai đoạn input data" Condition="[Check_LeaveForm = False]" sap:VirtualizedContainerService.HintSize="1418,108" sap2010:WorkflowViewState.IdRef="If_171">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <If.Then>
                                <Sequence DisplayName="Convert Template" sap:VirtualizedContainerService.HintSize="242,234" sap2010:WorkflowViewState.IdRef="Sequence_198">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If Condition="[Kinds_Leave_Name.Trim &lt;&gt; &quot;MT&quot;]" sap:VirtualizedContainerService.HintSize="484,214" sap2010:WorkflowViewState.IdRef="If_166">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <Sequence DisplayName="Process normal" sap:VirtualizedContainerService.HintSize="376,363" sap2010:WorkflowViewState.IdRef="Sequence_185">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:PathExists DisplayName="Path Exists" Exists="[File_Leave_Register]" sap:VirtualizedContainerService.HintSize="334,89" sap2010:WorkflowViewState.IdRef="PathExists_3" Path="[Path_Excel_NT + &quot;DONE\LEAVE REGISTER.xls&quot;]" PathType="File" />
                                        <If Condition="[File_Leave_Register = True]" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_158">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Else>
                                            <ui:CopyFile ContinueOnError="{x:Null}" Destination="[Path_Excel_NT + &quot;DONE\LEAVE REGISTER.xls&quot;]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="CopyFile_6" Overwrite="False" Path="[Path_Template + &quot;LEAVE REGISTER Template.xls&quot;]" />
                                          </If.Else>
                                        </If>
                                        <ui:ExcelApplicationScope Password="{x:Null}" AutoSave="False" CreateNewFile="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_9" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;DONE\LEAVE REGISTER.xls&quot;]">
                                          <ui:ExcelApplicationScope.Body>
                                            <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="382,715" sap2010:WorkflowViewState.IdRef="Sequence_184">
                                                <Sequence.Variables>
                                                  <Variable x:TypeArguments="x:String" Name="row_current" />
                                                </Sequence.Variables>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ee:MoveVerticalActivity MoveColumn="{x:Null}" MoveCount="{x:Null}" BaseCell="A10000" ClipboardCopyFlg="False" CurrentCell="[row_current]" DisplayName="Move vertical activity" sap:VirtualizedContainerService.HintSize="340,144" sap2010:WorkflowViewState.IdRef="MoveVerticalActivity_4" MoveDirection="Up" MoveLastDataRowFlg="True" MoveNextFlg="True" SheetName="[wb.GetSheets(0)]" WorkBook="[wb]" />
                                                <If Condition="[row_current.Remove(0,1) = &quot;3&quot;]" sap:VirtualizedContainerService.HintSize="340,51" sap2010:WorkflowViewState.IdRef="If_159">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_125">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:String">[row_current]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:String">A4</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_126">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:String">[row_current]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:String">["A" + Convert.ToInt32(Convert.ToInt32(row_current.Remove(0,1)) + 1).ToString]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                  </If.Else>
                                                </If>
                                                <ui:ExcelReadRange AddHeaders="False" DataTable="[dt_MSNV]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="340,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_5" Range="[&quot;A4:D&quot; + row_current.Remove(0,1)]" SheetName="[wb.GetSheets(0)]" />
                                                <ui:FilterDataTable DataTable="[dt_MSNV]" DisplayName="Filter Data Table" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="340,59" sap2010:WorkflowViewState.IdRef="FilterDataTable_3" OutputDataTable="[dt_MSNV]" SelectColumnsMode="Keep">
                                                  <ui:FilterDataTable.Filters>
                                                    <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                      <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                                                        <ui:FilterOperationArgument.Column>
                                                          <InArgument x:TypeArguments="x:String">["Column0"]</InArgument>
                                                        </ui:FilterOperationArgument.Column>
                                                        <ui:FilterOperationArgument.Operand>
                                                          <InArgument x:TypeArguments="ui:GenericValue">[MSNV]</InArgument>
                                                        </ui:FilterOperationArgument.Operand>
                                                      </ui:FilterOperationArgument>
                                                    </scg:List>
                                                  </ui:FilterDataTable.Filters>
                                                  <ui:FilterDataTable.SelectColumns>
                                                    <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                      <x:Null />
                                                    </scg:List>
                                                  </ui:FilterDataTable.SelectColumns>
                                                </ui:FilterDataTable>
                                                <If Condition="[dt_MSNV.Rows.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="340,51" sap2010:WorkflowViewState.IdRef="If_161">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <ui:ForEachRow CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Kiểm tra MSNV nghỉ có trùng ngày nghỉ với đơn trước không" DataTable="[dt_MSNV]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="430,491" sap2010:WorkflowViewState.IdRef="ForEachRow_4">
                                                      <ui:ForEachRow.Body>
                                                        <ActivityAction x:TypeArguments="sd:DataRow">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="380,312" sap2010:WorkflowViewState.IdRef="Sequence_182">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_107">
                                                              <ui:MultipleAssign.AssignOperations>
                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_227">
                                                                    <ui:AssignOperation.To>
                                                                      <OutArgument x:TypeArguments="x:String">[Day_First_Template]</OutArgument>
                                                                    </ui:AssignOperation.To>
                                                                    <ui:AssignOperation.Value>
                                                                      <InArgument x:TypeArguments="x:String">[dt_MSNV.Rows(0)(2).ToString.Substring(0,4) + "/" + dt_MSNV.Rows(0)(2).ToString.Substring(4,2) + "/" + dt_MSNV.Rows(0)(2).ToString.Substring(6,2)]</InArgument>
                                                                    </ui:AssignOperation.Value>
                                                                  </ui:AssignOperation>
                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_228">
                                                                    <ui:AssignOperation.To>
                                                                      <OutArgument x:TypeArguments="x:String">[Day_Last_Template]</OutArgument>
                                                                    </ui:AssignOperation.To>
                                                                    <ui:AssignOperation.Value>
                                                                      <InArgument x:TypeArguments="x:String">[dt_MSNV.Rows(0)(3).ToString.Substring(0,4) + "/" + dt_MSNV.Rows(0)(3).ToString.Substring(4,2) + "/" + dt_MSNV.Rows(0)(3).ToString.Substring(6,2)]</InArgument>
                                                                    </ui:AssignOperation.Value>
                                                                  </ui:AssignOperation>
                                                                </scg:List>
                                                              </ui:MultipleAssign.AssignOperations>
                                                            </ui:MultipleAssign>
                                                            <If Condition="[(Convert.ToDateTime(Day_First_Template.ToString) &lt;= Convert.ToDateTime(Day_First.ToString) And Convert.ToDateTime(Day_First.ToString) &lt;= Convert.ToDateTime(Day_First_Template.ToString)) Or (Convert.ToDateTime(Day_Last_Template.ToString) &lt;= Convert.ToDateTime(Day_Last.ToString) And Convert.ToDateTime(Day_Last.ToString) &lt;= Convert.ToDateTime(Day_Last_Template.ToString))]" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="If_160">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <Sequence DisplayName="Message error and send mail" sap:VirtualizedContainerService.HintSize="380,467" sap2010:WorkflowViewState.IdRef="Sequence_180">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_108">
                                                                    <ui:MultipleAssign.AssignOperations>
                                                                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_230">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_285">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="sd:DataRow">[dataRow]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="sd:DataRow">[dt_Error.NewRow]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_286">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("MSNV")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">[MSNV.ToString.Trim]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_287">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("FullName")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">[row(1).ToString.Trim]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_288">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("Note")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">["Ngày bắt đầu và ngày kết thúc đã được đăng ký trước đó"]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                      </scg:List>
                                                                    </ui:MultipleAssign.AssignOperations>
                                                                  </ui:MultipleAssign>
                                                                  <ui:AddDataRow ArrayRow="{x:Null}" DataRow="[dataRow]" DataTable="[dt_Error]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="AddDataRow_12" />
                                                                  <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel log staff" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_25" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                                                    <ui:ExcelApplicationScope.Body>
                                                                      <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                        <ActivityAction.Argument>
                                                                          <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                        </ActivityAction.Argument>
                                                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,278" sap2010:WorkflowViewState.IdRef="Sequence_238">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_excel.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_73" SheetName="[wb.GetSheets(0)]" Text="Ngày bắt đầu và ngày kết thúc đã được đăng ký trước đó" />
                                                                          <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_25" Workbook="[wb]" />
                                                                        </Sequence>
                                                                      </ActivityAction>
                                                                    </ui:ExcelApplicationScope.Body>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </ui:ExcelApplicationScope>
                                                                </Sequence>
                                                              </If.Then>
                                                              <If.Else>
                                                                <Sequence DisplayName="Input data" sap:VirtualizedContainerService.HintSize="376,749" sap2010:WorkflowViewState.IdRef="Sequence_181">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:ExcelWriteCell Cell="[&quot;A&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_44" SheetName="[wb.GetSheets(0)]" Text="[MSNV]" />
                                                                  <ui:ExcelWriteCell Cell="[&quot;C&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_45" SheetName="[wb.GetSheets(0)]" Text="[Convert.ToDateTime(Day_First.ToString).ToString(&quot;yyyyMMdd&quot;)]" />
                                                                  <ui:ExcelWriteCell Cell="[&quot;D&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_46" SheetName="[wb.GetSheets(0)]" Text="[Convert.ToDateTime(Day_Last.ToString).ToString(&quot;yyyyMMdd&quot;)]" />
                                                                  <ui:ExcelWriteCell Cell="[&quot;E&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_47" SheetName="[wb.GetSheets(0)]" Text="[Kinds_Leave_Name]" />
                                                                  <ui:ExcelWriteCell Cell="[&quot;F&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_48" SheetName="[wb.GetSheets(0)]" Text="[Time_Leave_Name]" />
                                                                  <ui:ExcelSaveWorkbook DisplayName="Save Workbook" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="ExcelSaveWorkbook_8" />
                                                                </Sequence>
                                                              </If.Else>
                                                            </If>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:ForEachRow.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:ForEachRow>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Sequence DisplayName="Input data" sap:VirtualizedContainerService.HintSize="376,749" sap2010:WorkflowViewState.IdRef="Sequence_183">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:ExcelWriteCell Cell="[&quot;A&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_49" SheetName="[wb.GetSheets(0)]" Text="[MSNV]" />
                                                      <ui:ExcelWriteCell Cell="[&quot;C&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_50" SheetName="[wb.GetSheets(0)]" Text="[Convert.ToDateTime(Day_First.ToString).ToString(&quot;yyyyMMdd&quot;)]" />
                                                      <ui:ExcelWriteCell Cell="[&quot;D&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_51" SheetName="[wb.GetSheets(0)]" Text="[Convert.ToDateTime(Day_Last.ToString).ToString(&quot;yyyyMMdd&quot;)]" />
                                                      <ui:ExcelWriteCell Cell="[&quot;E&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_52" SheetName="[wb.GetSheets(0)]" Text="[Kinds_Leave_Name]" />
                                                      <ui:ExcelWriteCell Cell="[&quot;F&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_53" SheetName="[wb.GetSheets(0)]" Text="[Time_Leave_Name]" />
                                                      <ui:ExcelSaveWorkbook DisplayName="Save Workbook" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="ExcelSaveWorkbook_9" />
                                                    </Sequence>
                                                  </If.Else>
                                                </If>
                                                <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="340,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_9" Workbook="[wb]" />
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ExcelApplicationScope.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExcelApplicationScope>
                                      </Sequence>
                                    </If.Then>
                                    <If.Else>
                                      <Sequence DisplayName="Process MT" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_191">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:PathExists DisplayName="Path Exists" Exists="[File_Leave_Register]" sap:VirtualizedContainerService.HintSize="1038,89" sap2010:WorkflowViewState.IdRef="PathExists_4" Path="[Path_Excel_NT + &quot;DONE\LEAVE REGISTER TS.xls&quot;]" PathType="File" />
                                        <If Condition="[File_Leave_Register = True]" sap:VirtualizedContainerService.HintSize="1038,51" sap2010:WorkflowViewState.IdRef="If_162">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Else>
                                            <ui:CopyFile ContinueOnError="{x:Null}" Destination="[Path_Excel_NT + &quot;DONE\LEAVE REGISTER TS.xls&quot;]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="CopyFile_7" Overwrite="False" Path="[Path_Template + &quot;LEAVE REGISTER TS Template.xls&quot;]" />
                                          </If.Else>
                                        </If>
                                        <ui:ExcelApplicationScope Password="{x:Null}" AutoSave="False" CreateNewFile="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="1038,1942" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_10" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;DONE\LEAVE REGISTER TS.xls&quot;]">
                                          <ui:ExcelApplicationScope.Body>
                                            <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="1004,1833" sap2010:WorkflowViewState.IdRef="Sequence_190">
                                                <Sequence.Variables>
                                                  <Variable x:TypeArguments="x:String" Name="row_current" />
                                                </Sequence.Variables>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ee:MoveVerticalActivity MoveColumn="{x:Null}" MoveCount="{x:Null}" BaseCell="A10000" ClipboardCopyFlg="False" CurrentCell="[row_current]" DisplayName="Move vertical activity" sap:VirtualizedContainerService.HintSize="962,144" sap2010:WorkflowViewState.IdRef="MoveVerticalActivity_5" MoveDirection="Up" MoveLastDataRowFlg="True" MoveNextFlg="True" SheetName="[wb.GetSheets(0)]" WorkBook="[wb]" />
                                                <If Condition="[row_current.Remove(0,1) = &quot;3&quot;]" sap:VirtualizedContainerService.HintSize="962,51" sap2010:WorkflowViewState.IdRef="If_163">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_127">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:String">[row_current]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:String">A4</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_128">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:String">[row_current]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:String">["A" + Convert.ToInt32(Convert.ToInt32(row_current.Remove(0,1)) + 1).ToString]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                  </If.Else>
                                                </If>
                                                <ui:ExcelReadRange AddHeaders="False" DataTable="[dt_MSNV]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="962,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_6" Range="[&quot;A4:D&quot; + row_current.Remove(0,1)]" SheetName="[wb.GetSheets(0)]" />
                                                <ui:FilterDataTable DataTable="[dt_MSNV]" DisplayName="Filter Data Table" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="962,59" sap2010:WorkflowViewState.IdRef="FilterDataTable_4" OutputDataTable="[dt_MSNV]" SelectColumnsMode="Keep">
                                                  <ui:FilterDataTable.Filters>
                                                    <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                      <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                                                        <ui:FilterOperationArgument.Column>
                                                          <InArgument x:TypeArguments="x:String">["Column0"]</InArgument>
                                                        </ui:FilterOperationArgument.Column>
                                                        <ui:FilterOperationArgument.Operand>
                                                          <InArgument x:TypeArguments="ui:GenericValue">[MSNV]</InArgument>
                                                        </ui:FilterOperationArgument.Operand>
                                                      </ui:FilterOperationArgument>
                                                    </scg:List>
                                                  </ui:FilterDataTable.Filters>
                                                  <ui:FilterDataTable.SelectColumns>
                                                    <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                      <x:Null />
                                                    </scg:List>
                                                  </ui:FilterDataTable.SelectColumns>
                                                </ui:FilterDataTable>
                                                <If Condition="[dt_MSNV.Rows.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="962,1169" sap2010:WorkflowViewState.IdRef="If_165">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <ui:ForEachRow CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Kiểm tra MSNV nghỉ có trùng ngày nghỉ với đơn trước không" DataTable="[dt_MSNV]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="717,1022" sap2010:WorkflowViewState.IdRef="ForEachRow_5">
                                                      <ui:ForEachRow.Body>
                                                        <ActivityAction x:TypeArguments="sd:DataRow">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="667,844" sap2010:WorkflowViewState.IdRef="Sequence_188">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="625,98" sap2010:WorkflowViewState.IdRef="MultipleAssign_109">
                                                              <ui:MultipleAssign.AssignOperations>
                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_231">
                                                                    <ui:AssignOperation.To>
                                                                      <OutArgument x:TypeArguments="x:String">[Day_First_Template]</OutArgument>
                                                                    </ui:AssignOperation.To>
                                                                    <ui:AssignOperation.Value>
                                                                      <InArgument x:TypeArguments="x:String">[dt_MSNV.Rows(0)(1).ToString.Substring(0,4) + "/" + dt_MSNV.Rows(0)(1).ToString.Substring(4,2) + "/" + dt_MSNV.Rows(0)(1).ToString.Substring(6,2)]</InArgument>
                                                                    </ui:AssignOperation.Value>
                                                                  </ui:AssignOperation>
                                                                </scg:List>
                                                              </ui:MultipleAssign.AssignOperations>
                                                            </ui:MultipleAssign>
                                                            <If Condition="[Convert.ToDateTime(Day_First_Template.ToString) = Convert.ToDateTime(Day_First.ToString)]" sap:VirtualizedContainerService.HintSize="625,614" sap2010:WorkflowViewState.IdRef="If_164">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <Sequence DisplayName="Message error and send mail" sap:VirtualizedContainerService.HintSize="380,467" sap2010:WorkflowViewState.IdRef="Sequence_186">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,222" sap2010:WorkflowViewState.IdRef="MultipleAssign_116">
                                                                    <ui:MultipleAssign.AssignOperations>
                                                                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_289">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Boolean">[Check_LeaveForm]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_290">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="sd:DataRow">[dataRow]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="sd:DataRow">[dt_Error.NewRow]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_291">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("MSNV")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">[MSNV.ToString.Trim]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_292">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("FullName")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">[row(1).ToString.Trim]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_293">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:Object">[dataRow("Note")]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:Object">["Ngày bắt đầu và ngày kết thúc đã được đăng ký trước đó"]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                      </scg:List>
                                                                    </ui:MultipleAssign.AssignOperations>
                                                                  </ui:MultipleAssign>
                                                                  <ui:AddDataRow ArrayRow="{x:Null}" DataRow="[dataRow]" DataTable="[dt_Error]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="AddDataRow_11" />
                                                                  <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel log staff" sap:VirtualizedContainerService.HintSize="338,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_24" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                                                    <ui:ExcelApplicationScope.Body>
                                                                      <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                        <ActivityAction.Argument>
                                                                          <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                        </ActivityAction.Argument>
                                                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,278" sap2010:WorkflowViewState.IdRef="Sequence_237">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_excel.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_72" SheetName="[wb.GetSheets(0)]" Text="Ngày bắt đầu và ngày kết thúc đã được đăng ký trước đó" />
                                                                          <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_24" Workbook="[wb]" />
                                                                        </Sequence>
                                                                      </ActivityAction>
                                                                    </ui:ExcelApplicationScope.Body>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </ui:ExcelApplicationScope>
                                                                </Sequence>
                                                              </If.Then>
                                                              <If.Else>
                                                                <Sequence DisplayName="Input data" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_187">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:ExcelWriteCell Cell="[&quot;A&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_54" SheetName="[wb.GetSheets(0)]" Text="[MSNV]" />
                                                                  <ui:ExcelWriteCell Cell="[&quot;B&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_55" SheetName="[wb.GetSheets(0)]" Text="[Convert.ToDateTime(Day_First.ToString).ToString(&quot;yyyyMMdd&quot;)]" />
                                                                  <ui:ExcelWriteCell Cell="[&quot;J&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_56" SheetName="[wb.GetSheets(0)]" Text="1" />
                                                                  <ui:ExcelSaveWorkbook DisplayName="Save Workbook" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="ExcelSaveWorkbook_10" />
                                                                </Sequence>
                                                              </If.Else>
                                                            </If>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:ForEachRow.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:ForEachRow>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Sequence DisplayName="Input data" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_189">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:ExcelWriteCell Cell="[&quot;A&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_57" SheetName="[wb.GetSheets(0)]" Text="[MSNV]" />
                                                      <ui:ExcelWriteCell Cell="[&quot;B&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_58" SheetName="[wb.GetSheets(0)]" Text="[Convert.ToDateTime(Day_First.ToString).ToString(&quot;yyyyMMdd&quot;)]" />
                                                      <ui:ExcelWriteCell Cell="[&quot;J&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_59" SheetName="[wb.GetSheets(0)]" Text="1" />
                                                      <ui:ExcelSaveWorkbook DisplayName="Save Workbook" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="ExcelSaveWorkbook_11" />
                                                    </Sequence>
                                                  </If.Else>
                                                </If>
                                                <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="962,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_10" Workbook="[wb]" />
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ExcelApplicationScope.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExcelApplicationScope>
                                      </Sequence>
                                    </If.Else>
                                  </If>
                                  <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel log staff" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_13" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                    <ui:ExcelApplicationScope.Body>
                                      <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                        </ActivityAction.Argument>
                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,278" sap2010:WorkflowViewState.IdRef="Sequence_225">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_excel.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_61" SheetName="[wb.GetSheets(0)]" Text="OK" />
                                          <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_13" Workbook="[wb]" />
                                        </Sequence>
                                      </ActivityAction>
                                    </ui:ExcelApplicationScope.Body>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:ExcelApplicationScope>
                                </Sequence>
                              </If.Then>
                            </If>
                            <Assign sap:VirtualizedContainerService.HintSize="1418,60" sap2010:WorkflowViewState.IdRef="Assign_145">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:Int32">[row_excel]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:Int32">[row_excel + 1]</InArgument>
                              </Assign.Value>
                            </Assign>
                          </Sequence>
                        </ActivityAction>
                      </ui:ForEachRow.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:ForEachRow>
                    <If sap2010:Annotation.AnnotationText="Kiểm tra datatable có lỗi không 0 : không lỗi, lớn hơn 0 có vài lỗi phát sinh khi đăng ký nghỉ phép" Condition="[dt_Error.Rows.Count = 0]" sap:VirtualizedContainerService.HintSize="1510,123" sap2010:WorkflowViewState.IdRef="If_173">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If.Then>
                        <ui:SendMail Bcc="{x:Null}" From="{x:Null}" MailMessage="{x:Null}" Name="{x:Null}" TimeoutMS="{x:Null}" Body="[&quot;&lt;/p&gt;&lt;b&gt;Dear HR&lt;/b&gt;&lt;/p&gt;&quot; +&#xA;&quot;&lt;p&gt;LEAVE REGISTER form has information&lt;/p&gt;&quot; +&#xA;&quot;&lt;p&gt;Your form has been sent to HR section successfully&lt;/p&gt;&quot; +&#xA;&quot;&lt;p&gt;File Name : &quot; + Path.GetFileName(File).ToString + &quot;&lt;/p&gt;&quot;]" Cc="[Mail_PIC]" DisplayName="Send SMTP Mail Message" Email="[Mail_Email]" EnableSSL="True" sap:VirtualizedContainerService.HintSize="334,145" sap2010:WorkflowViewState.IdRef="SendMail_48" IsBodyHtml="True" Password="[Mail_Password]" Port="25" SecureConnection="Auto" Server="[Mail_Server]" Subject="[RPA] SUCCESSFUL : LEAVE REGISTER FACTORY" To="ThiHang@ykk.com.vn, ThuyHoa@ykk.com.vn">
                          <ui:SendMail.Files>
                            <scg:List x:TypeArguments="InArgument(x:String)" Capacity="4">
                              <InArgument x:TypeArguments="x:String">[Path_Excel_NT + "Backup\" + Path.GetFileName(File).ToString]</InArgument>
                            </scg:List>
                          </ui:SendMail.Files>
                        </ui:SendMail>
                      </If.Then>
                      <If.Else>
                        <Sequence DisplayName="Send Mail Error" sap:VirtualizedContainerService.HintSize="376,328" sap2010:WorkflowViewState.IdRef="Sequence_207">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="CommentOut_5">
                            <ui:CommentOut.Body>
                              <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="544,143" sap2010:WorkflowViewState.IdRef="Sequence_252">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_11" Workbook="[wb]" WorkbookPath="[Path_Excel_NT + &quot;Backup\&quot; + Path.GetFileName(File).ToString]">
                                  <ui:ExcelApplicationScope.Body>
                                    <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                      <ActivityAction.Argument>
                                        <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                      </ActivityAction.Argument>
                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="468,242" sap2010:WorkflowViewState.IdRef="Sequence_208">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dt_Error]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="ForEachRow_6">
                                          <ui:ForEachRow.Body>
                                            <ActivityAction x:TypeArguments="sd:DataRow">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="376,306" sap2010:WorkflowViewState.IdRef="Sequence_209">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:ExcelLookUpRange DisplayName="LookUp Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelLookUpRange_5" Range="C4:C100" Result="[row_current]" SheetName="[wb.GetSheets(0)]" Value="[row(0).ToString.Trim]" />
                                                <ui:ExcelWriteCell Cell="[&quot;N&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_60" SheetName="[wb.GetSheets(0)]" Text="[row(2).ToString.Trim]" />
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ForEachRow.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ForEachRow>
                                        <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_11" Workbook="[wb]" />
                                      </Sequence>
                                    </ActivityAction>
                                  </ui:ExcelApplicationScope.Body>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:ExcelApplicationScope>
                              </Sequence>
                            </ui:CommentOut.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:CommentOut>
                          <ui:SendMail Bcc="{x:Null}" From="{x:Null}" MailMessage="{x:Null}" Name="{x:Null}" TimeoutMS="{x:Null}" Body="[&quot;&lt;/p&gt;&lt;b&gt;Dear HR&lt;/b&gt;&lt;/p&gt;&quot; +&#xA;&quot;&lt;p&gt;Có một vài trường hợp bị lỗi khi đăng ký nghỉ phép&lt;/p&gt;&quot; +&#xA;&quot;&lt;p&gt;Vui lòng xem file để biết thêm thông tin chi tiết lỗi&lt;/p&gt;&quot; +&#xA;&quot;&lt;p&gt;File Name : &quot; + Path.GetFileName(File).ToString + &quot;&lt;/p&gt;&quot;]" Cc="[Mail_PIC]" DisplayName="Send SMTP Mail Message" Email="[Mail_Email]" EnableSSL="True" sap:VirtualizedContainerService.HintSize="334,145" sap2010:WorkflowViewState.IdRef="SendMail_49" IsBodyHtml="True" Password="[Mail_Password]" Port="25" SecureConnection="Auto" Server="[Mail_Server]" Subject="[RPA] ERROR : Sai thông tin đăng ký LEAVE REGISTER FACTORY" To="ThiHang@ykk.com.vn, ThuyHoa@ykk.com.vn">
                            <ui:SendMail.Files>
                              <scg:List x:TypeArguments="InArgument(x:String)" Capacity="4">
                                <InArgument x:TypeArguments="x:String">[Path_Excel_NT + "Backup\" + Path.GetFileName(File).ToString]</InArgument>
                              </scg:List>
                            </ui:SendMail.Files>
                          </ui:SendMail>
                        </Sequence>
                      </If.Else>
                    </If>
                    <ui:ExcelApplicationScope Password="{x:Null}" sap2010:Annotation.AnnotationText="Excel này ghi log và ghi kết quả để nhận biết file nào bị lỗi để dễ tìm" CreateNewFile="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="1510,108" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_6" Workbook="[wb_log]" WorkbookPath="\\ykkvnm.com\vnmfs\YKKDATA\DEPARTMENT\Human Resources\ROBOTICS\LEAVE REGISTER\EXCEL\Status Log\Status Log.xlsx">
                      <ui:ExcelApplicationScope.Body>
                        <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                          </ActivityAction.Argument>
                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,405" sap2010:WorkflowViewState.IdRef="Sequence_106">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:ExcelLookUpRange Range="{x:Null}" DisplayName="LookUp Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelLookUpRange_2" Result="[row_current]" SheetName="[wb_log.GetSheets(0)]" Value="[Path.GetFileName(File)]" />
                            <ui:ExcelWriteCell Cell="[&quot;C&quot; + row_current.Remove(0,1)]" DisplayName="Write Cell Status" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_30" SheetName="[wb_log.GetSheets(0)]" Text="Successful" />
                            <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_6" Workbook="[wb_log]" />
                          </Sequence>
                        </ActivityAction>
                      </ui:ExcelApplicationScope.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:ExcelApplicationScope>
                  </Sequence>
                </ActivityAction>
              </ui:ForEach.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:ForEach>
          </Sequence>
        </FlowStep>
      </FlowStep.Next>
    </FlowStep>
    <x:Reference>__ReferenceID0</x:Reference>
  </Flowchart>
</Activity>