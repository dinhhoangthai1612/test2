<Activity mc:Ignorable="sap sap2010" x:Class="MONTHLY_REPORT_1" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:ee="clr-namespace:ExcelCustomActivities.Excel;assembly=ExcelCustomActivities" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:p="http://schemas.microsoft.com/workflow/2012/07/xaml/activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:sd1="clr-namespace:System.Drawing;assembly=System.Drawing" xmlns:swf="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="EndStatus" Type="InOutArgument(x:String)" />
    <x:Property Name="EndMessage" Type="InOutArgument(x:String)" />
    <x:Property Name="Order_Number" Type="InOutArgument(x:String)" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1310,1186</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>MONTHLY_REPORT_1_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="82">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>UiPath.Database</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>UiPath.CV</x:String>
      <x:String>UiPathTeam.Excel.Extensions</x:String>
      <x:String>ActiproSoftware.Windows.Controls.Editors</x:String>
      <x:String>System.Globalization</x:String>
      <x:String>System.Windows.Media.Imaging</x:String>
      <x:String>System.Windows</x:String>
      <x:String>System.Windows.Media.Animation</x:String>
      <x:String>System.Windows.Media.Composition</x:String>
      <x:String>System.Windows.Media</x:String>
      <x:String>System.Windows.Threading</x:String>
      <x:String>System.Windows.Forms</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.Activities.DynamicUpdate</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>UiPath.Excel.Activities</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>System.Runtime.InteropServices</x:String>
      <x:String>Microsoft.Activities.Expressions</x:String>
      <x:String>UiPath.Mail</x:String>
      <x:String>UiPath.Mail.SMTP.Activities</x:String>
      <x:String>UiPath.Mail.Activities</x:String>
      <x:String>ExcelCustomActivities.Excel</x:String>
      <x:String>UiPath.Database.Activities</x:String>
      <x:String>UiPath.PDF.Activities.PDF</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="76">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.IntelligentOCR</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.OmniPage.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.CV</AssemblyReference>
      <AssemblyReference>UiPath.Word</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.Database</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>Excel.Activities</AssemblyReference>
      <AssemblyReference>ActiproSoftware.Editors.Wpf</AssemblyReference>
      <AssemblyReference>System.Windows.Forms</AssemblyReference>
      <AssemblyReference>System.Data.Entity</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization</AssemblyReference>
      <AssemblyReference>Microsoft.Activities</AssemblyReference>
      <AssemblyReference>OfficeDevPnP.Core</AssemblyReference>
      <AssemblyReference>UiPathTeam.SharePoint</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities.Design</AssemblyReference>
      <AssemblyReference>ExcelCustomActivities</AssemblyReference>
      <AssemblyReference>UiPath.Database.Activities</AssemblyReference>
      <AssemblyReference>UiPath.PDF.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Presentations</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <sap:WorkflowViewStateService.ViewState>
    <scg:Dictionary x:TypeArguments="x:String, x:Object">
      <x:Boolean x:Key="ShouldExpandAll">True</x:Boolean>
      <x:Boolean x:Key="ShouldCollapseAll">False</x:Boolean>
    </scg:Dictionary>
  </sap:WorkflowViewStateService.ViewState>
  <Flowchart DisplayName="MONTHLY_REPORT_1" sap:VirtualizedContainerService.HintSize="1320,1121" sap2010:WorkflowViewState.IdRef="Flowchart_1">
    <Flowchart.Variables>
      <Variable x:TypeArguments="sd:DataTable" Name="DT_TB3" />
      <Variable x:TypeArguments="x:String" Name="Mail_Server" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_Server" />
      <Variable x:TypeArguments="x:String" Name="Mail_Email" />
      <Variable x:TypeArguments="x:String" Name="Mail_Password" />
      <Variable x:TypeArguments="x:String" Name="Mail_PIC" />
      <Variable x:TypeArguments="x:String" Name="Path_Template" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_path" />
      <Variable x:TypeArguments="x:String" Name="Path_Folder" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="WB_MONTHLY" />
      <Variable x:TypeArguments="x:String" Name="lenght_Monthly" />
      <Variable x:TypeArguments="x:Int32" Name="convert_lenght_monthly" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_MONTHLY_1" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_MONTHLY_Filter" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_MONTHLY_color" />
      <Variable x:TypeArguments="x:String" Name="index_row" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="WB_FILE1" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="WB_MONTHLY1" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_MONTHLY_2" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="WB_FILE2" />
      <Variable x:TypeArguments="x:String" Name="day_current" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="WB_ShotUpdate" />
      <Variable x:TypeArguments="x:Int32" Name="convert_ShotUpdate" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="WB_CCI" />
      <Variable x:TypeArguments="x:String" Name="lenght_ShotUpdate" />
      <Variable x:TypeArguments="x:String" Name="lenght_CCI" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_ByLine" />
      <Variable x:TypeArguments="x:Int32" Name="convert_lenght_CCI" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_MULTIPLE" />
      <Variable x:TypeArguments="x:Int32" Name="convert_lenght_CCI_new" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_DATE" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_sensitive" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_TABLE1" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_TABLE2" />
      <Variable x:TypeArguments="sd:DataTable" Default="[new System.Data.DataTable]" Name="DT_TABLE_Clone" />
      <Variable x:TypeArguments="x:String" Name="index_grandtotal" />
      <Variable x:TypeArguments="x:String" Name="lenght_right" />
      <Variable x:TypeArguments="x:Int32" Name="count_column_DT1" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="WB_TEMPLATE" />
      <Variable x:TypeArguments="x:Int32" Name="count_column_DT2" />
      <Variable x:TypeArguments="x:Int32" Name="index_cl" />
      <Variable x:TypeArguments="x:Int32" Name="count_row" />
      <Variable x:TypeArguments="x:Int32" Name="index_rows" />
      <Variable x:TypeArguments="x:String" Name="index_lenght_right" />
      <Variable x:TypeArguments="x:Int32" Name="count_row_TB2" />
      <Variable x:TypeArguments="x:Int32" Name="count_row_TB1" />
      <Variable x:TypeArguments="x:Int32" Name="index_lenght_right_int" />
      <Variable x:TypeArguments="x:Int32" Name="index_CV" />
      <Variable x:TypeArguments="s:DateTime" Name="monthReport" />
      <Variable x:TypeArguments="x:String" Name="queryStr" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtCalendar" />
      <Variable x:TypeArguments="x:String" Name="day_First" />
      <Variable x:TypeArguments="x:String" Name="day_Second" />
      <Variable x:TypeArguments="sd:DataTable" Name="Data_Date" />
      <Variable x:TypeArguments="x:Int32" Name="found_day" />
      <Variable x:TypeArguments="x:String" Name="Current_1" />
      <Variable x:TypeArguments="x:String" Name="queryStrAll" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtCalendarAll" />
      <Variable x:TypeArguments="x:Int32" Name="day_Current_now" />
      <Variable x:TypeArguments="x:Int32" Name="month_Current" />
      <Variable x:TypeArguments="x:String" Name="year_Current" />
      <Variable x:TypeArguments="x:Int32" Name="month_1" />
      <Variable x:TypeArguments="x:Int32" Name="day_1_int" />
      <Variable x:TypeArguments="x:String" Name="get_Folder" />
      <Variable x:TypeArguments="x:String" Name="path_Folder_Report" />
      <Variable x:TypeArguments="x:String" Name="day_1" />
      <Variable x:TypeArguments="x:Boolean" Name="check_File" />
      <Variable x:TypeArguments="x:String" Name="Current_2" />
      <Variable x:TypeArguments="x:Int32" Name="day_2_int" />
      <Variable x:TypeArguments="x:String" Name="varRg" />
      <Variable x:TypeArguments="x:String" Name="varLastCol" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="wb" />
      <Variable x:TypeArguments="x:String" Name="get_FolderInput" />
      <Variable x:TypeArguments="x:String" Name="path_Folder_InsE" />
      <Variable x:TypeArguments="x:String" Name="path_Folder_InsE_1" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_INSPECE" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_qrCOLOR" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_qrLOT" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_INSPECE_1" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_INSPECE_FILTER" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_INSPECE_1_FILTER" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_CMC_FIRST_E" />
      <Variable x:TypeArguments="sd:DataTable" Name="CMC" />
      <Variable x:TypeArguments="x:Int32" Name="CL_E" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_CMC_FISRT_E1" />
      <Variable x:TypeArguments="x:Int32" Name="CL_E1" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_CMC_FINAL_E1" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="WB_CA" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_CMC_FINAL_E" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="WB_REPORT" />
      <Variable x:TypeArguments="x:String" Name="LENGHT_COL" />
      <Variable x:TypeArguments="x:Int32" Name="COL_CURRENT" />
      <Variable x:TypeArguments="x:String" Name="result_CMC" />
      <Variable x:TypeArguments="sd:DataTable" Name="CMC_RESULT" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_CMC_1" />
      <Variable x:TypeArguments="x:Boolean" Name="check_element" />
      <Variable x:TypeArguments="x:String" Name="day_curent_filter" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_LAB" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_lab1" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_INSPECE_1_F" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_CMC_E" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_CMC_E1" />
      <Variable x:TypeArguments="x:String" Name="path_data_query" />
      <Variable x:TypeArguments="x:String" Name="query_cmc" />
      <Variable x:TypeArguments="x:String" Name="found_cl" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_2Filter" />
      <Variable x:TypeArguments="x:String" Name="index_header" />
      <Variable x:TypeArguments="x:String" Name="read_header" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_TABLE2_filter" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_TABLE3" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_TOTAL" />
      <Variable x:TypeArguments="x:String" Name="get_name" />
      <Variable x:TypeArguments="x:String" Name="m" />
      <Variable x:TypeArguments="x:String" Name="d1" />
      <Variable x:TypeArguments="x:Int32" Name="DAY" />
      <Variable x:TypeArguments="x:String" Name="D" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_TABLE2_DATE" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_TABLE1_DATE" />
      <Variable x:TypeArguments="x:Int32" Name="found_delete" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_TABLE3_DATE" />
      <Variable x:TypeArguments="x:String" Name="paste_data" />
      <Variable x:TypeArguments="s:DateTime" Name="day_week" />
      <Variable x:TypeArguments="x:Int32" Name="D_w" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_PICTURE" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="WB_PC" />
      <Variable x:TypeArguments="x:String" Name="path_temple" />
      <Variable x:TypeArguments="x:String" Name="path_test" />
      <Variable x:TypeArguments="x:String" Name="path_VBA" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_HEADER" />
      <Variable x:TypeArguments="x:String" Name="path_picture" />
      <Variable x:TypeArguments="ui:Image" Name="Image" />
      <Variable x:TypeArguments="swf:Clipboard" Name="clipboard" />
      <Variable x:TypeArguments="sd:DataTable" Name="FIVE_COL" />
      <Variable x:TypeArguments="sd:DataTable" Name="TO_COL" />
      <Variable x:TypeArguments="sd:DataTable" Name="NEWCOL" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_TOTAL_CM" />
      <Variable x:TypeArguments="x:String" Name="cell_index" />
      <Variable x:TypeArguments="x:Boolean" Name="checkFlag" />
      <Variable x:TypeArguments="x:String" Name="mailBCC" />
      <Variable x:TypeArguments="x:String" Name="mailCC" />
      <Variable x:TypeArguments="x:String" Name="mailTO" />
      <Variable x:TypeArguments="x:String" Name="stNoteLink" />
      <Variable x:TypeArguments="x:String" Name="mailTextHTML" />
      <Variable x:TypeArguments="x:String" Name="path_robotics" />
      <Variable x:TypeArguments="x:Boolean" Name="Check_day" />
      <Variable x:TypeArguments="x:String" Name="delete_file" />
      <Variable x:TypeArguments="x:String" Name="lastDayMonth" />
      <Variable x:TypeArguments="x:String" Name="check_DayToTal" />
      <Variable x:TypeArguments="sd:DataTable" Name="DT_EMPL" />
      <Variable x:TypeArguments="ui:WorkbookApplication" Name="wbCMC" />
      <Variable x:TypeArguments="x:String" Name="strSQL" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtData" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_CMC" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_E" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_E1" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_Final" />
      <Variable x:TypeArguments="x:String" Name="stYear" />
      <Variable x:TypeArguments="x:String" Name="stMonth" />
      <Variable x:TypeArguments="x:String" Name="stDate" />
      <Variable x:TypeArguments="x:String" Name="stDate1" />
      <Variable x:TypeArguments="x:Int32" Name="i" />
      <Variable x:TypeArguments="s:String[]" Name="arrDate">
        <Variable.Default>
          <mva:VisualBasicValue x:TypeArguments="s:String[]" ExpressionText="{}{}" />
        </Variable.Default>
      </Variable>
    </Flowchart.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <av:Point x:Key="ShapeLocation">530,2.5</av:Point>
        <av:Size x:Key="ShapeSize">60,75</av:Size>
        <av:PointCollection x:Key="ConnectorLocation">560,77.5 560,127</av:PointCollection>
        <x:Double x:Key="Height">1085</x:Double>
        <x:Double x:Key="Width">1286.2585270168995</x:Double>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Flowchart.StartNode>
      <x:Reference>__ReferenceID12</x:Reference>
    </Flowchart.StartNode>
    <FlowStep x:Name="__ReferenceID12">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">460,127</av:Point>
          <av:Size x:Key="ShapeSize">200,66</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">560,193 560,237</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <Sequence DisplayName="Setting SQL" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_612">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_3" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
          <ui:InvokeWorkflowFile.Arguments>
            <InArgument x:TypeArguments="x:String" x:Key="Query">SELECT * FROM RPALIB.LIBRARY_NT WHERE Name IN ('ServerSavedFile','dirDownFile','ServerTemp') ORDER BY UPPER(NAME) ASC</InArgument>
            <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_Path]</OutArgument>
          </ui:InvokeWorkflowFile.Arguments>
        </ui:InvokeWorkflowFile>
        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Lấy tài khoản Mail" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_4" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
          <ui:InvokeWorkflowFile.Arguments>
            <InArgument x:TypeArguments="x:String" x:Key="Query">SELECT * FROM RPALIB.LIBRARY_NT WHERE Name IN ('MailAddress','MailPassword','MailServer') ORDER BY UPPER(NAME) ASC</InArgument>
            <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_Server]</OutArgument>
          </ui:InvokeWorkflowFile.Arguments>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
        </ui:InvokeWorkflowFile>
        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="334,191" sap2010:WorkflowViewState.IdRef="MultipleAssign_82">
          <ui:MultipleAssign.AssignOperations>
            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_272">
                <ui:AssignOperation.To>
                  <OutArgument x:TypeArguments="x:String">[Mail_Server]</OutArgument>
                </ui:AssignOperation.To>
                <ui:AssignOperation.Value>
                  <InArgument x:TypeArguments="x:String">[dt_Server.Rows(2)(1).ToString]</InArgument>
                </ui:AssignOperation.Value>
              </ui:AssignOperation>
              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_273">
                <ui:AssignOperation.To>
                  <OutArgument x:TypeArguments="x:String">[Mail_Email]</OutArgument>
                </ui:AssignOperation.To>
                <ui:AssignOperation.Value>
                  <InArgument x:TypeArguments="x:String">[dt_Server.Rows(0)(1).ToString]</InArgument>
                </ui:AssignOperation.Value>
              </ui:AssignOperation>
              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_274">
                <ui:AssignOperation.To>
                  <OutArgument x:TypeArguments="x:String">[Mail_Password]</OutArgument>
                </ui:AssignOperation.To>
                <ui:AssignOperation.Value>
                  <InArgument x:TypeArguments="x:String">[dt_Server.Rows(1)(1).ToString]</InArgument>
                </ui:AssignOperation.Value>
              </ui:AssignOperation>
              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_275">
                <ui:AssignOperation.To>
                  <OutArgument x:TypeArguments="x:String">[Path_Template]</OutArgument>
                </ui:AssignOperation.To>
                <ui:AssignOperation.Value>
                  <InArgument x:TypeArguments="x:String">[dt_Path.Rows(2)(1).ToString]</InArgument>
                </ui:AssignOperation.Value>
              </ui:AssignOperation>
            </scg:List>
          </ui:MultipleAssign.AssignOperations>
        </ui:MultipleAssign>
      </Sequence>
      <FlowStep.Next>
        <FlowStep x:Name="__ReferenceID0">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:Point x:Key="ShapeLocation">460,237</av:Point>
              <av:Size x:Key="ShapeSize">200,66</av:Size>
              <av:PointCollection x:Key="ConnectorLocation">560,303 560,357</av:PointCollection>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Sequence DisplayName="Check DateTime" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_971">
            <Sequence.Variables>
              <Variable x:TypeArguments="sd:DataTable" Name="dt_Calendar" />
              <Variable x:TypeArguments="x:String" Name="getDate" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_1076">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[getDate]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString("yyyyMMdd")]</InArgument>
              </Assign.Value>
            </Assign>
            <If Condition="[arrDate.Count &gt; 0]" DisplayName="If get by manually" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_215">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <If.Then>
                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1100">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[getDate]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">[arrDate(i).ToString]</InArgument>
                  </Assign.Value>
                </Assign>
              </If.Then>
            </If>
            <Assign sap:VirtualizedContainerService.HintSize="334,64" sap2010:WorkflowViewState.IdRef="Assign_1077">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String" xml:space="preserve">SELECT YMDU02
FROM WAVEDLIB.C0200
WHERE YMDU02 &lt;= ((1)) AND DPTC02='01'
ORDER BY YMDU02 DESC
LIMIT 2</InArgument>
              </Assign.Value>
            </Assign>
            <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Calendar]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_156" ProviderName="System.Data.Odbc" Sql="[strSQL.Replace(&quot;((1))&quot;,getDate)]" ConnectionString="Driver={ISeries Access ODBC Driver};system=10.246.194.1;library=WAVEDLIB;querytimeout=0;uid=VNPRT;pwd=VNPRT">
              <ui:ExecuteQuery.Parameters>
                <scg:Dictionary x:TypeArguments="x:String, Argument" />
              </ui:ExecuteQuery.Parameters>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:ExecuteQuery>
            <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="334,191" sap2010:WorkflowViewState.IdRef="MultipleAssign_88">
              <ui:MultipleAssign.AssignOperations>
                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_292">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:String">[stYear]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:String">[dt_Calendar.Rows(1)(0).ToString.Substring(0,4)]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_293">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:String">[stMonth]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:String">[dt_Calendar.Rows(1)(0).ToString.Substring(4,2)]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_294">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:String">[stDate]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:String">[dt_Calendar.Rows(0)(0).ToString.Substring(0,4) +"/" + dt_Calendar.Rows(0)(0).ToString.Substring(4,2) + "/" + dt_Calendar.Rows(0)(0).ToString.Substring(6,2)]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_295">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:String">[stDate1]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:String">[dt_Calendar.Rows(1)(0).ToString.Substring(6,2)]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                </scg:List>
              </ui:MultipleAssign.AssignOperations>
            </ui:MultipleAssign>
            <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="CommentOut_257">
              <ui:CommentOut.Body>
                <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="526,328" sap2010:WorkflowViewState.IdRef="Sequence_1010">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If Condition="[dt_Calendar.Rows(0)(0).ToString=DateTime.Now.ToString(&quot;yyyyMMdd&quot;)]" sap:VirtualizedContainerService.HintSize="484,236" sap2010:WorkflowViewState.IdRef="If_201">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </If>
                </Sequence>
              </ui:CommentOut.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:CommentOut>
          </Sequence>
          <FlowStep.Next>
            <FlowStep x:Name="__ReferenceID3">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">460,357</av:Point>
                  <av:Size x:Key="ShapeSize">200,66</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">560,423 560,447</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Sequence DisplayName="GET DATA" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_982">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:CopyFile ContinueOnError="{x:Null}" Destination="[Path_Template + &quot;CCI MONTHLY REPORT\Monthly_Data.xlsx&quot;]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="494,157" sap2010:WorkflowViewState.IdRef="CopyFile_26" Overwrite="True" Path="[Path_Template + &quot;CCI MONTHLY REPORT\NEW TEMPLATE\CMC Calc Form_TEMPLATE.xlsx&quot;]">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:CopyFile>
                <ui:ExcelApplicationScope Password="{x:Null}" AutoSave="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="494,1940" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_148" InstanceCachePeriod="3000" Workbook="[wbCMC]" WorkbookPath="[Path_Template + &quot;CCI MONTHLY REPORT\Monthly_Data.xlsx&quot;]">
                  <ui:ExcelApplicationScope.Body>
                    <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="418,1831" sap2010:WorkflowViewState.IdRef="Sequence_979">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Sequence DisplayName="CMC" sap:VirtualizedContainerService.HintSize="376,66" sap2010:WorkflowViewState.IdRef="Sequence_972">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Assign sap:VirtualizedContainerService.HintSize="334,64" sap2010:WorkflowViewState.IdRef="Assign_1053">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String" xml:space="preserve">SELECT Date, [PR.No], PR_WINGS, [M/C], RECIPE, COMM2, Item, TCC, '''' + Color
,SEN1,SEN2,SEN3,SEN4
, Length, [R. Length], [D. Length], KND, RC, STP, PRG, Times, RESULT,
CASE WHEN NEWCOL = 'TRUE' THEN 1 ELSE 0 END NEWCOL
, L, a, b, '' L1, '' a1, '' b1
,'' DL1, '' Da1, '' Db1, '' DC1, '' DE1
,L2,a2,b2

,(L2 - L) DL,
(a2 - a) Da,
(b2 - b) Db,
(SQRT(a2*a2+b2*b2) - SQRT(a*a+b*b)) DC,
SQRT((L2 - L)*(L2 - L)+(a2 - a)*(a2 - a)+(b2 - b)*(b2 - b)) DE

FROM 
(Select Convert(varchar,P.Date2,111) As Date,P.Denpno [PR.No],
CASE WHEN LEFT(P.Denpno,1)= 'L' THEN 'PR' + RIGHT(P.Denpno,8)
ELSE P.Denpno END AS PR_WINGS,
P.MCNM3 [M/C],
CASE WHEN P.MCNM3 = '' THEN '' 
WHEN COMM2 LIKE '%'+P.MCNM3+'%' AND COMM2 &lt;&gt; '' THEN 'OK'
ELSE 'NG' END AS RECIPE,

COMM2,P.Item,I.TCC,P.Col Color
,SEN1,SEN2,SEN3,SEN4
,P.Len Length,P.CLen [R. Length],P.DLen [D. Length],
P.KND,P.PROCS RC,P.STP,P.PRG,'0' Times,
CASE WHEN P.DLen &gt; 0 THEN 'OK' ELSE 'NG' END RESULT, P.NEWCOL,
(SELECT TOP 1 L FROM Inspec_E1.dbo.BASE WHERE Color = P.Col) L,
(SELECT TOP 1 a FROM Inspec_E1.dbo.BASE WHERE Color = P.Col) a,
(SELECT TOP 1 b FROM Inspec_E1.dbo.BASE WHERE Color = P.Col) b,
--B.L,B.a,B.b,
CASE WHEN L1 IS NULL THEN 0 ELSE L1 END L2,
CASE WHEN a1 IS NULL THEN 0 ELSE a1 END a2,
CASE WHEN b1 IS NULL THEN 0 ELSE b1 END b2

From NCCW_E.dbo.PROD P 
LEFT Join NCCW_E.dbo.ITEM I On P.ITEM = I.ITEM 
--LEFT JOIN Inspec_E1.dbo.BASE B ON Color = P.Col
LEFT JOIN Inspec_E1.dbo.C001 C ON Lot = P.Denpno
Where YEAR(P.Date2) ='((1))' AND MONTH(P.Date2) = '((2))' AND Convert(varchar,P.Date2,111)&lt;&gt;'((3))'
--Where YEAR(P.Date2) ='2021' AND MONTH(P.Date2) = '05' AND Convert(varchar,P.Date2,111)&lt;&gt;'2021/05/10'
AND P.PRG = '4' 
And Not EXISTS(
Select Lot 
From Inspec_E.dbo.C001 C1 
Where C1.Lot = P.Denpno)  
And Not EXISTS(
Select Lot 
From Inspec_E1.dbo.C001 EC1 
Where EC1.Lot = P.Denpno) --Order By P.Denpno
)
 A WHERE L IS NOT NULL 
Order By [PR.No]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_1054">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[strSQL.Replace("((1))",stYear).Replace("((2))",stMonth).Replace("((3))",stDate)]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dtData]" DisplayName="Execute Query CMC" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_157" ProviderName="System.Data.SqlClient" Sql="[strSQL]" ConnectionString="Data Source=10.246.194.7;Initial Catalog=Inspec_E1;User ID=CCIE;Password=CCIVER@123">
                            <ui:ExecuteQuery.Parameters>
                              <scg:Dictionary x:TypeArguments="x:String, Argument" />
                            </ui:ExecuteQuery.Parameters>
                          </ui:ExecuteQuery>
                          <ui:ExcelWriteRange AddHeaders="False" DataTable="[dtData]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_456" SheetName="CMC" StartingCell="A2" />
                          <ui:ExcelReadRange AddHeaders="False" DataTable="[dt_CMC]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_221" Range="[&quot;A2:AT&quot; + (dtData.Rows.Count + 1).ToString]" SheetName="CMC" />
                          <ui:FilterDataTable DataTable="[dt_CMC]" DisplayName="Filter Data Table" FilterRowsMode="Remove" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="FilterDataTable_226" OutputDataTable="[dt_CMC]" SelectColumnsMode="Keep">
                            <ui:FilterDataTable.Filters>
                              <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                                  <ui:FilterOperationArgument.Column>
                                    <InArgument x:TypeArguments="x:Int32">[38]</InArgument>
                                  </ui:FilterOperationArgument.Column>
                                  <ui:FilterOperationArgument.Operand>
                                    <InArgument x:TypeArguments="x:Int32">[-2146826252]</InArgument>
                                  </ui:FilterOperationArgument.Operand>
                                </ui:FilterOperationArgument>
                              </scg:List>
                            </ui:FilterDataTable.Filters>
                            <ui:FilterDataTable.SelectColumns>
                              <scg:List x:TypeArguments="InArgument" Capacity="4">
                                <x:Null />
                              </scg:List>
                            </ui:FilterDataTable.SelectColumns>
                          </ui:FilterDataTable>
                        </Sequence>
                        <Sequence DisplayName="E" sap:VirtualizedContainerService.HintSize="376,610" sap2010:WorkflowViewState.IdRef="Sequence_973">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Assign sap:VirtualizedContainerService.HintSize="334,64" sap2010:WorkflowViewState.IdRef="Assign_1055">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String" xml:space="preserve">--E1
SELECT Date, [PR.No], PR_WINGS, [M/C], RECIPE, COMM2, Item, TCC, '''' + Color
,SEN1,SEN2,SEN3,SEN4
, Length, [R. Length], [D. Length], KND, RC, STP, PRG, Times, RESULT,
CASE WHEN NEWCOL = 'TRUE' THEN 1 ELSE 0 END NEWCOL
, L, a, b, L1, a1, b1
--,DL1, Da1, Db1, DC1, DE1, DL, Da, Db, DC, DE
,(L1 - L) DL1
,(a1 - a) Da1
,(b1 - b) Db1
,(SQRT(a1*a1+b1*b1) - SQRT(a*a+b*b)) DC1
,SQRT((L1 - L)*(L1 - L)+(a1 - a)*(a1 - a)+(b1 - b)*(b1 - b)) DE1

 
 , L2, a2, b2
,(L2 - L) DL
,(a2 - a) Da
,(b2 - b) Db
,(SQRT(a2*a2+b2*b2) - SQRT(a*a+b*b)) DC
,SQRT((L2 - L)*(L2 - L)+(a2 - a)*(a2 - a)+(b2 - b)*(b2 - b)) DE


FROM (Select CONVERT(varchar,P.Date2,111) As Date,P.Denpno As  'PR.No',
CASE WHEN LEFT(P.Denpno,1)= 'L' THEN 'PR' + RIGHT(P.Denpno,8)
ELSE P.Denpno END AS PR_WINGS,
P.MCNM3 As 'M/C',
CASE WHEN P.MCNM3 = '' THEN '' 
WHEN COMM2 LIKE '%'+P.MCNM3+'%' AND COMM2 &lt;&gt; '' THEN 'OK'
ELSE 'NG' END AS RECIPE,COMM2,

P.Item,I.TCC,P.Col AS Color
,SEN1,SEN2,SEN3,SEN4
,P.Len AS  'Length',P.CLen As 'R. Length',
P.DLen AS 'D. Length',P.KND AS KND ,P.PROCS AS  'RC',P.STP,P.PRG As PRG ,C1.ADDC As 'Times',
CASE WHEN C1.ADDC = 0 AND P.DLen &gt; 0 THEN 'OK' ELSE 'NG' END AS RESULT,
P.NEWCOL,
(SELECT TOP 1 L FROM Inspec_E1.dbo.BASE WHERE Color = P.Col) L,
(SELECT TOP 1 a FROM Inspec_E1.dbo.BASE WHERE Color = P.Col) a,
(SELECT TOP 1 b FROM Inspec_E1.dbo.BASE WHERE Color = P.Col) b,
--B.L,B.a,B.b,
CASE WHEN L1 IS NULL THEN 0 ELSE L1 END L1,
CASE WHEN a1 IS NULL THEN 0 ELSE a1 END a1,
CASE WHEN b1 IS NULL THEN 0 ELSE b1 END b1,

L as L2,
a as a2,
b as b2
From Inspec_E1.dbo.C001 C1 
LEFT Join NCCW_E.dbo.PROD P On C1.Lot = P.Denpno 
LEFT Join NCCW_E.dbo.ITEM I On C1.Sizep = I.ITEM  
Where YEAR(P.Date2) ='((1))' AND MONTH(P.Date2) = '((2))' AND Convert(varchar,P.Date2,111)&lt;&gt;'((3))'
--Where YEAR(P.Date2) ='2021' AND MONTH(P.Date2) = '05' AND Convert(varchar,P.Date2,111)&lt;&gt;'2021/05/10'
) ABB
ORDER BY [PR.No]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_1056">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[strSQL.Replace("((1))",stYear).Replace("((2))",stMonth).Replace("((3))",stDate)]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dtData]" DisplayName="Execute Query InspecE" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_158" ProviderName="System.Data.SqlClient" Sql="[strSQL]" ConnectionString="Data Source=10.246.194.7;Initial Catalog=Inspec_E1;User ID=CCIE;Password=CCIVER@123">
                            <ui:ExecuteQuery.Parameters>
                              <scg:Dictionary x:TypeArguments="x:String, Argument" />
                            </ui:ExecuteQuery.Parameters>
                          </ui:ExecuteQuery>
                          <ui:ExcelWriteRange AddHeaders="False" DataTable="[dtData]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_457" SheetName="E" StartingCell="A2" />
                          <ui:ExcelReadRange AddHeaders="False" DataTable="[dt_E]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_222" Range="[&quot;A2:AT&quot; + (dtData.Rows.Count + 1).ToString]" SheetName="E" />
                        </Sequence>
                        <Sequence DisplayName="E1" sap:VirtualizedContainerService.HintSize="376,610" sap2010:WorkflowViewState.IdRef="Sequence_974">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Assign sap:VirtualizedContainerService.HintSize="334,64" sap2010:WorkflowViewState.IdRef="Assign_1057">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String" xml:space="preserve">SELECT Date, [PR.No], PR_WINGS, [M/C], RECIPE, COMM2, Item, TCC, '''' + Color
,SEN1,SEN2,SEN3,SEN4
, Length, [R. Length], [D. Length], KND, RC, STP, PRG, Times, RESULT,
CASE WHEN NEWCOL = 'TRUE' THEN 1 ELSE 0 END NEWCOL
, L, a, b, L1, a1, b1
--,DL1, Da1, Db1, DC1, DE1, DL, Da, Db, DC, DE
,(L1 - L) DL1
,(a1 - a) Da1
,(b1 - b) Db1
,(SQRT(a1*a1+b1*b1) - SQRT(a*a+b*b)) DC1
,SQRT((L1 - L)*(L1 - L)+(a1 - a)*(a1 - a)+(b1 - b)*(b1 - b)) DE1

 , L2, a2, b2
,(L2 - L) DL
,(a2 - a) Da
,(b2 - b) Db
,(SQRT(a2*a2+b2*b2) - SQRT(a*a+b*b)) DC
,SQRT((L2 - L)*(L2 - L)+(a2 - a)*(a2 - a)+(b2 - b)*(b2 - b)) DE

FROM (Select CONVERT(varchar,P.Date2,111) As Date,P.Denpno As  'PR.No',
CASE WHEN LEFT(P.Denpno,1)= 'L' THEN 'PR' + RIGHT(P.Denpno,8)
ELSE P.Denpno END AS PR_WINGS,
P.MCNM3 As 'M/C',
CASE WHEN P.MCNM3 = '' THEN '' 
WHEN COMM2 LIKE '%'+P.MCNM3+'%' AND COMM2 &lt;&gt; '' THEN 'OK'
ELSE 'NG' END AS RECIPE,COMM2,

P.Item,I.TCC,P.Col AS Color
,SEN1,SEN2,SEN3,SEN4
,P.Len AS  'Length',P.CLen As 'R. Length',
P.DLen AS 'D. Length',P.KND AS KND ,P.PROCS AS  'RC',P.STP,P.PRG As PRG ,C1.ADDC As 'Times',
CASE WHEN C1.ADDC = 0 AND P.DLen &gt; 0 THEN 'OK' ELSE 'NG' END AS RESULT,
P.NEWCOL,
(SELECT TOP 1 L FROM Inspec_E.dbo.BASE WHERE Color = P.Col) L,
(SELECT TOP 1 a FROM Inspec_E.dbo.BASE WHERE Color = P.Col) a,
(SELECT TOP 1 b FROM Inspec_E.dbo.BASE WHERE Color = P.Col) b,
--B.L,B.a,B.b,
CASE WHEN L1 IS NULL THEN 0 ELSE L1 END L1,
CASE WHEN a1 IS NULL THEN 0 ELSE a1 END a1,
CASE WHEN b1 IS NULL THEN 0 ELSE b1 END b1,

L as L2,
a as a2,
b as b2
From Inspec_E.dbo.C001 C1 
LEFT Join NCCW_E.dbo.PROD P On C1.Lot = P.Denpno 
LEFT Join NCCW_E.dbo.ITEM I On C1.Sizep = I.ITEM  
Where YEAR(P.Date2) ='((1))' AND MONTH(P.Date2) = '((2))' AND Convert(varchar,P.Date2,111)&lt;&gt;'((3))'
--Where YEAR(P.Date2) ='2021' AND MONTH(P.Date2) = '05' AND Convert(varchar,P.Date2,111)&lt;&gt;'2021/05/10'
--ORDER BY P.Denpno
) ABB
ORDER BY [PR.No]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_1058">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[strSQL.Replace("((1))",stYear).Replace("((2))",stMonth).Replace("((3))",stDate)]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dtData]" DisplayName="Execute Query InspecE_1" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_159" ProviderName="System.Data.SqlClient" Sql="[strSQL]" ConnectionString="Data Source=10.246.194.7;Initial Catalog=Inspec_E1;User ID=CCIE;Password=CCIVER@123">
                            <ui:ExecuteQuery.Parameters>
                              <scg:Dictionary x:TypeArguments="x:String, Argument" />
                            </ui:ExecuteQuery.Parameters>
                          </ui:ExecuteQuery>
                          <ui:ExcelWriteRange AddHeaders="False" DataTable="[dtData]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_458" SheetName="E1" StartingCell="A2" />
                          <ui:ExcelReadRange AddHeaders="False" DataTable="[dt_E1]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_223" Range="[&quot;A2:AT&quot; + (dtData.Rows.Count + 1).ToString]" SheetName="E1" />
                        </Sequence>
                        <Sequence DisplayName="Employee" sap:VirtualizedContainerService.HintSize="376,66" sap2010:WorkflowViewState.IdRef="Sequence_1001">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[DT_EMPL]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_166" ProviderName="System.Data.Odbc" Sql="SELECT TRIM(EMPC) EMPC,UIDC,FEMI&#xA;FROM POPDYE.MST_EMPL" ConnectionString="Dsn=POPDYE;uid=POPDYE;pwd=POPDYE">
                            <ui:ExecuteQuery.Parameters>
                              <scg:Dictionary x:TypeArguments="x:String, Argument" />
                            </ui:ExecuteQuery.Parameters>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:ExecuteQuery>
                          <ui:ExcelWriteRange AddHeaders="False" DataTable="[DT_EMPL]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_473" SheetName="Employee" StartingCell="A2" />
                        </Sequence>
                        <Sequence DisplayName="REDYE_CAUSE" sap:VirtualizedContainerService.HintSize="376,66" sap2010:WorkflowViewState.IdRef="Sequence_1002">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[DT_EMPL]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_167" ProviderName="System.Data.Odbc" Sql="SELECT TRIM(REDYRESCD),TRIM(REDYRES_1)&#xA;FROM POPDYE.V_F_REDYRES" ConnectionString="Dsn=POPDYE;uid=POPDYE;pwd=POPDYE">
                            <ui:ExecuteQuery.Parameters>
                              <scg:Dictionary x:TypeArguments="x:String, Argument" />
                            </ui:ExecuteQuery.Parameters>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:ExecuteQuery>
                          <ui:ExcelWriteRange AddHeaders="False" DataTable="[DT_EMPL]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_474" SheetName="REDYE" StartingCell="A2" />
                        </Sequence>
                        <ui:ExcelSaveWorkbook DisplayName="Save Workbook" sap:VirtualizedContainerService.HintSize="376,22" sap2010:WorkflowViewState.IdRef="ExcelSaveWorkbook_56" />
                        <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="376,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_101" Workbook="[wbCMC]" />
                      </Sequence>
                    </ActivityAction>
                  </ui:ExcelApplicationScope.Body>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ExcelApplicationScope>
                <Sequence DisplayName="CMC DATA" sap:VirtualizedContainerService.HintSize="494,1084" sap2010:WorkflowViewState.IdRef="Sequence_1003">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:CopyFile ContinueOnError="{x:Null}" Destination="[Path_Template + &quot;CCI MONTHLY REPORT\IMPORT DATA\CMCREPORT.xls&quot;]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="452,157" sap2010:WorkflowViewState.IdRef="CopyFile_27" Overwrite="True" Path="[Path_Template + &quot;CCI MONTHLY REPORT\IMPORT DATA\CMC_TEMPLATE.xls&quot;]">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:CopyFile>
                  <ui:ExcelApplicationScope Password="{x:Null}" AutoSave="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="452,795" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_149" InstanceCachePeriod="3000" Workbook="[wbCMC]" WorkbookPath="[Path_Template + &quot;CCI MONTHLY REPORT\IMPORT DATA\CMCREPORT.xls&quot;]">
                    <ui:ExcelApplicationScope.Body>
                      <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="418,686" sap2010:WorkflowViewState.IdRef="Sequence_981">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Sequence DisplayName="Get data" sap:VirtualizedContainerService.HintSize="376,433" sap2010:WorkflowViewState.IdRef="Sequence_980">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:ExcelWriteRange AddHeaders="False" DataTable="[dt_CMC]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_463" SheetName="CMCCALC" StartingCell="A2" />
                            <ui:ExcelWriteRange AddHeaders="False" DataTable="[dt_E]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_464" SheetName="CMCCALC" StartingCell="[&quot;A&quot; + (dt_CMC.Rows.Count + 2).ToString]" />
                            <ui:ExcelWriteRange AddHeaders="False" DataTable="[dt_E1]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_465" SheetName="CMCCALC" StartingCell="[&quot;A&quot; + (dt_CMC.Rows.Count + dt_E.Rows.Count+ 2).ToString]" />
                          </Sequence>
                          <ui:ExcelSaveWorkbook DisplayName="Save Workbook" sap:VirtualizedContainerService.HintSize="376,22" sap2010:WorkflowViewState.IdRef="ExcelSaveWorkbook_57" />
                          <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="376,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_102" Workbook="[wbCMC]" />
                        </Sequence>
                      </ActivityAction>
                    </ui:ExcelApplicationScope.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:ExcelApplicationScope>
                </Sequence>
                <Sequence DisplayName="REDYE DATA" sap:VirtualizedContainerService.HintSize="452,66" sap2010:WorkflowViewState.IdRef="Sequence_1004">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:CopyFile ContinueOnError="{x:Null}" Destination="[Path_Template + &quot;CCI MONTHLY REPORT\IMPORT DATA\REDYE.xls&quot;]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="434,157" sap2010:WorkflowViewState.IdRef="CopyFile_30" Overwrite="True" Path="[Path_Template + &quot;CCI MONTHLY REPORT\IMPORT DATA\REDYE_TEMPLATE.xls&quot;]">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:CopyFile>
                  <ui:ExcelApplicationScope Password="{x:Null}" AutoSave="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="434,428" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_152" InstanceCachePeriod="3000" Workbook="[wbCMC]" WorkbookPath="[Path_Template + &quot;CCI MONTHLY REPORT\IMPORT DATA\REDYE.xls&quot;]">
                    <ui:ExcelApplicationScope.Body>
                      <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,319" sap2010:WorkflowViewState.IdRef="Sequence_1000">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Sequence DisplayName="REDYE_CAUSE" sap:VirtualizedContainerService.HintSize="334,66" sap2010:WorkflowViewState.IdRef="Sequence_999">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Assign sap:VirtualizedContainerService.HintSize="334,64" sap2010:WorkflowViewState.IdRef="Assign_1074">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:String" xml:space="preserve">SELECT 
PRODNO,WND_MCNM,DYE_MCNM,RDYC,ROW_NUMBER() OVER (PARTITION BY PRODNO ORDER BY WND_MCNM DESC) STT
FROM POPDYE.V_MNG_ALYS_DYE V
WHERE --RDYC IS NOT NULL AND 
EXTRACT(YEAR FROM CMPD) = ((1))
AND EXTRACT(month FROM CMPD) = ((2))
AND TO_CHAR(CMPD,'YYYY/MM/DD') &lt;&gt; '((3))'
--AND PRODNO In ('PR09183941','PR09183991','PR09292661','PR09334351','PR09334391','PR09334421','PR09334481','PR09334491','PR09334511','PR09399961','PR09430981','PR09440951','PR09445131','PR09445171','PR09445181','PR09445211','PR09569511','PR09602981','PR09739901','PR09740001','PR09779191','PR09861841','PR09861871','PR09861921','PR10007481','PR10007521')
GROUP BY PRODNO,WND_MCNM,DYE_MCNM,RDYC</InArgument>
                              </Assign.Value>
                            </Assign>
                            <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_1075">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:String">[strSQL.Replace("((1))",stYear).Replace("((2))",stMonth).Replace("((3))",stDate)]</InArgument>
                              </Assign.Value>
                            </Assign>
                            <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" DataTable="[DT_EMPL]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_165" ProviderName="System.Data.Odbc" Sql="[strSQL]" TimeoutMS="90000" ConnectionString="Dsn=POPDYE;uid=POPDYE;pwd=POPDYE">
                              <ui:ExecuteQuery.Parameters>
                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                              </ui:ExecuteQuery.Parameters>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:ExecuteQuery>
                            <ui:ExcelWriteRange AddHeaders="False" DataTable="[DT_EMPL]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_472" SheetName="REDYE" StartingCell="A2" />
                          </Sequence>
                          <ui:ExcelSaveWorkbook DisplayName="Save Workbook" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="ExcelSaveWorkbook_60" />
                          <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_105" Workbook="[wbCMC]" />
                        </Sequence>
                      </ActivityAction>
                    </ui:ExcelApplicationScope.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:ExcelApplicationScope>
                </Sequence>
              </Sequence>
              <FlowStep.Next>
                <FlowStep x:Name="__ReferenceID4">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:Point x:Key="ShapeLocation">460,447</av:Point>
                      <av:Size x:Key="ShapeSize">200,66</av:Size>
                      <av:PointCollection x:Key="ConnectorLocation">560,513 560,546</av:PointCollection>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Sequence DisplayName="Transfer CCI DATA to RPALIB" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_983">
                    <Sequence.Variables>
                      <Variable x:TypeArguments="x:Boolean" Name="warningButton" />
                      <Variable x:TypeArguments="sd:DataTable" Name="dtPhepTon" />
                      <Variable x:TypeArguments="x:String" Name="MSNV_Name_Temp" />
                      <Variable x:TypeArguments="ui:WorkbookApplication" Name="wbPT" />
                    </Sequence.Variables>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:StartProcess Arguments="{x:Null}" WorkingDirectory="{x:Null}" DisplayName="Start process" FileName="[Path_Template + &quot;CCI MONTHLY REPORT\IMPORT DATA\CMCREPORT.dtt&quot;]" sap:VirtualizedContainerService.HintSize="484,87" sap2010:WorkflowViewState.IdRef="StartProcess_3">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:StartProcess>
                    <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" AlterIfDisabled="True" ClickType="CLICK_SINGLE" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="Click_36" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="False">
                      <ui:Click.CursorPosition>
                        <ui:CursorPosition Position="Center">
                          <ui:CursorPosition.OffsetX>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetX>
                          <ui:CursorPosition.OffsetY>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetY>
                        </ui:CursorPosition>
                      </ui:Click.CursorPosition>
                      <ui:Click.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="563e5607-8ae1-4a08-bc83-2270b4c188d1" InformativeScreenshot="1a624fceb7f4d647285404ae65f017c1" Selector="&lt;wnd app='cwbtf.exe' cls='Afx:*' title='Data Transfer to IBM*' /&gt;&lt;wnd ctrlid='1326' title='Transfer data to IBM i' /&gt;" WaitForReady="INTERACTIVE">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                        </ui:Target>
                      </ui:Click.Target>
                    </ui:Click>
                    <ui:UiElementExists DisplayName="Element Exists CWBTF0007" Exists="[warningButton]" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="UiElementExists_5">
                      <ui:UiElementExists.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="7240c0e0-d435-4732-8f13-806a8609c2a0" InformativeScreenshot="13520aafc40c97ac943cb1db3032c293" Selector="&lt;wnd app='cwbtf.exe' cls='#32770' title='IBM i Access Data Transfer' idx='*' /&gt;&lt;wnd ctrlid='1831' title='OK' /&gt;" TimeoutMS="1500">
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:UiElementExists.Target>
                    </ui:UiElementExists>
                    <If Condition="[warningButton]" sap:VirtualizedContainerService.HintSize="484,245" sap2010:WorkflowViewState.IdRef="If_202">
                      <If.Then>
                        <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" AlterIfDisabled="True" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="334,68" sap2010:WorkflowViewState.IdRef="Click_37" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="False">
                          <ui:Click.CursorPosition>
                            <ui:CursorPosition Position="Center">
                              <ui:CursorPosition.OffsetX>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:CursorPosition.OffsetX>
                              <ui:CursorPosition.OffsetY>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:CursorPosition.OffsetY>
                            </ui:CursorPosition>
                          </ui:Click.CursorPosition>
                          <ui:Click.Target>
                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="9cf067fe-abf3-4f7b-90ca-517874dac21b" Selector="&lt;wnd app='cwbtf.exe' cls='#32770' title='IBM i Access Data Transfer' idx='*' /&gt;&lt;wnd ctrlid='1831' title='OK' /&gt;" WaitForReady="INTERACTIVE">
                              <ui:Target.TimeoutMS>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:Target.TimeoutMS>
                            </ui:Target>
                          </ui:Click.Target>
                        </ui:Click>
                      </If.Then>
                    </If>
                    <ui:UiElementExists DisplayName="Element Exists CWBTF0007" Exists="[warningButton]" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="UiElementExists_6">
                      <ui:UiElementExists.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="7240c0e0-d435-4732-8f13-806a8609c2a0" InformativeScreenshot="13520aafc40c97ac943cb1db3032c293" Selector="&lt;wnd app='cwbtf.exe' cls='#32770' title='IBM i Access Data Transfer' idx='*' /&gt;&lt;wnd ctrlid='1831' title='OK' /&gt;" TimeoutMS="1500">
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:UiElementExists.Target>
                    </ui:UiElementExists>
                    <If Condition="[warningButton]" sap:VirtualizedContainerService.HintSize="484,245" sap2010:WorkflowViewState.IdRef="If_203">
                      <If.Then>
                        <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" AlterIfDisabled="True" ClickType="CLICK_SINGLE" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="334,68" sap2010:WorkflowViewState.IdRef="Click_39" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="False">
                          <ui:Click.CursorPosition>
                            <ui:CursorPosition Position="Center">
                              <ui:CursorPosition.OffsetX>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:CursorPosition.OffsetX>
                              <ui:CursorPosition.OffsetY>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:CursorPosition.OffsetY>
                            </ui:CursorPosition>
                          </ui:Click.CursorPosition>
                          <ui:Click.Target>
                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="9cf067fe-abf3-4f7b-90ca-517874dac21b" Selector="&lt;wnd app='cwbtf.exe' cls='#32770' title='IBM i Access Data Transfer' idx='*' /&gt;&lt;wnd ctrlid='1831' title='OK' /&gt;" WaitForReady="INTERACTIVE">
                              <ui:Target.TimeoutMS>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:Target.TimeoutMS>
                            </ui:Target>
                          </ui:Click.Target>
                        </ui:Click>
                      </If.Then>
                    </If>
                    <ui:UiElementExists DisplayName="Element Exists CWBTF0007" Exists="[warningButton]" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="UiElementExists_9">
                      <ui:UiElementExists.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="7240c0e0-d435-4732-8f13-806a8609c2a0" InformativeScreenshot="13520aafc40c97ac943cb1db3032c293" Selector="&lt;wnd app='cwbtf.exe' cls='#32770' title='IBM i Access Data Transfer' idx='*' /&gt;&lt;wnd ctrlid='1831' title='OK' /&gt;" TimeoutMS="7000">
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:UiElementExists.Target>
                    </ui:UiElementExists>
                    <If Condition="[warningButton]" sap:VirtualizedContainerService.HintSize="484,245" sap2010:WorkflowViewState.IdRef="If_206">
                      <If.Then>
                        <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" AlterIfDisabled="True" ClickType="CLICK_SINGLE" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="334,68" sap2010:WorkflowViewState.IdRef="Click_44" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="False">
                          <ui:Click.CursorPosition>
                            <ui:CursorPosition Position="Center">
                              <ui:CursorPosition.OffsetX>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:CursorPosition.OffsetX>
                              <ui:CursorPosition.OffsetY>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:CursorPosition.OffsetY>
                            </ui:CursorPosition>
                          </ui:Click.CursorPosition>
                          <ui:Click.Target>
                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="9cf067fe-abf3-4f7b-90ca-517874dac21b" Selector="&lt;wnd app='cwbtf.exe' cls='#32770' title='IBM i Access Data Transfer' idx='*' /&gt;&lt;wnd ctrlid='1831' title='OK' /&gt;" WaitForReady="INTERACTIVE">
                              <ui:Target.TimeoutMS>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:Target.TimeoutMS>
                            </ui:Target>
                          </ui:Click.Target>
                        </ui:Click>
                      </If.Then>
                    </If>
                    <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" AlterIfDisabled="True" ClickType="CLICK_SINGLE" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="Click_38" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="False">
                      <ui:Click.CursorPosition>
                        <ui:CursorPosition Position="Center">
                          <ui:CursorPosition.OffsetX>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetX>
                          <ui:CursorPosition.OffsetY>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetY>
                        </ui:CursorPosition>
                      </ui:Click.CursorPosition>
                      <ui:Click.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="9cf067fe-abf3-4f7b-90ca-517874dac21b" InformativeScreenshot="2e25c09e50f8490268da491b36f062f3" Selector="&lt;wnd app='cwbtf.exe' cls='#32770' title='Transfer to IBM i Complete' /&gt;&lt;wnd ctrlid='1' title='OK' /&gt;" WaitForReady="INTERACTIVE">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                        </ui:Target>
                      </ui:Click.Target>
                    </ui:Click>
                    <ui:KillProcess ContinueOnError="{x:Null}" Process="{x:Null}" DisplayName="Kill process" sap:VirtualizedContainerService.HintSize="484,132" sap2010:WorkflowViewState.IdRef="KillProcess_2" ProcessName="cwbtf" />
                  </Sequence>
                  <FlowStep.Next>
                    <FlowStep x:Name="__ReferenceID7">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">460,546</av:Point>
                          <av:Size x:Key="ShapeSize">200,66</av:Size>
                          <av:PointCollection x:Key="ConnectorLocation">560,612 560,657</av:PointCollection>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Sequence DisplayName="Transfer REDYE DATA to RPALIB" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_998">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="x:Boolean" Name="warningButton" />
                          <Variable x:TypeArguments="sd:DataTable" Name="dtPhepTon" />
                          <Variable x:TypeArguments="x:String" Name="MSNV_Name_Temp" />
                          <Variable x:TypeArguments="ui:WorkbookApplication" Name="wbPT" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:StartProcess Arguments="{x:Null}" WorkingDirectory="{x:Null}" DisplayName="Start process" FileName="[Path_Template + &quot;CCI MONTHLY REPORT\IMPORT DATA\REDYE.dtt&quot;]" sap:VirtualizedContainerService.HintSize="484,87" sap2010:WorkflowViewState.IdRef="StartProcess_4">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:StartProcess>
                        <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" AlterIfDisabled="True" ClickType="CLICK_SINGLE" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="Click_40" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="False">
                          <ui:Click.CursorPosition>
                            <ui:CursorPosition Position="Center">
                              <ui:CursorPosition.OffsetX>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:CursorPosition.OffsetX>
                              <ui:CursorPosition.OffsetY>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:CursorPosition.OffsetY>
                            </ui:CursorPosition>
                          </ui:Click.CursorPosition>
                          <ui:Click.Target>
                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="563e5607-8ae1-4a08-bc83-2270b4c188d1" InformativeScreenshot="1a624fceb7f4d647285404ae65f017c1" Selector="&lt;wnd app='cwbtf.exe' cls='Afx:*' title='Data Transfer to IBM*' /&gt;&lt;wnd ctrlid='1326' title='Transfer data to IBM i' /&gt;" WaitForReady="INTERACTIVE">
                              <ui:Target.TimeoutMS>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:Target.TimeoutMS>
                            </ui:Target>
                          </ui:Click.Target>
                        </ui:Click>
                        <ui:UiElementExists DisplayName="Element Exists CWBTF0007" Exists="[warningButton]" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="UiElementExists_7">
                          <ui:UiElementExists.Target>
                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="7240c0e0-d435-4732-8f13-806a8609c2a0" InformativeScreenshot="13520aafc40c97ac943cb1db3032c293" Selector="&lt;wnd app='cwbtf.exe' cls='#32770' title='IBM i Access Data Transfer' idx='*' /&gt;&lt;wnd ctrlid='1831' title='OK' /&gt;" TimeoutMS="1500">
                              <ui:Target.WaitForReady>
                                <InArgument x:TypeArguments="ui:WaitForReady" />
                              </ui:Target.WaitForReady>
                            </ui:Target>
                          </ui:UiElementExists.Target>
                        </ui:UiElementExists>
                        <If Condition="[warningButton]" sap:VirtualizedContainerService.HintSize="484,245" sap2010:WorkflowViewState.IdRef="If_204">
                          <If.Then>
                            <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" AlterIfDisabled="True" ClickType="CLICK_SINGLE" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="334,68" sap2010:WorkflowViewState.IdRef="Click_41" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="False">
                              <ui:Click.CursorPosition>
                                <ui:CursorPosition Position="Center">
                                  <ui:CursorPosition.OffsetX>
                                    <InArgument x:TypeArguments="x:Int32" />
                                  </ui:CursorPosition.OffsetX>
                                  <ui:CursorPosition.OffsetY>
                                    <InArgument x:TypeArguments="x:Int32" />
                                  </ui:CursorPosition.OffsetY>
                                </ui:CursorPosition>
                              </ui:Click.CursorPosition>
                              <ui:Click.Target>
                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="9cf067fe-abf3-4f7b-90ca-517874dac21b" Selector="&lt;wnd app='cwbtf.exe' cls='#32770' title='IBM i Access Data Transfer' idx='*' /&gt;&lt;wnd ctrlid='1831' title='OK' /&gt;" WaitForReady="INTERACTIVE">
                                  <ui:Target.TimeoutMS>
                                    <InArgument x:TypeArguments="x:Int32" />
                                  </ui:Target.TimeoutMS>
                                </ui:Target>
                              </ui:Click.Target>
                            </ui:Click>
                          </If.Then>
                        </If>
                        <ui:UiElementExists DisplayName="Element Exists CWBTF0007" Exists="[warningButton]" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="UiElementExists_8">
                          <ui:UiElementExists.Target>
                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="7240c0e0-d435-4732-8f13-806a8609c2a0" InformativeScreenshot="13520aafc40c97ac943cb1db3032c293" Selector="&lt;wnd app='cwbtf.exe' cls='#32770' title='IBM i Access Data Transfer' idx='*' /&gt;&lt;wnd ctrlid='1831' title='OK' /&gt;" TimeoutMS="1500">
                              <ui:Target.WaitForReady>
                                <InArgument x:TypeArguments="ui:WaitForReady" />
                              </ui:Target.WaitForReady>
                            </ui:Target>
                          </ui:UiElementExists.Target>
                        </ui:UiElementExists>
                        <If Condition="[warningButton]" sap:VirtualizedContainerService.HintSize="484,245" sap2010:WorkflowViewState.IdRef="If_205">
                          <If.Then>
                            <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" AlterIfDisabled="True" ClickType="CLICK_SINGLE" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="334,68" sap2010:WorkflowViewState.IdRef="Click_42" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="False">
                              <ui:Click.CursorPosition>
                                <ui:CursorPosition Position="Center">
                                  <ui:CursorPosition.OffsetX>
                                    <InArgument x:TypeArguments="x:Int32" />
                                  </ui:CursorPosition.OffsetX>
                                  <ui:CursorPosition.OffsetY>
                                    <InArgument x:TypeArguments="x:Int32" />
                                  </ui:CursorPosition.OffsetY>
                                </ui:CursorPosition>
                              </ui:Click.CursorPosition>
                              <ui:Click.Target>
                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="9cf067fe-abf3-4f7b-90ca-517874dac21b" Selector="&lt;wnd app='cwbtf.exe' cls='#32770' title='IBM i Access Data Transfer' idx='*' /&gt;&lt;wnd ctrlid='1831' title='OK' /&gt;" WaitForReady="INTERACTIVE">
                                  <ui:Target.TimeoutMS>
                                    <InArgument x:TypeArguments="x:Int32" />
                                  </ui:Target.TimeoutMS>
                                </ui:Target>
                              </ui:Click.Target>
                            </ui:Click>
                          </If.Then>
                        </If>
                        <ui:UiElementExists DisplayName="Element Exists CWBTF0007" Exists="[warningButton]" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="UiElementExists_10">
                          <ui:UiElementExists.Target>
                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="7240c0e0-d435-4732-8f13-806a8609c2a0" InformativeScreenshot="13520aafc40c97ac943cb1db3032c293" Selector="&lt;wnd app='cwbtf.exe' cls='#32770' title='IBM i Access Data Transfer' idx='*' /&gt;&lt;wnd ctrlid='1831' title='OK' /&gt;" TimeoutMS="7000">
                              <ui:Target.WaitForReady>
                                <InArgument x:TypeArguments="ui:WaitForReady" />
                              </ui:Target.WaitForReady>
                            </ui:Target>
                          </ui:UiElementExists.Target>
                        </ui:UiElementExists>
                        <If Condition="[warningButton]" sap:VirtualizedContainerService.HintSize="484,245" sap2010:WorkflowViewState.IdRef="If_207">
                          <If.Then>
                            <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" AlterIfDisabled="True" ClickType="CLICK_SINGLE" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="334,68" sap2010:WorkflowViewState.IdRef="Click_45" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="False">
                              <ui:Click.CursorPosition>
                                <ui:CursorPosition Position="Center">
                                  <ui:CursorPosition.OffsetX>
                                    <InArgument x:TypeArguments="x:Int32" />
                                  </ui:CursorPosition.OffsetX>
                                  <ui:CursorPosition.OffsetY>
                                    <InArgument x:TypeArguments="x:Int32" />
                                  </ui:CursorPosition.OffsetY>
                                </ui:CursorPosition>
                              </ui:Click.CursorPosition>
                              <ui:Click.Target>
                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="9cf067fe-abf3-4f7b-90ca-517874dac21b" Selector="&lt;wnd app='cwbtf.exe' cls='#32770' title='IBM i Access Data Transfer' idx='*' /&gt;&lt;wnd ctrlid='1831' title='OK' /&gt;" WaitForReady="INTERACTIVE">
                                  <ui:Target.TimeoutMS>
                                    <InArgument x:TypeArguments="x:Int32" />
                                  </ui:Target.TimeoutMS>
                                </ui:Target>
                              </ui:Click.Target>
                            </ui:Click>
                          </If.Then>
                        </If>
                        <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" AlterIfDisabled="True" ClickType="CLICK_SINGLE" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="Click_43" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="False">
                          <ui:Click.CursorPosition>
                            <ui:CursorPosition Position="Center">
                              <ui:CursorPosition.OffsetX>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:CursorPosition.OffsetX>
                              <ui:CursorPosition.OffsetY>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:CursorPosition.OffsetY>
                            </ui:CursorPosition>
                          </ui:Click.CursorPosition>
                          <ui:Click.Target>
                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="9cf067fe-abf3-4f7b-90ca-517874dac21b" InformativeScreenshot="2e25c09e50f8490268da491b36f062f3" Selector="&lt;wnd app='cwbtf.exe' cls='#32770' title='Transfer to IBM i Complete' /&gt;&lt;wnd ctrlid='1' title='OK' /&gt;" WaitForReady="INTERACTIVE">
                              <ui:Target.TimeoutMS>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:Target.TimeoutMS>
                            </ui:Target>
                          </ui:Click.Target>
                        </ui:Click>
                        <ui:KillProcess ContinueOnError="{x:Null}" Process="{x:Null}" DisplayName="Kill process" sap:VirtualizedContainerService.HintSize="484,132" sap2010:WorkflowViewState.IdRef="KillProcess_3" ProcessName="cwbtf" />
                      </Sequence>
                      <FlowStep.Next>
                        <FlowStep x:Name="__ReferenceID5">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">460,657</av:Point>
                              <av:Size x:Key="ShapeSize">200,66</av:Size>
                              <av:PointCollection x:Key="ConnectorLocation">560,723 560,777</av:PointCollection>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Sequence DisplayName="DATA FINAL" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_987">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Final]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="452,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_161" ProviderName="System.Data.Odbc" Sql="SELECT DATE, &#xA;to_date(LEFT(PSDUAB,4)||'/'||SUBSTRING(PSDUAB,5,2)||'/'||SUBSTRING(PSDUAB,7,2)||' '||&#xA;LEFT(LEFT('000000000',6-LENGTH(TRIM(SSTTAB))) || TRIM(SSTTAB),2)||':'||&#xA;SUBSTRING(LEFT('000000000',6-LENGTH(TRIM(SSTTAB))) || TRIM(SSTTAB),3,2)||':'||&#xA;SUBSTRING(LEFT('000000000',6-LENGTH(TRIM(SSTTAB))) || TRIM(SSTTAB),5,2),'YYYY/MM/DD HH24:MI:SS') STARTDYE, &#xA;DENPNO, PR_WINGS, TRIM(EMPCAB) EMPCAB, '' ENAME,MCNM3&#xA;,CASE WHEN R2.WND_MCNM IS NULL THEN TRIM(R1.WND_MCNM)&#xA;ELSE TRIM(R1.WND_MCNM)||'/'||TRIM(R2.WND_MCNM) END WIND_NO&#xA;--,R1.WND_MCNM,R2.WND_MCNM&#xA;,R1.DYE_MCNM&#xA;,RECIPE, COMM2, ITEM, TCC, COL&#xA;,DYESTUFF1,DYESTUFF2,DYESTUFF3,DYESTUFF4&#xA;&#xA;,LEN, CLEN, DLEN, KND, PROCS, STP, PRG, TIMES, RESULT&#xA;,'' REDYE_CAUSE&#xA;,CASE WHEN DL1 = 0 THEN NULL ELSE DL1 END DL1&#xA;,CASE WHEN DA1 = 0 THEN NULL ELSE DA1 END Da1&#xA;,CASE WHEN DB1 = 0 THEN NULL ELSE DB1 END Db1&#x9;&#xA;,CASE WHEN DC1 = 0 THEN NULL ELSE DC1 END DC1&#x9;&#xA;,CASE WHEN DH1 = 0 THEN NULL ELSE DH1 END DH1&#x9;&#xA;,CASE WHEN CMC1 = 0 THEN NULL ELSE CMC1 END CMC1&#x9;&#xA;,DL,DA,DB,DC,DH,CMC,NEWCOL,CASE WHEN R1.RDYC &lt;&gt; '' THEN ''''||TRIM(R1.RDYC) ELSE ''END RDYC&#xA;FROM RPALIB.CMCREPORT&#xA;LEFT JOIN WAVEDLIB.FAB00 ON PR_WINGS = PSHNAB AND PPTNAB='DYE' AND PSDUAB &gt; 0&#xA;LEFT JOIN RPALIB.REDYE R1 ON PR_WINGS = R1.PRODNO AND R1.STT=1&#xA;LEFT JOIN RPALIB.REDYE R2 ON PR_WINGS = R2.PRODNO AND R2.STT=2&#xA;" ConnectionString="Driver={ISeries Access ODBC Driver};system=10.246.194.1;library=WAVEDLIB;querytimeout=0;uid=VNPRT;pwd=VNPRT">
                              <ui:ExecuteQuery.Parameters>
                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                              </ui:ExecuteQuery.Parameters>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:ExecuteQuery>
                            <ui:ExcelApplicationScope Password="{x:Null}" AutoSave="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="452,1112" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_150" InstanceCachePeriod="3000" Workbook="[wbCMC]" WorkbookPath="[Path_Template + &quot;CCI MONTHLY REPORT\Monthly_Data.xlsx&quot;]">
                              <ui:ExcelApplicationScope.Body>
                                <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                  </ActivityAction.Argument>
                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="418,1003" sap2010:WorkflowViewState.IdRef="Sequence_986">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="376,51" sap2010:WorkflowViewState.IdRef="CommentOut_252">
                                      <ui:CommentOut.Body>
                                        <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="418,264" sap2010:WorkflowViewState.IdRef="Sequence_1005">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Sequence DisplayName="Employee" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_984">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[DT_EMPL]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_162" ProviderName="System.Data.Odbc" Sql="SELECT TRIM(EMPC) EMPC,UIDC,FEMI&#xA;FROM POPDYE.MST_EMPL" ConnectionString="Dsn=POPDYE;uid=POPDYE;pwd=POPDYE">
                                              <ui:ExecuteQuery.Parameters>
                                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                              </ui:ExecuteQuery.Parameters>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:ExecuteQuery>
                                            <ui:ExcelWriteRange AddHeaders="False" DataTable="[DT_EMPL]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_466" SheetName="Employee" StartingCell="A2" />
                                          </Sequence>
                                          <Sequence DisplayName="REDYE_CAUSE" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_997">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[DT_EMPL]" DisplayName="Execute Query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_164" ProviderName="System.Data.Odbc" Sql="SELECT REDYRESCD,REDYRES_1&#xA;FROM POPDYE.V_F_REDYRES" ConnectionString="Dsn=POPDYE;uid=POPDYE;pwd=POPDYE">
                                              <ui:ExecuteQuery.Parameters>
                                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                              </ui:ExecuteQuery.Parameters>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:ExecuteQuery>
                                            <ui:ExcelWriteRange AddHeaders="False" DataTable="[DT_EMPL]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_471" SheetName="REDYRES1" StartingCell="A2" />
                                          </Sequence>
                                        </Sequence>
                                      </ui:CommentOut.Body>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:CommentOut>
                                    <Sequence DisplayName="Get data" sap:VirtualizedContainerService.HintSize="376,433" sap2010:WorkflowViewState.IdRef="Sequence_985">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:ExcelWriteRange AddHeaders="False" DataTable="[dt_Final]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_467" SheetName="Final" StartingCell="A2" />
                                      <ui:ExcelWriteCell Cell="F2" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_2" SheetName="Final" Text="[&quot;=IF([@EMPCAB]&lt;&gt;&quot;&quot;&quot;&quot;,INDEX(Employee!C:C,MATCH([@EMPCAB],Employee!A:A,0)),&quot;&quot;&quot;&quot;)&quot;]" />
                                      <ui:ExcelWriteCell Cell="AB2" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_3" SheetName="Final" Text="[&quot;=IF([RYDC]&lt;&gt;&quot;&quot;&quot;&quot;,INDEX(REDYE[REDYE_NAME],MATCH([RYDC],REDYE[REDYE_CODE],0)),&quot;&quot;&quot;&quot;)&quot;]" />
                                    </Sequence>
                                    <ui:ExcelReadRange AddHeaders="True" DataTable="[dt_Final]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="376,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_224" SheetName="Final">
                                      <ui:ExcelReadRange.Range>
                                        <InArgument x:TypeArguments="x:String">
                                          <Literal x:TypeArguments="x:String" Value="" />
                                        </InArgument>
                                      </ui:ExcelReadRange.Range>
                                    </ui:ExcelReadRange>
                                    <ui:ExcelWriteRange AddHeaders="False" DataTable="[dt_Final]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="376,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_468" SheetName="OK" StartingCell="A2" />
                                    <ui:ExcelSaveWorkbook DisplayName="Save Workbook" sap:VirtualizedContainerService.HintSize="376,22" sap2010:WorkflowViewState.IdRef="ExcelSaveWorkbook_58" />
                                    <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="376,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_103" Workbook="[wbCMC]" />
                                  </Sequence>
                                </ActivityAction>
                              </ui:ExcelApplicationScope.Body>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:ExcelApplicationScope>
                          </Sequence>
                          <FlowStep.Next>
                            <FlowStep x:Name="__ReferenceID6">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <av:Point x:Key="ShapeLocation">460,777</av:Point>
                                  <av:Size x:Key="ShapeSize">200,66</av:Size>
                                  <av:PointCollection x:Key="ConnectorLocation">560,843 560,873 560.141666666667,873 560.141666666667,876.5</av:PointCollection>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Sequence DisplayName="Report Final File" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_996">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:CopyFile ContinueOnError="{x:Null}" Destination="[Path_Template + &quot;CCI MONTHLY REPORT\Monthly_&quot;+DateTime.Now.ToString(&quot;yyyy_M_d&quot;)+&quot; (1 shot update to &quot;+stMonth+&quot;_&quot;+stDate1+&quot;).xlsx&quot;]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="434,157" sap2010:WorkflowViewState.IdRef="CopyFile_28" Overwrite="True" Path="[Path_Template + &quot;CCI MONTHLY REPORT\NEW TEMPLATE\Monthly_yyyy_m_d (1 shot update to m_d1)_Template (ver4).xlsx&quot;]">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:CopyFile>
                                <ui:FilterDataTable DataTable="[dt_Final]" DisplayName="Filter Data Table" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="434,59" sap2010:WorkflowViewState.IdRef="FilterDataTable_227" OutputDataTable="[dt_Final]" SelectColumnsMode="Remove">
                                  <ui:FilterDataTable.Filters>
                                    <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                      <ui:FilterOperationArgument Column="{x:Null}" Operand="{x:Null}" BooleanOperator="And" Operator="LT" />
                                    </scg:List>
                                  </ui:FilterDataTable.Filters>
                                  <ui:FilterDataTable.SelectColumns>
                                    <scg:List x:TypeArguments="InArgument" Capacity="4">
                                      <InArgument x:TypeArguments="x:Int32">[dt_Final.Columns.Count - 1]</InArgument>
                                    </scg:List>
                                  </ui:FilterDataTable.SelectColumns>
                                </ui:FilterDataTable>
                                <ui:ExcelApplicationScope Password="{x:Null}" AutoSave="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="434,949" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_151" InstanceCachePeriod="3000" Workbook="[wbCMC]" WorkbookPath="[Path_Template + &quot;CCI MONTHLY REPORT\Monthly_&quot;+DateTime.Now.ToString(&quot;yyyy_M_d&quot;)+&quot; (1 shot update to &quot;+stMonth+&quot;_&quot;+stDate1+&quot;).xlsx&quot;]">
                                  <ui:ExcelApplicationScope.Body>
                                    <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                      <ActivityAction.Argument>
                                        <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                      </ActivityAction.Argument>
                                      <Sequence sap:VirtualizedContainerService.HintSize="376,840" sap2010:WorkflowViewState.IdRef="Sequence_993">
                                        <Sequence.Variables>
                                          <Variable x:TypeArguments="x:String" Name="stLastRow" />
                                          <Variable x:TypeArguments="sd:DataTable" Name="dt_Image" />
                                        </Sequence.Variables>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:ExcelWriteRange AddHeaders="False" DataTable="[dt_Final]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_469" SheetName="ExportData" StartingCell="A3" />
                                        <ui:ExcelReadCell Result="{x:Null}" Cell="A4" DisplayName="Read Cell" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadCell_3" SheetName="1-Shot% by Line" />
                                        <ui:InvokeVBA OutputValue="{x:Null}" CodeFilePath="VBA.txt" DisplayName="Invoke VBA" EntryMethodName="WorkbookRefreshAll" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeVBA_41" />
                                        <Delay Duration="00:00:03" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Delay_19" />
                                        <Sequence sap:VirtualizedContainerService.HintSize="334,66" sap2010:WorkflowViewState.IdRef="Sequence_990">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ee:MoveVerticalActivity MoveColumn="{x:Null}" MoveCount="{x:Null}" BaseCell="R8" ClipboardCopyFlg="False" CurrentCell="[stLastRow]" DisplayName="Move vertical activity" sap:VirtualizedContainerService.HintSize="340,144" sap2010:WorkflowViewState.IdRef="MoveVerticalActivity_122" MoveDirection="Down" MoveLastDataRowFlg="True" MoveNextFlg="False" SheetName="1-Shot% by Line" WorkBook="[wbCMC]" />
                                          <ui:ExcelReadRange AddHeaders="True" DataTable="[dt_Image]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="340,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_225" Range="[&quot;A8:&quot;+stLastRow.Replace(&quot;R&quot;,&quot;P&quot;)]" SheetName="1-Shot% by Line" />
                                          <ui:ExcelWriteRange AddHeaders="True" DataTable="[dt_Image]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="340,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_470" SheetName="Sheet1" StartingCell="B2" />
                                          <ui:InvokeVBA OutputValue="{x:Null}" CodeFilePath="VBA.TXT" DisplayName="Invoke VBA" EntryMethodName="drawBorderAndLineForCCI" EntryMethodParameters="[{&quot;Sheet1&quot;, &quot;B2:Q&quot;+(dt_Image.Rows.Count + 2).ToString}]" sap:VirtualizedContainerService.HintSize="340,87" sap2010:WorkflowViewState.IdRef="InvokeVBA_42" />
                                          <ui:ExcelSetRangeColor Color="[System.Drawing.Color.LightSkyBlue]" DisplayName="Set Range Color" sap:VirtualizedContainerService.HintSize="340,188" sap2010:WorkflowViewState.IdRef="ExcelSetRangeColor_35" Range="[&quot;B&quot;+(dt_Image.Rows.Count+1).ToString+&quot;:&quot;+&quot;Q&quot;+(dt_Image.Rows.Count+1).ToString]" SheetName="Sheet1" />
                                          <ui:ExcelSetRangeColor Color="[System.Drawing.Color.Cornsilk]" DisplayName="Set Range Color" sap:VirtualizedContainerService.HintSize="340,188" sap2010:WorkflowViewState.IdRef="ExcelSetRangeColor_36" Range="[&quot;B&quot;+(dt_Image.Rows.Count+2).ToString+&quot;:&quot;+&quot;Q&quot;+(dt_Image.Rows.Count+2).ToString]" SheetName="Sheet1" />
                                        </Sequence>
                                        <Sequence DisplayName="Range to Picture" sap:VirtualizedContainerService.HintSize="334,66" sap2010:WorkflowViewState.IdRef="Sequence_992">
                                          <Sequence.Variables>
                                            <Variable x:TypeArguments="sd1:Image" Name="Image" />
                                            <Variable x:TypeArguments="swf:Clipboard" Name="clipboard" />
                                            <Variable x:TypeArguments="x:Boolean" Name="run_Again" />
                                            <Variable x:TypeArguments="x:String" Name="fileName" />
                                          </Sequence.Variables>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Assign sap:VirtualizedContainerService.HintSize="480,60" sap2010:WorkflowViewState.IdRef="Assign_1059">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[fileName]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">Monthly</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <ui:InvokeVBA OutputValue="{x:Null}" CodeFilePath="VBA.txt" DisplayName="Invoke VBA" EntryMethodName="DisableAlert" sap:VirtualizedContainerService.HintSize="480,87" sap2010:WorkflowViewState.IdRef="InvokeVBA_43" />
                                          <ui:ExcelSelectRange DisplayName="Select Range" sap:VirtualizedContainerService.HintSize="480,59" sap2010:WorkflowViewState.IdRef="ExcelSelectRange_3" Range="[&quot;A1:Q&quot;+(dt_Image.Rows.Count + 2).ToString]" SheetName="Sheet1" />
                                          <ui:SendHotkey ClickBeforeTyping="{x:Null}" DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" EmptyField="{x:Null}" SendWindowMessages="{x:Null}" SpecialKey="{x:Null}" Activate="True" DisplayName="Send Hotkey 'Grid'" sap:VirtualizedContainerService.HintSize="480,116" sap2010:WorkflowViewState.IdRef="SendHotkey_15" Key="c" KeyModifiers="Ctrl">
                                            <ui:SendHotkey.Target>
                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="8b7fea77-e2b5-43fb-bdc2-335e69e530cf" Selector="&lt;wnd app='excel.exe' cls='XLMAIN' title='*{{fileName}}*' /&gt;&lt;uia cls='EXCEL*' name='*{{fileName}}*' /&gt;&lt;uia name='Grid' /&gt;">
                                                <ui:Target.TimeoutMS>
                                                  <InArgument x:TypeArguments="x:Int32" />
                                                </ui:Target.TimeoutMS>
                                                <ui:Target.WaitForReady>
                                                  <InArgument x:TypeArguments="ui:WaitForReady" />
                                                </ui:Target.WaitForReady>
                                              </ui:Target>
                                            </ui:SendHotkey.Target>
                                          </ui:SendHotkey>
                                          <ui:RetryScope DisplayName="Retry Scope" sap:VirtualizedContainerService.HintSize="480,1123" sap2010:WorkflowViewState.IdRef="RetryScope_5" NumberOfRetries="3" RetryInterval="00:00:01">
                                            <ui:RetryScope.ActivityBody>
                                              <ActivityAction>
                                                <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="438,885" sap2010:WorkflowViewState.IdRef="TryCatch_3">
                                                  <TryCatch.Try>
                                                    <Sequence sap:VirtualizedContainerService.HintSize="376,446" sap2010:WorkflowViewState.IdRef="Sequence_991">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Delay Duration="00:00:01" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Delay_20" />
                                                      <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_1060">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="sd1:Image">[Image]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="sd1:Image">[System.Windows.Forms.Clipboard.GetImage]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <ui:SaveImage DisplayName="Save image____1" FileName="[&quot;H:\Robotics\CCI REPORT\CCI_&quot;+DateTime.Now.ToString(&quot;yyyyMMdd&quot;)+&quot;.jpg&quot;]" sap:VirtualizedContainerService.HintSize="334,92" sap2010:WorkflowViewState.IdRef="SaveImage_3" Image="[Image]">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:SaveImage>
                                                      <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_1061">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Boolean">[run_Again]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                    </Sequence>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,129" sap2010:WorkflowViewState.IdRef="Catch`1_3">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                        <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1062">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:Boolean">[run_Again]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                              </ActivityAction>
                                            </ui:RetryScope.ActivityBody>
                                            <ui:RetryScope.Condition>
                                              <ActivityFunc x:TypeArguments="x:Boolean">
                                                <p:IsFalse DisplayName="Is false" sap:VirtualizedContainerService.HintSize="284,79" sap2010:WorkflowViewState.IdRef="IsFalse_2" Input="[run_Again]" />
                                              </ActivityFunc>
                                            </ui:RetryScope.Condition>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:RetryScope>
                                        </Sequence>
                                        <ui:ExcelSelectRange DisplayName="Select Range" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelSelectRange_4" Range="A8" SheetName="1-Shot% by Line" />
                                        <ui:ExcelSaveWorkbook DisplayName="Save Workbook" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="ExcelSaveWorkbook_59" />
                                      </Sequence>
                                    </ActivityAction>
                                  </ui:ExcelApplicationScope.Body>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:ExcelApplicationScope>
                                <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="434,51" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_104" Workbook="[wbCMC]">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:ExcelCloseWorkbook>
                                <Sequence DisplayName="Set HTML" sap:VirtualizedContainerService.HintSize="434,66" sap2010:WorkflowViewState.IdRef="Sequence_995">
                                  <Sequence.Variables>
                                    <Variable x:TypeArguments="x:String" Name="stImagePath" />
                                    <Variable x:TypeArguments="x:String" Name="mailTextHTML" />
                                  </Sequence.Variables>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Assign sap:VirtualizedContainerService.HintSize="384,60" sap2010:WorkflowViewState.IdRef="Assign_1063">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[stImagePath]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">["H:\Robotics\CCI REPORT\CCI_"+DateTime.Now.ToString("yyyyMMdd")+".jpg"]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <ui:ReadTextFile Content="[mailTextHTML]" DisplayName="Read text file (HTML Mail Body)" FileName="H:\Robotics\CCI REPORT\Report_Mail.html" sap:VirtualizedContainerService.HintSize="384,79" sap2010:WorkflowViewState.IdRef="ReadTextFile_5">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:ReadTextFile>
                                  <Sequence DisplayName="Image JP" sap:VirtualizedContainerService.HintSize="384,356" sap2010:WorkflowViewState.IdRef="Sequence_994">
                                    <Sequence.Variables>
                                      <Variable x:TypeArguments="x:String" Name="image_base64" />
                                    </Sequence.Variables>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1064">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[image_base64]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">[Convert.ToBase64String(System.IO.File.ReadAllBytes(stImagePath))]</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1065">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[image_base64]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">["data:image/jpeg;base64,"+ image_base64]</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,64" sap2010:WorkflowViewState.IdRef="Assign_1066">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[mailTextHTML]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String" xml:space="preserve">[mailTextHTML.ToString.
Replace("(1)",stMonth).
Replace("(2)",stDate1).
Replace("(3)",image_base64)]</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                  </Sequence>
                                  <ui:WriteTextFile DisplayName="Write Text File" FileName="[&quot;H:\Robotics\CCI REPORT\&quot;+DateTime.Now.ToString(&quot;yyyyMMdd&quot;)+&quot;_report.html&quot;]" sap:VirtualizedContainerService.HintSize="384,132" sap2010:WorkflowViewState.IdRef="WriteTextFile_3" Text="[mailTextHTML]" />
                                </Sequence>
                                <ui:CopyFile ContinueOnError="{x:Null}" Destination="[&quot;\\ykkvnm.com\vnmfs\YKKDATA\DEPARTMENT\PRODUCTION\Dyeing\0. DYE REPORT\1-Shot Daily\ROBOTICS_Report\Monthly_&quot;+DateTime.Now.ToString(&quot;yyyy_M_d&quot;)+&quot; (1 shot update to &quot;+stMonth+&quot;_&quot;+stDate1+&quot;).xlsx&quot;]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="434,157" sap2010:WorkflowViewState.IdRef="CopyFile_29" Overwrite="True" Path="[Path_Template + &quot;CCI MONTHLY REPORT\Monthly_&quot;+DateTime.Now.ToString(&quot;yyyy_M_d&quot;)+&quot; (1 shot update to &quot;+stMonth+&quot;_&quot;+stDate1+&quot;).xlsx&quot;]">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:CopyFile>
                              </Sequence>
                              <FlowStep.Next>
                                <FlowDecision x:Name="__ReferenceID8" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_1">
                                  <FlowDecision.Condition>
                                    <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="arrDate.Count = 0" />
                                  </FlowDecision.Condition>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      <av:Point x:Key="ShapeLocation">520.641666666667,876.5</av:Point>
                                      <av:Size x:Key="ShapeSize">79,87</av:Size>
                                      <av:PointCollection x:Key="TrueConnector">520.641666666667,920 320,920</av:PointCollection>
                                      <av:PointCollection x:Key="FalseConnector">599.641666666667,920 620,920 620,987 560,987 560,1017</av:PointCollection>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <FlowDecision.True>
                                    <FlowStep x:Name="__ReferenceID2">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">120,887</av:Point>
                                          <av:Size x:Key="ShapeSize">200,66</av:Size>
                                          <av:PointCollection x:Key="ConnectorLocation">220,953 220,983 560,983 560,1017</av:PointCollection>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Sequence DisplayName="Send Mail Function" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_848">
                                        <Sequence.Variables>
                                          <Variable x:TypeArguments="s:String[]" Name="stTo" />
                                          <Variable x:TypeArguments="s:String[]" Name="stCC" />
                                          <Variable x:TypeArguments="s:String[]" Name="stBCC" />
                                          <Variable x:TypeArguments="x:String" Name="stSubject" />
                                          <Variable x:TypeArguments="s:String[]" Name="stAttColection" />
                                          <Variable x:TypeArguments="sd:DataTable" Name="dtMail" />
                                          <Variable x:TypeArguments="x:String" Name="robotName" />
                                          <Variable x:TypeArguments="sd:DataTable" Name="dt_Address" />
                                          <Variable x:TypeArguments="sd:DataTable" Name="dt_Server" />
                                          <Variable x:TypeArguments="x:String" Name="Mail_Email" />
                                          <Variable x:TypeArguments="x:String" Name="Mail_Password" />
                                          <Variable x:TypeArguments="x:String" Name="Mail_Server" />
                                          <Variable x:TypeArguments="x:String" Name="stBody" />
                                        </Sequence.Variables>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:ReadTextFile Content="[stBody]" DisplayName="Read Text File" FileName="[&quot;H:\Robotics\CCI REPORT\&quot;+DateTime.Now.ToString(&quot;yyyyMMdd&quot;)+&quot;_report.html&quot;]" sap:VirtualizedContainerService.HintSize="384,79" sap2010:WorkflowViewState.IdRef="ReadTextFile_3" />
                                        <Switch x:TypeArguments="x:String" DisplayName="Switch" Expression="[Datetime.ParseExact(stMonth+&quot;/&quot;+stDate1+&quot;/&quot;+stYear,&quot;MM/dd/yyyy&quot;,System.Globalization.CultureInfo.InvariantCulture).DayOfWeek.ToString]" sap:VirtualizedContainerService.HintSize="384,51" sap2010:WorkflowViewState.IdRef="Switch`1_4">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Assign x:Key="Monday" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1067">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[D]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">月</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign x:Key="Tuesday" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1068">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[D]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">火</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign x:Key="Wednesday" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1069">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[D]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">水</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign x:Key="Thursday" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1070">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[D]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">木</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign x:Key="Friday" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1071">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[D]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">金</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign x:Key="Saturday" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1072">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[D]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">土</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <Assign x:Key="Sunday" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1073">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[D]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">日</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </Switch>
                                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="384,98" sap2010:WorkflowViewState.IdRef="MultipleAssign_85">
                                          <ui:MultipleAssign.AssignOperations>
                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_285">
                                                <ui:AssignOperation.To>
                                                  <OutArgument x:TypeArguments="x:String">[stSubject]</OutArgument>
                                                </ui:AssignOperation.To>
                                                <ui:AssignOperation.Value>
                                                  <InArgument x:TypeArguments="x:String">[Int32.Parse(stMonth).ToString+ "/" +Int32.Parse(stDate1).ToString+"("+D+")"+"一発率まとめ"]</InArgument>
                                                </ui:AssignOperation.Value>
                                              </ui:AssignOperation>
                                            </scg:List>
                                          </ui:MultipleAssign.AssignOperations>
                                        </ui:MultipleAssign>
                                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke COMMERCIAL SAMPLE workflow" sap:VirtualizedContainerService.HintSize="384,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_12" UnSafe="False" WorkflowFileName="Template\WORKFLOW - SEND MAIL FOR RPA TEAM.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="mail_Subject">[stSubject]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="mail_Content">[stBody]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="specialReceiver">CCI MONTHLY REPORT</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="mail_CC">
                                              <Literal x:TypeArguments="x:String" Value="" />
                                            </InArgument>
                                            <InArgument x:TypeArguments="s:String[]" x:Key="mail_Attach">[stAttColection]</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                      </Sequence>
                                      <FlowStep.Next>
                                        <x:Reference>__ReferenceID1</x:Reference>
                                      </FlowStep.Next>
                                    </FlowStep>
                                  </FlowDecision.True>
                                  <FlowDecision.False>
                                    <FlowStep x:Name="__ReferenceID1">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <av:Point x:Key="ShapeLocation">460,1017</av:Point>
                                          <av:Size x:Key="ShapeSize">200,66</av:Size>
                                          <av:PointCollection x:Key="ConnectorLocation">660,1050 690,1050 690,926.5 840,926.5 840,956.5</av:PointCollection>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Sequence DisplayName="Delete File" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_840">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:Delete ContinueOnError="{x:Null}" sap:VirtualizedContainerService.HintSize="334,79" sap2010:WorkflowViewState.IdRef="Delete_9" Path="[&quot;H:\Robotics\CCI REPORT\CCI_&quot;+DateTime.Now.ToString(&quot;yyyyMMdd&quot;)+&quot;.jpg&quot;]" />
                                        <ui:Delete ContinueOnError="{x:Null}" sap:VirtualizedContainerService.HintSize="334,79" sap2010:WorkflowViewState.IdRef="Delete_10" Path="[&quot;H:\Robotics\CCI REPORT\&quot;+DateTime.Now.ToString(&quot;yyyyMMdd&quot;)+&quot;_report.html&quot;]" />
                                      </Sequence>
                                      <FlowStep.Next>
                                        <FlowDecision x:Name="__ReferenceID9" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_2">
                                          <FlowDecision.Condition>
                                            <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="arrDate.Count = 0" />
                                          </FlowDecision.Condition>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <av:Point x:Key="ShapeLocation">800.5,956.5</av:Point>
                                              <av:Size x:Key="ShapeSize">79,87</av:Size>
                                              <av:PointCollection x:Key="TrueConnector">530.641666666667,930 330,930</av:PointCollection>
                                              <av:PointCollection x:Key="FalseConnector">879.5,1000 1049.895,1000 1049.895,640</av:PointCollection>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <FlowDecision.False>
                                            <FlowStep x:Name="__ReferenceID10">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">918.895,580</av:Point>
                                                  <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">1180.895,610 1210.895,610 1210.895,196.5 1100,196.5 1100,226.5</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1101">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Int32">[i]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Int32">[i + 1]</InArgument>
                                                </Assign.Value>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </Assign>
                                              <FlowStep.Next>
                                                <FlowDecision x:Name="__ReferenceID11" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_3">
                                                  <FlowDecision.Condition>
                                                    <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="i &lt; arrDate.Count" />
                                                  </FlowDecision.Condition>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <av:Point x:Key="ShapeLocation">1060.5,226.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">79,87</av:Size>
                                                      <av:PointCollection x:Key="TrueConnector">1060.5,270 660,270</av:PointCollection>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <FlowDecision.True>
                                                    <x:Reference>__ReferenceID0</x:Reference>
                                                  </FlowDecision.True>
                                                </FlowDecision>
                                              </FlowStep.Next>
                                            </FlowStep>
                                          </FlowDecision.False>
                                        </FlowDecision>
                                      </FlowStep.Next>
                                    </FlowStep>
                                  </FlowDecision.False>
                                </FlowDecision>
                              </FlowStep.Next>
                            </FlowStep>
                          </FlowStep.Next>
                        </FlowStep>
                      </FlowStep.Next>
                    </FlowStep>
                  </FlowStep.Next>
                </FlowStep>
              </FlowStep.Next>
            </FlowStep>
          </FlowStep.Next>
        </FlowStep>
      </FlowStep.Next>
    </FlowStep>
    <x:Reference>__ReferenceID1</x:Reference>
    <x:Reference>__ReferenceID2</x:Reference>
    <x:Reference>__ReferenceID0</x:Reference>
    <x:Reference>__ReferenceID3</x:Reference>
    <x:Reference>__ReferenceID4</x:Reference>
    <x:Reference>__ReferenceID5</x:Reference>
    <x:Reference>__ReferenceID6</x:Reference>
    <x:Reference>__ReferenceID7</x:Reference>
    <FlowStep>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">810,127</av:Point>
          <av:Size x:Key="ShapeSize">200,66</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">910,193 910,270 660,270</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <Sequence DisplayName="Get past data" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1015">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1079">
          <Assign.To>
            <OutArgument x:TypeArguments="s:String[]">[arrDate]</OutArgument>
          </Assign.To>
          <Assign.Value>
            <InArgument x:TypeArguments="s:String[]">[{"20210801"}]</InArgument>
          </Assign.Value>
        </Assign>
        <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1099">
          <Assign.To>
            <OutArgument x:TypeArguments="x:Int32">[i]</OutArgument>
          </Assign.To>
          <Assign.Value>
            <InArgument x:TypeArguments="x:Int32">0</InArgument>
          </Assign.Value>
        </Assign>
      </Sequence>
      <FlowStep.Next>
        <x:Reference>__ReferenceID0</x:Reference>
      </FlowStep.Next>
    </FlowStep>
    <x:Reference>__ReferenceID8</x:Reference>
    <x:Reference>__ReferenceID9</x:Reference>
    <x:Reference>__ReferenceID10</x:Reference>
    <x:Reference>__ReferenceID11</x:Reference>
  </Flowchart>
</Activity>