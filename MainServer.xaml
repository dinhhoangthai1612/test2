<Activity mc:Ignorable="sap sap2010" x:Class="MainServer" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:p="http://schemas.microsoft.com/workflow/2012/07/xaml/activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:si="clr-namespace:System.IO;assembly=mscorlib" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="supportFlag" Type="InArgument(x:Boolean)" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1196,810</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>Main_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="76">
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Net</x:String>
      <x:String>UiPath.Database</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Activities.DynamicUpdate</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>UiPath.Database.Activities</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>System.Runtime.InteropServices</x:String>
      <x:String>UiPath.Mail</x:String>
      <x:String>UiPath.Mail.SMTP.Activities</x:String>
      <x:String>UiPath.Mail.Activities</x:String>
      <x:String>Microsoft.Activities.Expressions</x:String>
      <x:String>UiPath.Excel.Activities</x:String>
      <x:String>UiPath.MicrosoftOffice365.Models</x:String>
      <x:String>Microsoft.Graph</x:String>
      <x:String>System.Security</x:String>
      <x:String>UiPath.MicrosoftOffice365.Enums</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities</x:String>
      <x:String>UiPath.Shared.Activities</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.Mail</x:String>
      <x:String>Diacritics_Converter</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.Files</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="96">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>UiPath.IntelligentOCR</AssemblyReference>
      <AssemblyReference>UiPath.Python</AssemblyReference>
      <AssemblyReference>Microsoft.VisualStudio.Services.Common</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>UiPath.Cryptography</AssemblyReference>
      <AssemblyReference>UiPath.Java.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.Word</AssemblyReference>
      <AssemblyReference>UiPath.PDF</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Database</AssemblyReference>
      <AssemblyReference>UiPath.OmniPage.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.CV</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.Data.Entity</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>OfficeDevPnP.Core</AssemblyReference>
      <AssemblyReference>UiPathTeam.SharePoint</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization</AssemblyReference>
      <AssemblyReference>UiPath.Database.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities.Design</AssemblyReference>
      <AssemblyReference>Microsoft.Activities</AssemblyReference>
      <AssemblyReference>System.Configuration.Install</AssemblyReference>
      <AssemblyReference>UiPath.MicrosoftOffice365</AssemblyReference>
      <AssemblyReference>Microsoft.Graph.Core</AssemblyReference>
      <AssemblyReference>Microsoft.Graph</AssemblyReference>
      <AssemblyReference>UiPath.MicrosoftOffice365.Activities</AssemblyReference>
      <AssemblyReference>UiPath.IntelligentOCR.Activities</AssemblyReference>
      <AssemblyReference>UiPath.OmniPage.Activities</AssemblyReference>
      <AssemblyReference>UiPath.PDF.Activities</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Word.Activities</AssemblyReference>
      <AssemblyReference>UiPathTeam.SharePoint.Activities</AssemblyReference>
      <AssemblyReference>UiPath_Diacritics_Converter</AssemblyReference>
      <AssemblyReference>UiPath.Presentations</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Flowchart DisplayName="MainServer" sap:VirtualizedContainerService.HintSize="644,770" sap2010:WorkflowViewState.IdRef="Flowchart_1">
    <Flowchart.Variables>
      <Variable x:TypeArguments="x:String" Name="FileName" />
      <Variable x:TypeArguments="x:String" Name="stCurrentDate" />
      <Variable x:TypeArguments="x:String" Name="TimeStamp" />
      <Variable x:TypeArguments="si:DirectoryInfo" Name="dirSavedFile" />
      <Variable x:TypeArguments="x:Boolean" Name="Status_Sendmail" />
      <Variable x:TypeArguments="si:DirectoryInfo" Name="dirDownFile" />
      <Variable x:TypeArguments="s:DateTime" Name="FirstTime" />
      <Variable x:TypeArguments="x:String" Default="[Dns.GetHostByName(Dns.GetHostName()).AddressList(0).ToString]" Name="IP_Address" />
      <Variable x:TypeArguments="x:String" Name="EndStatus" />
      <Variable x:TypeArguments="x:String" Name="EndMessage" />
      <Variable x:TypeArguments="x:String" Name="mailTextHTML" />
      <Variable x:TypeArguments="x:String" Name="StartDay_Log" />
      <Variable x:TypeArguments="x:String" Name="EndDay_Log" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_history" />
      <Variable x:TypeArguments="x:String" Name="FileName_Mail" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_RobotName" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_Server" />
      <Variable x:TypeArguments="x:String" Name="Mail_Server" />
      <Variable x:TypeArguments="x:String" Name="Mail_Email" />
      <Variable x:TypeArguments="x:String" Name="Mail_Password" />
      <Variable x:TypeArguments="x:String" Name="RobotName" />
      <Variable x:TypeArguments="x:String" Name="Mail_PIC" />
      <Variable x:TypeArguments="x:String" Name="Path_File" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_Path" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_library" />
      <Variable x:TypeArguments="x:String" Name="MailCC" />
      <Variable x:TypeArguments="x:String" Default="SUCCESSFUL" Name="Content_Status" />
      <Variable x:TypeArguments="x:String" Default="Robot run has been completed !" Name="Content_Message" />
      <Variable x:TypeArguments="x:String" Name="Path_Downloads" />
      <Variable x:TypeArguments="x:String" Name="StartDay_ErrorLog" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_Schedule" />
      <Variable x:TypeArguments="x:String" Name="SendMail" />
      <Variable x:TypeArguments="x:String" Name="Path_Template" />
      <Variable x:TypeArguments="x:String" Name="Matches_Mail" />
      <Variable x:TypeArguments="x:String" Name="Mail_Send" />
      <Variable x:TypeArguments="x:String" Name="StartTime_Log" />
      <Variable x:TypeArguments="x:String" Name="EndTime_Log" />
      <Variable x:TypeArguments="x:Boolean" Name="Run_Process" />
      <Variable x:TypeArguments="x:Boolean" Name="File_Exists" />
      <Variable x:TypeArguments="sd:DataTable" Name="dt_MailSend" />
      <Variable x:TypeArguments="x:String" Name="Machine_Name" />
      <Variable x:TypeArguments="x:String" Name="Order_Number" />
      <Variable x:TypeArguments="x:String" Name="StartDay_SQL" />
      <Variable x:TypeArguments="x:String" Name="EndDay_SQL" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtTemp" />
      <Variable x:TypeArguments="x:String" Name="MailServerIP" />
    </Flowchart.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <av:Point x:Key="ShapeLocation">260,2.5</av:Point>
        <av:Size x:Key="ShapeSize">60,75</av:Size>
        <av:PointCollection x:Key="ConnectorLocation">290,77.5 290,127.5</av:PointCollection>
        <x:Double x:Key="Height">734</x:Double>
        <x:Double x:Key="Width">610</x:Double>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Flowchart.StartNode>
      <x:Reference>__ReferenceID10</x:Reference>
    </Flowchart.StartNode>
    <FlowStep x:Name="__ReferenceID10" sap2010:WorkflowViewState.IdRef="FlowStep_21">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">190,127.5</av:Point>
          <av:Size x:Key="ShapeSize">200,66</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">290,193.5 290,223.5</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <Sequence DisplayName="SQL Configure" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_75">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <TryCatch DisplayName="Try Catch SQL Configure" sap:VirtualizedContainerService.HintSize="438,1395" sap2010:WorkflowViewState.IdRef="TryCatch_125">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <TryCatch.Try>
            <Sequence DisplayName="Assign SQL Configure" sap:VirtualizedContainerService.HintSize="376,1168" sap2010:WorkflowViewState.IdRef="Sequence_713">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_777" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                <ui:InvokeWorkflowFile.Arguments>
                  <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.server_nt SET Date = '"+DateTime.Now.ToString+"', RobotName = '',WARNING = '',FileName='' WHERE ServerName = '"+IP_Address+"'"]</InArgument>
                  <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                </ui:InvokeWorkflowFile.Arguments>
              </ui:InvokeWorkflowFile>
              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Lấy Mail bộ phận RPA" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_149" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                <ui:InvokeWorkflowFile.Arguments>
                  <InArgument x:TypeArguments="x:String" x:Key="Query">SELECT * FROM RPALIB.LIBRARY_NT WHERE Name IN ('PIC')</InArgument>
                  <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_library]</OutArgument>
                </ui:InvokeWorkflowFile.Arguments>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:InvokeWorkflowFile>
              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Lấy tài khoản Mail" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_150" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                <ui:InvokeWorkflowFile.Arguments>
                  <InArgument x:TypeArguments="x:String" x:Key="Query">SELECT * FROM RPALIB.LIBRARY_NT WHERE Name IN ('MailAddress_Outlook','MailPassword_Outlook','MailServer')</InArgument>
                  <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_Server]</OutArgument>
                </ui:InvokeWorkflowFile.Arguments>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:InvokeWorkflowFile>
              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Lấy đường dẫn lưu file tải về từ Mail và Template" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_151" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                <ui:InvokeWorkflowFile.Arguments>
                  <InArgument x:TypeArguments="x:String" x:Key="Query" xml:space="preserve">SELECT * FROM RPALIB.LIBRARY_NT WHERE Name IN ('ServerSavedFile','dirDownFile','ServerTemp')  ORDER BY UPPER(NAME)</InArgument>
                  <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_Path]</OutArgument>
                </ui:InvokeWorkflowFile.Arguments>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:InvokeWorkflowFile>
              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="334,284" sap2010:WorkflowViewState.IdRef="MultipleAssign_15">
                <ui:MultipleAssign.AssignOperations>
                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_34">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:String">[Mail_Server]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:String">[dt_Server.Rows(2)(1).ToString]</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_35">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:String">[Mail_Email]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:String">[dt_Server.Rows(0)(1).ToString]</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_36">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:String">[Mail_Password]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:String">[dt_Server.Rows(1)(1).ToString]</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_37">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:String">[Mail_PIC]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:String">[dt_library.Rows(0)(1).ToString]</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_38">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:String">[Path_Downloads]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:String">[dt_Path.Rows(0)(1).ToString]</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_39">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:String">[Path_File]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:String">[dt_Path.Rows(1)(1).ToString]</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_58">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:String">[Path_Template]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:String">[dt_Path.Rows(2)(1).ToString]</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                  </scg:List>
                </ui:MultipleAssign.AssignOperations>
              </ui:MultipleAssign>
              <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="CommentOut_2">
                <ui:CommentOut.Body>
                  <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="376,335" sap2010:WorkflowViewState.IdRef="Sequence_1346">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Get IP Mail Server" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_773" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="x:String" x:Key="Query">SELECT ServerName FROM RPALIB.server_nt WHERE MAIN_STATUS='MAIL'</InArgument>
                        <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_Server]</OutArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:InvokeWorkflowFile>
                    <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_2276">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:String">[MailServerIP]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:String">[dt_Server.Rows(0)(0).ToString]</InArgument>
                      </Assign.Value>
                    </Assign>
                  </Sequence>
                </ui:CommentOut.Body>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:CommentOut>
            </Sequence>
          </TryCatch.Try>
          <TryCatch.Catches>
            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_126">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ActivityAction x:TypeArguments="s:Exception">
                <ActivityAction.Argument>
                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                </ActivityAction.Argument>
                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Error" Message="[exception]" />
              </ActivityAction>
            </Catch>
          </TryCatch.Catches>
        </TryCatch>
      </Sequence>
      <FlowStep.Next>
        <FlowStep x:Name="__ReferenceID5" sap2010:WorkflowViewState.IdRef="FlowStep_27">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:Point x:Key="ShapeLocation">190,223.5</av:Point>
              <av:Size x:Key="ShapeSize">200,66</av:Size>
              <av:PointCollection x:Key="ConnectorLocation">290,289.5 290,316.04</av:PointCollection>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Sequence DisplayName="Task Scheduler" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_85">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Sequence DisplayName="Process Schedule" sap:VirtualizedContainerService.HintSize="1239,3816" sap2010:WorkflowViewState.IdRef="Sequence_1226">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="1197,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_828" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                <ui:InvokeWorkflowFile.Arguments>
                  <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.server_nt SET Date = '"+DateTime.Now.ToString+"', RobotName = 'TASK SCHEDULER',WARNING = '',FileName='' WHERE ServerName = '"+IP_Address+"'"]</InArgument>
                  <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                </ui:InvokeWorkflowFile.Arguments>
              </ui:InvokeWorkflowFile>
              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="1197,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_778" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                <ui:InvokeWorkflowFile.Arguments>
                  <InArgument x:TypeArguments="x:String" x:Key="Query">["SELECT TO_DATE(TIME, 'HH24:MI'),B.* FROM RPALIB.ROBOT_SCHEDULE_NT B WHERE MACHINE_NAME = '"+IP_Address+"' AND MAINTENANCE_STATUS = '' ORDER BY TO_DATE(TIME, 'HH24:MI') ASC"]</InArgument>
                  <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_Schedule]</OutArgument>
                </ui:InvokeWorkflowFile.Arguments>
              </ui:InvokeWorkflowFile>
              <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dt_Schedule]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="1197,3420" sap2010:WorkflowViewState.IdRef="ForEachRow_7">
                <ui:ForEachRow.Body>
                  <ActivityAction x:TypeArguments="sd:DataRow">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                    </ActivityAction.Argument>
                    <TryCatch DisplayName="Try catch schedule" sap:VirtualizedContainerService.HintSize="1147,3272" sap2010:WorkflowViewState.IdRef="TryCatch_114">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <TryCatch.Try>
                        <Sequence sap:VirtualizedContainerService.HintSize="1109,3045" sap2010:WorkflowViewState.IdRef="Sequence_1308">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Sequence DisplayName="Run schedule" sap:VirtualizedContainerService.HintSize="1067,2953" sap2010:WorkflowViewState.IdRef="Sequence_1232">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Sequence DisplayName="Configure RPA" sap:VirtualizedContainerService.HintSize="1025,66" sap2010:WorkflowViewState.IdRef="Sequence_1227">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign sap:VirtualizedContainerService.HintSize="497,60" sap2010:WorkflowViewState.IdRef="Assign_2190">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="s:DateTime">[FirstTime]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="s:DateTime">[Convert.ToDateTime(row("Day").ToString + " " + row("Time").ToString)]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <Switch x:TypeArguments="x:String" DisplayName="Switch type run" Expression="[row(&quot;Type_Run&quot;).ToString]" sap:VirtualizedContainerService.HintSize="497,226" sap2010:WorkflowViewState.IdRef="Switch`1_50">
                                <Switch.Default>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2197">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Boolean">[Run_Process]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </Switch.Default>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If x:Key="D" Condition="[FirstTime.ToShortDateString &lt;&gt; DateTime.Now.ToShortDateString]" DisplayName="If Daily" sap:VirtualizedContainerService.HintSize="569,218" sap2010:WorkflowViewState.IdRef="If_776">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2193">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Boolean">[Run_Process]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                  </If.Then>
                                  <If.Else>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2194">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Boolean">[Run_Process]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                  </If.Else>
                                </If>
                                <If x:Key="W" Condition="[FirstTime.ToShortDateString &lt;&gt; DateTime.Now.ToShortDateString And FirstTime.DayOfWeek=DateTime.Now.DayOfWeek]" DisplayName="If Weekly" sap:VirtualizedContainerService.HintSize="569,218" sap2010:WorkflowViewState.IdRef="If_777">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2195">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Boolean">[Run_Process]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                  </If.Then>
                                  <If.Else>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2196">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Boolean">[Run_Process]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                  </If.Else>
                                </If>
                                <If x:Key="M" Condition="[FirstTime.Month &lt;&gt; DateTime.Now.Month And FirstTime.Day = DateTime.Now.Day]" DisplayName="If Monthly" sap:VirtualizedContainerService.HintSize="569,218" sap2010:WorkflowViewState.IdRef="If_775">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2191">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Boolean">[Run_Process]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                  </If.Then>
                                  <If.Else>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2192">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Boolean">[Run_Process]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                  </If.Else>
                                </If>
                                <If x:Key="S" Condition="[FirstTime.ToShortDateString = DateTime.Now.ToShortDateString]" DisplayName="If special" sap:VirtualizedContainerService.HintSize="569,218" sap2010:WorkflowViewState.IdRef="If_785">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2213">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Boolean">[Run_Process]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                  </If.Then>
                                  <If.Else>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2214">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Boolean">[Run_Process]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                  </If.Else>
                                </If>
                                <Assign x:Key="F" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2217">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:Boolean">[Run_Process]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                  </Assign.Value>
                                </Assign>
                              </Switch>
                            </Sequence>
                            <If Condition="[Convert.ToDateTime(row(&quot;Time&quot;).ToString) &lt; DateTime.Now And DateTime.Now &lt; Convert.ToDateTime(row(&quot;Time&quot;).ToString).AddHours(Convert.ToInt32(row(&quot;Max_Time&quot;).ToString)) And Run_Process = True]" DisplayName="Run Process" sap:VirtualizedContainerService.HintSize="1025,2755" sap2010:WorkflowViewState.IdRef="If_778">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <If.Then>
                                <Sequence DisplayName="Function schedule" sap:VirtualizedContainerService.HintSize="989,2578" sap2010:WorkflowViewState.IdRef="Sequence_1229">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Sequence DisplayName="Delete File Old Download" sap:VirtualizedContainerService.HintSize="947,66" sap2010:WorkflowViewState.IdRef="Sequence_1010">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign sap:VirtualizedContainerService.HintSize="320,60" sap2010:WorkflowViewState.IdRef="Assign_1759">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="si:DirectoryInfo">[dirDownFile]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="si:DirectoryInfo">[new directoryInfo (Path_Downloads)]</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <ui:ForEach x:TypeArguments="si:FileInfo" CurrentIndex="{x:Null}" DisplayName="Delete old pdf file in Download folder" sap:VirtualizedContainerService.HintSize="320,213" sap2010:WorkflowViewState.IdRef="ForEach`1_123" Values="[dirDownFile.GetFiles(&quot;*.pdf&quot;)]">
                                      <ui:ForEach.Body>
                                        <ActivityAction x:TypeArguments="si:FileInfo">
                                          <ActivityAction.Argument>
                                            <DelegateInArgument x:TypeArguments="si:FileInfo" Name="File" />
                                          </ActivityAction.Argument>
                                          <ui:Delete ContinueOnError="{x:Null}" sap:VirtualizedContainerService.HintSize="284,79" sap2010:WorkflowViewState.IdRef="Delete_15" Path="[Path_Downloads+File.Name]" />
                                        </ActivityAction>
                                      </ui:ForEach.Body>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:ForEach>
                                    <ui:ForEach x:TypeArguments="si:FileInfo" CurrentIndex="{x:Null}" DisplayName="Delete old excel file in Download folder" sap:VirtualizedContainerService.HintSize="320,213" sap2010:WorkflowViewState.IdRef="ForEach`1_124" Values="[dirDownFile.GetFiles(&quot;*.xls*&quot;)]">
                                      <ui:ForEach.Body>
                                        <ActivityAction x:TypeArguments="si:FileInfo">
                                          <ActivityAction.Argument>
                                            <DelegateInArgument x:TypeArguments="si:FileInfo" Name="File" />
                                          </ActivityAction.Argument>
                                          <ui:Delete ContinueOnError="{x:Null}" sap:VirtualizedContainerService.HintSize="284,79" sap2010:WorkflowViewState.IdRef="Delete_16" Path="[Path_Downloads+File.Name]" />
                                        </ActivityAction>
                                      </ui:ForEach.Body>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:ForEach>
                                    <ui:ForEach x:TypeArguments="si:FileInfo" CurrentIndex="{x:Null}" DisplayName="Delete old csv file in Download folder" sap:VirtualizedContainerService.HintSize="320,213" sap2010:WorkflowViewState.IdRef="ForEach`1_125" Values="[dirDownFile.GetFiles(&quot;*.csv*&quot;)]">
                                      <ui:ForEach.Body>
                                        <ActivityAction x:TypeArguments="si:FileInfo">
                                          <ActivityAction.Argument>
                                            <DelegateInArgument x:TypeArguments="si:FileInfo" Name="File" />
                                          </ActivityAction.Argument>
                                          <ui:Delete ContinueOnError="{x:Null}" sap:VirtualizedContainerService.HintSize="284,79" sap2010:WorkflowViewState.IdRef="Delete_17" Path="[Path_Downloads+File.Name]" />
                                        </ActivityAction>
                                      </ui:ForEach.Body>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:ForEach>
                                  </Sequence>
                                  <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="947,51" sap2010:WorkflowViewState.IdRef="MultipleAssign_311">
                                    <ui:MultipleAssign.AssignOperations>
                                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                        <ui:AssignOperation sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AssignOperation_957">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[StartDay_Log]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString("yyyyMMdd")]</InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_958">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[StartTime_Log]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString("HH:mm:ss")]</InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_960">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[StartDay_ErrorLog]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString]</InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_964">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[RobotName]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">[row("Name").ToString]</InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_965">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[Order_Number]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">[row("Order_Number").ToString]</InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_968">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[StartDay_SQL]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString]</InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                      </scg:List>
                                    </ui:MultipleAssign.AssignOperations>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:MultipleAssign>
                                  <Sequence DisplayName="Sq/Start Status" sap:VirtualizedContainerService.HintSize="947,66" sap2010:WorkflowViewState.IdRef="Sequence_1228">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2198">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[EndStatus]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">[Content_Status]</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2199">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[EndMessage]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">[Content_Message]</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                  </Sequence>
                                  <Sequence sap:VirtualizedContainerService.HintSize="947,66" sap2010:WorkflowViewState.IdRef="Sequence_1306">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_779" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.server_nt SET Date = '"+DateTime.Now.ToString+"', RobotName = '"+RobotName+"',WARNING = '' WHERE ServerName = '"+IP_Address+"'"]</InArgument>
                                        <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                      </ui:InvokeWorkflowFile.Arguments>
                                    </ui:InvokeWorkflowFile>
                                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_780" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.robot_schedule_nt SET Process_Status = 'Running',Process='"+DateTime.Now.ToString+"' WHERE Name = '"+RobotName+"' AND Order_Number = '"+Order_Number+"'"]</InArgument>
                                        <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                      </ui:InvokeWorkflowFile.Arguments>
                                    </ui:InvokeWorkflowFile>
                                  </Sequence>
                                  <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke workflow file" sap:VirtualizedContainerService.HintSize="947,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_821" UnSafe="False" WorkflowFileName="[RobotName + &quot;.xaml&quot;]">
                                    <ui:InvokeWorkflowFile.Arguments>
                                      <InOutArgument x:TypeArguments="x:String" x:Key="EndStatus">[EndStatus]</InOutArgument>
                                      <InOutArgument x:TypeArguments="x:String" x:Key="EndMessage">[EndMessage]</InOutArgument>
                                      <InOutArgument x:TypeArguments="x:String" x:Key="Order_Number">[Order_Number]</InOutArgument>
                                    </ui:InvokeWorkflowFile.Arguments>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:InvokeWorkflowFile>
                                  <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="947,51" sap2010:WorkflowViewState.IdRef="CommentOut_1">
                                    <ui:CommentOut.Body>
                                      <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="242,143" sap2010:WorkflowViewState.IdRef="Sequence_1341">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <Flowchart DisplayName="Try to run x3" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Flowchart_2">
                                          <Flowchart.Variables>
                                            <Variable x:TypeArguments="x:Int32" Name="runTimes" />
                                          </Flowchart.Variables>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
                                              <av:Size x:Key="ShapeSize">60,75</av:Size>
                                              <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,130</av:PointCollection>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Flowchart.StartNode>
                                            <x:Reference>__ReferenceID4</x:Reference>
                                          </Flowchart.StartNode>
                                          <FlowStep x:Name="__ReferenceID4">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <av:Point x:Key="ShapeLocation">169,130</av:Point>
                                                <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                <av:PointCollection x:Key="ConnectorLocation">300,190 300,234.5</av:PointCollection>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2305">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:Int32">[runTimes]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:Int32">3</InArgument>
                                              </Assign.Value>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </Assign>
                                            <FlowStep.Next>
                                              <FlowStep x:Name="__ReferenceID0">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <av:Point x:Key="ShapeLocation">200,234.5</av:Point>
                                                    <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                    <av:PointCollection x:Key="ConnectorLocation">300,285.5 300,315.5 300.141666666667,315.5 300.141666666667,326.5</av:PointCollection>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_138">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <TryCatch.Try>
                                                    <Sequence sap:VirtualizedContainerService.HintSize="376,304" sap2010:WorkflowViewState.IdRef="Sequence_1328">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke workflow file" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_814" UnSafe="False" WorkflowFileName="[RobotName + &quot;.xaml&quot;]">
                                                        <ui:InvokeWorkflowFile.Arguments>
                                                          <InOutArgument x:TypeArguments="x:String" x:Key="EndStatus">[EndStatus]</InOutArgument>
                                                          <InOutArgument x:TypeArguments="x:String" x:Key="EndMessage">[EndMessage]</InOutArgument>
                                                          <InOutArgument x:TypeArguments="x:String" x:Key="Order_Number">[Order_Number]</InOutArgument>
                                                        </ui:InvokeWorkflowFile.Arguments>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:InvokeWorkflowFile>
                                                      <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_2307">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Int32">[runTimes]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Int32">100</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                    </Sequence>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_139">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                        <Sequence sap:VirtualizedContainerService.HintSize="376,301" sap2010:WorkflowViewState.IdRef="Sequence_1327">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_815" UnSafe="False" WorkflowFileName="REFRESH FUNCTION.xaml">
                                                            <ui:InvokeWorkflowFile.Arguments>
                                                              <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                            </ui:InvokeWorkflowFile.Arguments>
                                                          </ui:InvokeWorkflowFile>
                                                          <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_2306">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:Int32">[runTimes]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:Int32">[runTimes - 1]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </Sequence>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                                <FlowStep.Next>
                                                  <FlowDecision x:Name="__ReferenceID1" Condition="[runTimes &lt; 3 and runTimes &gt; 0]" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_1" True="{x:Reference __ReferenceID0}">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <av:Point x:Key="ShapeLocation">260.641666666667,326.5</av:Point>
                                                        <av:Size x:Key="ShapeSize">79,87</av:Size>
                                                        <av:PointCollection x:Key="TrueConnector">260.641666666667,370 170,370 170,260 200,260</av:PointCollection>
                                                        <av:PointCollection x:Key="FalseConnector">339.641666666667,370 369.641666666667,370 369.641666666667,296.5 460.141666666667,296.5 460.141666666667,326.5</av:PointCollection>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <FlowDecision.False>
                                                      <FlowDecision x:Name="__ReferenceID3" Condition="[runTimes = 100]" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_2">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <av:Point x:Key="ShapeLocation">420.641666666667,326.5</av:Point>
                                                            <av:Size x:Key="ShapeSize">79,87</av:Size>
                                                            <av:PointCollection x:Key="FalseConnector">499.641666666667,370 520,370 520,444.5 460,444.5 460,474.5</av:PointCollection>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <FlowDecision.False>
                                                          <FlowStep x:Name="__ReferenceID2">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <av:Point x:Key="ShapeLocation">360,474.5</av:Point>
                                                                <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke workflow file" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_759" UnSafe="False" WorkflowFileName="[RobotName + &quot;.xaml&quot;]">
                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                <InOutArgument x:TypeArguments="x:String" x:Key="EndStatus">[EndStatus]</InOutArgument>
                                                                <InOutArgument x:TypeArguments="x:String" x:Key="EndMessage">[EndMessage]</InOutArgument>
                                                                <InOutArgument x:TypeArguments="x:String" x:Key="Order_Number">[Order_Number]</InOutArgument>
                                                              </ui:InvokeWorkflowFile.Arguments>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:InvokeWorkflowFile>
                                                          </FlowStep>
                                                        </FlowDecision.False>
                                                      </FlowDecision>
                                                    </FlowDecision.False>
                                                  </FlowDecision>
                                                </FlowStep.Next>
                                              </FlowStep>
                                            </FlowStep.Next>
                                          </FlowStep>
                                          <x:Reference>__ReferenceID1</x:Reference>
                                          <x:Reference>__ReferenceID0</x:Reference>
                                          <x:Reference>__ReferenceID2</x:Reference>
                                          <x:Reference>__ReferenceID3</x:Reference>
                                        </Flowchart>
                                      </Sequence>
                                    </ui:CommentOut.Body>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:CommentOut>
                                  <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="947,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_781" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                    <ui:InvokeWorkflowFile.Arguments>
                                      <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.server_nt SET Date = '"+DateTime.Now.ToString+"', RobotName = '',WARNING = '',FileName='' WHERE ServerName = '"+IP_Address+"'"]</InArgument>
                                      <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                    </ui:InvokeWorkflowFile.Arguments>
                                  </ui:InvokeWorkflowFile>
                                  <Assign sap:VirtualizedContainerService.HintSize="947,60" sap2010:WorkflowViewState.IdRef="Assign_2262">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[EndMessage]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">[EndMessage.Replace("'","''")]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <If Condition="[EndMessage.Length&lt;255]" DisplayName="If Message too long" sap:VirtualizedContainerService.HintSize="947,51" sap2010:WorkflowViewState.IdRef="If_807">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Else>
                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2326">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[EndMessage]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">[EndMessage.Substring(0,250)]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </If.Else>
                                  </If>
                                  <If Condition="[EndStatus=&quot;SUCCESSFUL&quot;]" sap:VirtualizedContainerService.HintSize="947,539" sap2010:WorkflowViewState.IdRef="If_806">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <Sequence sap:VirtualizedContainerService.HintSize="376,204" sap2010:WorkflowViewState.IdRef="Sequence_1273">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_782" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.robot_schedule_nt SET Process_Status = '' WHERE Name = '"+RobotName+"' AND Order_Number = '"+Order_Number+"'"]</InArgument>
                                            <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                      </Sequence>
                                    </If.Then>
                                    <If.Else>
                                      <Sequence sap:VirtualizedContainerService.HintSize="526,381" sap2010:WorkflowViewState.IdRef="Sequence_1358">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If Condition="[EndMessage = &quot;Robot run has been completed !&quot;]" DisplayName="If EndMessage is completed" sap:VirtualizedContainerService.HintSize="484,289" sap2010:WorkflowViewState.IdRef="If_817">
                                          <If.Then>
                                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_784" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                              <ui:InvokeWorkflowFile.Arguments>
                                                <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.robot_schedule_nt SET Process_Status = '"+EndMessage+"' WHERE Name = '"+RobotName+"' AND Order_Number = '"+Order_Number+"'"]</InArgument>
                                                <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                              </ui:InvokeWorkflowFile.Arguments>
                                            </ui:InvokeWorkflowFile>
                                          </If.Then>
                                        </If>
                                      </Sequence>
                                    </If.Else>
                                  </If>
                                  <Switch x:TypeArguments="x:String" DisplayName="Switch update day" Expression="[row(&quot;Type_Run&quot;).ToString]" sap:VirtualizedContainerService.HintSize="947,138" sap2010:WorkflowViewState.IdRef="Switch`1_51">
                                    <Switch.Default>
                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_785" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                        <ui:InvokeWorkflowFile.Arguments>
                                          <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.ROBOT_SCHEDULE_NT SET DAY = '"+DateTime.Now.ToString("MM/dd/yyyy")+"',PROCESS_STATUS = CASE WHEN PROCESS_STATUS='Running' THEN '"+EndStatus+"' ELSE PROCESS_STATUS END WHERE NAME = '"+RobotName+"' AND ORDER_NUMBER = '"+Order_Number+"'"]</InArgument>
                                          <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                        </ui:InvokeWorkflowFile.Arguments>
                                      </ui:InvokeWorkflowFile>
                                    </Switch.Default>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If x:Key="S" sap2010:Annotation.AnnotationText="Nếu EndMessage = False thì sẽ update giờ chạy tiếp theo trong function robot" Condition="[EndMessage.ToString.ToUpper.Trim = &quot;FALSE&quot;]" sap:VirtualizedContainerService.HintSize="484,301" sap2010:WorkflowViewState.IdRef="If_813">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Else>
                                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_786" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.ROBOT_SCHEDULE_NT SET DAY = '"+DateTime.Now.AddDays(Convert.ToInt32(EndMessage.ToString)).ToString("MM/dd/yyyy")+"' WHERE NAME = '"+RobotName+"' AND ORDER_NUMBER = '"+Order_Number+"'"]</InArgument>
                                            <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                      </If.Else>
                                    </If>
                                  </Switch>
                                  <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="947,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_312">
                                    <ui:MultipleAssign.AssignOperations>
                                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_961">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[EndDay_Log]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString("yyyyMMdd")]</InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_962">
                                          <ui:AssignOperation.To>
                                            <OutArgument x:TypeArguments="x:String">[EndTime_Log]</OutArgument>
                                          </ui:AssignOperation.To>
                                          <ui:AssignOperation.Value>
                                            <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString("HH:mm:ss")]</InArgument>
                                          </ui:AssignOperation.Value>
                                        </ui:AssignOperation>
                                      </scg:List>
                                    </ui:MultipleAssign.AssignOperations>
                                  </ui:MultipleAssign>
                                  <Switch x:TypeArguments="x:String" DisplayName="Switch End Log" Expression="[row(&quot;Type_Run&quot;).ToString]" sap:VirtualizedContainerService.HintSize="947,565" sap2010:WorkflowViewState.IdRef="Switch`1_53">
                                    <Switch.Default>
                                      <Sequence DisplayName="Write Log MS SQL" sap:VirtualizedContainerService.HintSize="376,204" sap2010:WorkflowViewState.IdRef="Sequence_1235">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_788" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="Query" xml:space="preserve">["INSERT INTO RPALIB.robot_log_nt(STATUS, STARTDAY, ENDDAY, PROCESSNAME, USERNAME, FILENAME, REVEIVEDTIME, IPADDRESS) VALUES('"+EndStatus+"','"+StartDay_SQL+"','"+
DateTime.Now.ToString+"','"+
RobotName+"','"+row("Type_Run").ToString+"','"+row("Id").ToString+"','','"+IP_Address+"')"]</InArgument>
                                            <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                      </Sequence>
                                    </Switch.Default>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If x:Key="F" Condition="[EndMessage.ToLower = &quot;true&quot;]" sap:VirtualizedContainerService.HintSize="484,381" sap2010:WorkflowViewState.IdRef="If_787">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <Sequence DisplayName="Write Log MS SQL" sap:VirtualizedContainerService.HintSize="376,204" sap2010:WorkflowViewState.IdRef="Sequence_1237">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_787" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                            <ui:InvokeWorkflowFile.Arguments>
                                              <InArgument x:TypeArguments="x:String" x:Key="Query" xml:space="preserve">["INSERT INTO RPALIB.robot_log_nt(STATUS, STARTDAY, ENDDAY, PROCESSNAME, USERNAME, FILENAME, REVEIVEDTIME, IPADDRESS) VALUES('"+EndStatus+"','"+StartDay_SQL+"','"+
DateTime.Now.ToString+"','"+
RobotName+"','"+row("Type_Run").ToString+"','"+row("Id").ToString+"','','"+IP_Address+"')"]</InArgument>
                                              <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                            </ui:InvokeWorkflowFile.Arguments>
                                          </ui:InvokeWorkflowFile>
                                        </Sequence>
                                      </If.Then>
                                    </If>
                                  </Switch>
                                </Sequence>
                              </If.Then>
                            </If>
                          </Sequence>
                        </Sequence>
                      </TryCatch.Try>
                      <TryCatch.Catches>
                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="1113,21" sap2010:WorkflowViewState.IdRef="Catch`1_115">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ActivityAction x:TypeArguments="s:Exception">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                            </ActivityAction.Argument>
                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_763" UnSafe="False" WorkflowFileName="MainError.xaml">
                              <ui:InvokeWorkflowFile.Arguments>
                                <InArgument x:TypeArguments="x:String" x:Key="TimeStart_ErrorLog">[StartDay_ErrorLog]</InArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="RobotName">[RobotName]</InArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="Mail_PIC">[Mail_PIC]</InArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="Mail_Server">[Mail_Server]</InArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="Mail_Email">[Mail_Email]</InArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="Mail_Password">[Mail_Password]</InArgument>
                                <InArgument x:TypeArguments="s:Exception" x:Key="exception">[exception]</InArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="Order_Number">[Order_Number]</InArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="IP_Address">[IP_Address]</InArgument>
                              </ui:InvokeWorkflowFile.Arguments>
                            </ui:InvokeWorkflowFile>
                          </ActivityAction>
                        </Catch>
                      </TryCatch.Catches>
                    </TryCatch>
                  </ActivityAction>
                </ui:ForEachRow.Body>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:ForEachRow>
            </Sequence>
          </Sequence>
          <FlowStep.Next>
            <FlowStep x:Name="__ReferenceID7">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">190,316.04</av:Point>
                  <av:Size x:Key="ShapeSize">200,66</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">290,382.04 290,407</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Sequence DisplayName="Check mail robot" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1344">
                <Sequence.Variables>
                  <Variable x:TypeArguments="sd:DataTable" Name="dt_MailAddress" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Get IP Server checking mail robot" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="484,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_822" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="x:String" x:Key="Query">SELECT SERVERNAME FROM RPALIB.SERVER_NT WHERE ROBOTNAME='CHECKING MAIL ROBOT...' ORDER BY WARNING LIMIT 1</InArgument>
                    <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_MailAddress]</OutArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:InvokeWorkflowFile>
                <If Condition="[dt_MailAddress.Rows.Count &lt; 1]" DisplayName="If don't have server checking mail" sap:VirtualizedContainerService.HintSize="484,289" sap2010:WorkflowViewState.IdRef="If_834">
                  <If.Then>
                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke MailServer workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_823" UnSafe="False" WorkflowFileName="MailServer.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <scg:Dictionary x:TypeArguments="x:String, Argument" />
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                  </If.Then>
                  <If.Else>
                    <Sequence sap2010:WorkflowViewState.IdRef="Sequence_1345">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </Sequence>
                  </If.Else>
                </If>
              </Sequence>
              <FlowStep.Next>
                <FlowStep x:Name="__ReferenceID6" sap2010:WorkflowViewState.IdRef="FlowStep_29">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:Point x:Key="ShapeLocation">190,407</av:Point>
                      <av:Size x:Key="ShapeSize">200,66</av:Size>
                      <av:PointCollection x:Key="ConnectorLocation">290,473 290,503</av:PointCollection>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Sequence DisplayName="Process Mail" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_156">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="1961,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_829" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.server_nt SET Date = '"+DateTime.Now.ToString+"', RobotName = 'PROCESS MAIL',WARNING = '',FileName='' WHERE ServerName = '"+IP_Address+"'"]</InArgument>
                        <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                    <TryCatch DisplayName="Try catch" sap:VirtualizedContainerService.HintSize="1961,9202" sap2010:WorkflowViewState.IdRef="TryCatch_1">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <TryCatch.Try>
                        <Sequence DisplayName="Mail" sap:VirtualizedContainerService.HintSize="1923,8975" sap2010:WorkflowViewState.IdRef="Sequence_566">
                          <Sequence.Variables>
                            <Variable x:TypeArguments="x:Boolean" Name="stopFlag" />
                          </Sequence.Variables>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Sequence sap2010:Annotation.AnnotationText="Lấy ngày và giờ hiện tại" DisplayName="Get DateTime" sap:VirtualizedContainerService.HintSize="1881,183" sap2010:WorkflowViewState.IdRef="Sequence_685">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1150">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:String">[TimeStamp]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString("yyyyMMdd_HHmmss")]</InArgument>
                              </Assign.Value>
                            </Assign>
                          </Sequence>
                          <Sequence sap:VirtualizedContainerService.HintSize="1881,8660" sap2010:WorkflowViewState.IdRef="Sequence_1307">
                            <Sequence.Variables>
                              <Variable x:TypeArguments="x:String" Name="strSQL" />
                            </Sequence.Variables>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:ReadTextFile Content="[strSQL]" DisplayName="Read Text File" FileName="[Path_Template+&quot;RPA\MainServer_SQL_DB2.txt&quot;]" sap:VirtualizedContainerService.HintSize="1839,79" sap2010:WorkflowViewState.IdRef="ReadTextFile_3" />
                            <If Condition="[supportFlag]" sap:VirtualizedContainerService.HintSize="1839,237" sap2010:WorkflowViewState.IdRef="If_821">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <If.Then>
                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2290">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:String">[strSQL.Replace("--AND MACHINE_NAME","AND MACHINE_NAME LIKE '%"+IP_Address+"%'")]</InArgument>
                                  </Assign.Value>
                                </Assign>
                              </If.Then>
                            </If>
                            <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="1839,51" sap2010:WorkflowViewState.IdRef="CommentOut_5">
                              <ui:CommentOut.Body>
                                <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="304,152" sap2010:WorkflowViewState.IdRef="Sequence_1352">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2284">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">[strSQL.Replace("((SERVER_MAIL))",IP_Address)]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </Sequence>
                              </ui:CommentOut.Body>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:CommentOut>
                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="1839,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_789" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                              <ui:InvokeWorkflowFile.Arguments>
                                <InArgument x:TypeArguments="x:String" x:Key="Query">[strSQL]</InArgument>
                                <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_RobotName]</OutArgument>
                              </ui:InvokeWorkflowFile.Arguments>
                            </ui:InvokeWorkflowFile>
                            <ui:ForEachRow CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Gọi từng Robot kiểm tra thư mục tương ứng với Robot kiểm tra có request để chạy không" DataTable="[dt_RobotName]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="1839,7929" sap2010:WorkflowViewState.IdRef="ForEachRow_6">
                              <ui:ForEachRow.Body>
                                <ActivityAction x:TypeArguments="sd:DataRow">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                  </ActivityAction.Argument>
                                  <Sequence sap:VirtualizedContainerService.HintSize="1789,7750" sap2010:WorkflowViewState.IdRef="Sequence_1310">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Sequence DisplayName="Delete File Old Download" sap:VirtualizedContainerService.HintSize="1747,66" sap2010:WorkflowViewState.IdRef="Sequence_1309">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign sap:VirtualizedContainerService.HintSize="320,60" sap2010:WorkflowViewState.IdRef="Assign_2278">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="si:DirectoryInfo">[dirDownFile]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="si:DirectoryInfo">[new directoryInfo (Path_Downloads)]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <ui:ForEach x:TypeArguments="si:FileInfo" CurrentIndex="{x:Null}" DisplayName="Delete old pdf file in Download folder" sap:VirtualizedContainerService.HintSize="320,213" sap2010:WorkflowViewState.IdRef="ForEach`1_126" Values="[dirDownFile.GetFiles(&quot;*.pdf&quot;)]">
                                        <ui:ForEach.Body>
                                          <ActivityAction x:TypeArguments="si:FileInfo">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="si:FileInfo" Name="File" />
                                            </ActivityAction.Argument>
                                            <ui:Delete ContinueOnError="{x:Null}" sap:VirtualizedContainerService.HintSize="284,79" sap2010:WorkflowViewState.IdRef="Delete_18" Path="[Path_Downloads+File.Name]" />
                                          </ActivityAction>
                                        </ui:ForEach.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:ForEach>
                                      <ui:ForEach x:TypeArguments="si:FileInfo" CurrentIndex="{x:Null}" DisplayName="Delete old excel file in Download folder" sap:VirtualizedContainerService.HintSize="320,213" sap2010:WorkflowViewState.IdRef="ForEach`1_127" Values="[dirDownFile.GetFiles(&quot;*.xls*&quot;)]">
                                        <ui:ForEach.Body>
                                          <ActivityAction x:TypeArguments="si:FileInfo">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="si:FileInfo" Name="File" />
                                            </ActivityAction.Argument>
                                            <ui:Delete ContinueOnError="{x:Null}" sap:VirtualizedContainerService.HintSize="284,79" sap2010:WorkflowViewState.IdRef="Delete_19" Path="[Path_Downloads+File.Name]" />
                                          </ActivityAction>
                                        </ui:ForEach.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:ForEach>
                                      <ui:ForEach x:TypeArguments="si:FileInfo" CurrentIndex="{x:Null}" DisplayName="Delete old csv file in Download folder" sap:VirtualizedContainerService.HintSize="307,194" sap2010:WorkflowViewState.IdRef="ForEach`1_128" Values="[dirDownFile.GetFiles(&quot;*.csv*&quot;)]">
                                        <ui:ForEach.Body>
                                          <ActivityAction x:TypeArguments="si:FileInfo">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="si:FileInfo" Name="File" />
                                            </ActivityAction.Argument>
                                            <ui:Delete ContinueOnError="{x:Null}" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delete_20" Path="[Path_Downloads+File.Name]" />
                                          </ActivityAction>
                                        </ui:ForEach.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:ForEach>
                                    </Sequence>
                                    <Sequence DisplayName="Function Call Robot" sap:VirtualizedContainerService.HintSize="1747,7552" sap2010:WorkflowViewState.IdRef="Sequence_992">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="1705,253" sap2010:WorkflowViewState.IdRef="MultipleAssign_198">
                                        <ui:MultipleAssign.AssignOperations>
                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_588">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[RobotName]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[row(1).ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AssignOperation_589">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[MailCC]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[row(4).ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AssignOperation_590">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[SendMail]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[row(6).ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_591">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Machine_Name]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[row(7).ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_979">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:Boolean">[stopFlag]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_983">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Matches_Mail]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[row(3).ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                          </scg:List>
                                        </ui:MultipleAssign.AssignOperations>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:MultipleAssign>
                                      <If sap2010:Annotation.AnnotationText="Kiểm tra công việc nào Machine sẽ thực hiện" Condition="[String.IsNullOrEmpty(Machine_Name)]" DisplayName="If Machine Process" sap:VirtualizedContainerService.HintSize="1705,93" sap2010:WorkflowViewState.IdRef="If_607">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Else>
                                          <If sap2010:Annotation.AnnotationText="Kiểm tra địa chỉ IP của machine đó trong database" Condition="[Machine_Name.Contains(IP_Address)]" sap:VirtualizedContainerService.HintSize="484,249" sap2010:WorkflowViewState.IdRef="If_616">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Else>
                                              <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_8" />
                                            </If.Else>
                                          </If>
                                        </If.Else>
                                      </If>
                                      <Sequence DisplayName="Running Robot" sap:VirtualizedContainerService.HintSize="1705,7034" sap2010:WorkflowViewState.IdRef="Sequence_991">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <Assign sap:VirtualizedContainerService.HintSize="1663,60" sap2010:WorkflowViewState.IdRef="Assign_1721">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="si:DirectoryInfo">[dirSavedFile]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="si:DirectoryInfo">[new DirectoryInfo(Path_File+left(TimeStamp,6)+"\"+RobotName+"\Input")]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <ui:ForEach x:TypeArguments="si:FileInfo" CurrentIndex="{x:Null}" DisplayName="For each file in folder" sap:VirtualizedContainerService.HintSize="1663,6413" sap2010:WorkflowViewState.IdRef="ForEach`1_122" Values="[dirSavedFile.GetFiles(&quot;*.xls*&quot;)]">
                                          <ui:ForEach.Body>
                                            <ActivityAction x:TypeArguments="si:FileInfo">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="si:FileInfo" Name="File" />
                                              </ActivityAction.Argument>
                                              <Sequence sap:VirtualizedContainerService.HintSize="1627,6279" sap2010:WorkflowViewState.IdRef="Sequence_1304">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="1585,51" sap2010:WorkflowViewState.IdRef="CommentOut_4">
                                                  <ui:CommentOut.Body>
                                                    <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="242,143" sap2010:WorkflowViewState.IdRef="Sequence_1351">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If Condition="[IP_Address=MailServerIP]" DisplayName="If Mail Server running" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_815">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence sap:VirtualizedContainerService.HintSize="526,669" sap2010:WorkflowViewState.IdRef="Sequence_1302">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Lấy tài khoản Mail" DisplayName="Check over robot" sap:VirtualizedContainerService.HintSize="484,144" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_774" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                <InArgument x:TypeArguments="x:String" x:Key="Query">SELECT ServerName FROM RPALIB.server_nt WHERE MAIN_STATUS ='' AND RobotName=''</InArgument>
                                                                <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_Server]</OutArgument>
                                                              </ui:InvokeWorkflowFile.Arguments>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:InvokeWorkflowFile>
                                                            <If Condition="[dt_Server.Rows.Count &gt; 0]" sap:VirtualizedContainerService.HintSize="484,393" sap2010:WorkflowViewState.IdRef="If_814">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <Sequence sap:VirtualizedContainerService.HintSize="304,214" sap2010:WorkflowViewState.IdRef="Sequence_1301">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2277">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Boolean">[stopFlag]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <ui:Break sap:VirtualizedContainerService.HintSize="262,22" sap2010:WorkflowViewState.IdRef="Break_1" />
                                                                </Sequence>
                                                              </If.Then>
                                                            </If>
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                    </Sequence>
                                                  </ui:CommentOut.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:CommentOut>
                                                <Sequence DisplayName="Action Process" sap:VirtualizedContainerService.HintSize="1585,6096" sap2010:WorkflowViewState.IdRef="Sequence_990">
                                                  <Sequence.Variables>
                                                    <Variable x:TypeArguments="x:String" Name="stUserName" />
                                                  </Sequence.Variables>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <Assign sap:VirtualizedContainerService.HintSize="1543,60" sap2010:WorkflowViewState.IdRef="Assign_1722">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:String">[FileName]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:String">[File.Name]</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                  <ui:PathExists DisplayName="Path Exists" Exists="[File_Exists]" sap:VirtualizedContainerService.HintSize="1543,89" sap2010:WorkflowViewState.IdRef="PathExists_6" Path="[Path_File+left(TimeStamp,6)+&quot;\&quot;+RobotName+&quot;\Input\&quot;+FileName]" PathType="File" />
                                                  <If sap2010:Annotation.AnnotationText="Kiểm tra xem file có tồn tại không nếu có di chuyển file nếu không tiếp tục kiểm tra file tiếp theo" Condition="[File_Exists = True]" DisplayName="If file name exists" sap:VirtualizedContainerService.HintSize="1543,123" sap2010:WorkflowViewState.IdRef="If_608">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="464,595" sap2010:WorkflowViewState.IdRef="TryCatch_137">
                                                        <TryCatch.Try>
                                                          <Sequence sap:VirtualizedContainerService.HintSize="426,368" sap2010:WorkflowViewState.IdRef="Sequence_1349">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:CreateDirectory ContinueOnError="{x:Null}" DisplayName="Create Folder" sap:VirtualizedContainerService.HintSize="384,79" sap2010:WorkflowViewState.IdRef="CreateDirectory_1" Path="[Path_File+left(TimeStamp,6)+&quot;\&quot;+RobotName+&quot;\Output\&quot;]" />
                                                            <ui:MoveFile ContinueOnError="{x:Null}" Destination="[Path_File+left(TimeStamp,6)+&quot;\&quot;+RobotName+&quot;\Output\&quot;+FileName]" DisplayName="Move file" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="MoveFile_17" Overwrite="True" Path="[Path_File+left(TimeStamp,6)+&quot;\&quot;+RobotName+&quot;\Input\&quot;+FileName]">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:MoveFile>
                                                          </Sequence>
                                                        </TryCatch.Try>
                                                        <TryCatch.Catches>
                                                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="430,21" sap2010:WorkflowViewState.IdRef="Catch`1_138">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ActivityAction x:TypeArguments="s:Exception">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                              </ActivityAction.Argument>
                                                              <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_10" />
                                                            </ActivityAction>
                                                          </Catch>
                                                        </TryCatch.Catches>
                                                      </TryCatch>
                                                    </If.Then>
                                                    <If.Else>
                                                      <ui:Continue DisplayName="Continue" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_9" />
                                                    </If.Else>
                                                  </If>
                                                  <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="1543,551" sap2010:WorkflowViewState.IdRef="TryCatch_136">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <TryCatch.Try>
                                                      <Sequence sap:VirtualizedContainerService.HintSize="326,324" sap2010:WorkflowViewState.IdRef="Sequence_1275">
                                                        <Sequence.Variables>
                                                          <Variable x:TypeArguments="s:String[]" Name="dt_Temp" />
                                                        </Sequence.Variables>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <p:SplitString DisplayName="Split string" sap:VirtualizedContainerService.HintSize="284,132" sap2010:WorkflowViewState.IdRef="SplitString_2" Input="[FileName]" Result="[dt_Temp]" Separator="@" StringSplitOptions="None" />
                                                        <Assign sap:VirtualizedContainerService.HintSize="284,60" sap2010:WorkflowViewState.IdRef="Assign_2265">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:String">[Mail_Send]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:String">[dt_Temp(0)+"@"+dt_Temp(1).Substring(0,dt_Temp(1).IndexOf("_"))]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                      </Sequence>
                                                    </TryCatch.Try>
                                                    <TryCatch.Catches>
                                                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_137">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ActivityAction x:TypeArguments="s:Exception">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                          </ActivityAction.Argument>
                                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2264">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[Mail_Send]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[Mail_PIC]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </ActivityAction>
                                                      </Catch>
                                                    </TryCatch.Catches>
                                                  </TryCatch>
                                                  <If sap2010:Annotation.AnnotationText="Nếu muốn tạm dừng Robot để bảo trì hoặc sữa chữa xin vui lòng khóa Robot tại SQL" Condition="[String.IsNullOrEmpty(row(5).ToString)]" DisplayName="If run or skip robot" sap:VirtualizedContainerService.HintSize="1543,5021" sap2010:WorkflowViewState.IdRef="If_615">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <Sequence sap:VirtualizedContainerService.HintSize="1077,4832" sap2010:WorkflowViewState.IdRef="Sequence_1353">
                                                        <Sequence.Variables>
                                                          <Variable x:TypeArguments="x:Boolean" Name="runFile" />
                                                        </Sequence.Variables>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If sap2010:Annotation.AnnotationText="PIC FUNCTION" Condition="[Matches_Mail = &quot;Everyone&quot;]" sap:VirtualizedContainerService.HintSize="1035,803" sap2010:WorkflowViewState.IdRef="If_836">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2321">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Boolean">[runFile]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </If.Then>
                                                          <If.Else>
                                                            <If Condition="[Matches_Mail.Contains(Mail_Send)]" sap:VirtualizedContainerService.HintSize="728,614" sap2010:WorkflowViewState.IdRef="If_837">
                                                              <If.Then>
                                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2322">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Boolean">[runFile]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </If.Then>
                                                              <If.Else>
                                                                <Sequence sap:VirtualizedContainerService.HintSize="421,456" sap2010:WorkflowViewState.IdRef="Sequence_1355">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke WORKFLOW - GET USERNAME FROM HR BY EMAIL workflow" sap:VirtualizedContainerService.HintSize="379,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_824" UnSafe="False" WorkflowFileName="Template\WORKFLOW - GET USERNAME FROM HR BY EMAIL.xaml">
                                                                    <ui:InvokeWorkflowFile.Arguments>
                                                                      <InArgument x:TypeArguments="x:String" x:Key="stUserEmail">[Mail_Send]</InArgument>
                                                                      <OutArgument x:TypeArguments="x:String" x:Key="stUserName">[stUserName]</OutArgument>
                                                                    </ui:InvokeWorkflowFile.Arguments>
                                                                  </ui:InvokeWorkflowFile>
                                                                  <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="If send mail maintainer" sap:VirtualizedContainerService.HintSize="379,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_825" UnSafe="False" WorkflowFileName="Template\WORKFLOW - SEND MAIL FOR RPA TEAM.xaml">
                                                                    <ui:InvokeWorkflowFile.Arguments>
                                                                      <InArgument x:TypeArguments="x:String" x:Key="mail_Subject">["[RPA] MAINTAINER : " + RobotName]</InArgument>
                                                                      <InArgument x:TypeArguments="x:String" x:Key="mail_Content" xml:space="preserve">["&lt;p&gt;&lt;b&gt;Dear "+ stUserName +" san,&lt;/b&gt;&lt;/p&gt;" + 
"&lt;p&gt;Hiện tại Robot này chỉ được phân quyền cho PIC bên dưới.&lt;br/&gt;Xin vui lòng kiểm tra với PIC để thực hiện. &lt;br/&gt;Cảm ơn !&lt;/p&gt;" +
"&lt;p&gt;PIC: " + Matches_Mail + "&lt;/p&gt;"]</InArgument>
                                                                      <InArgument x:TypeArguments="x:String" x:Key="specialReceiver">[Mail_Send]</InArgument>
                                                                      <InArgument x:TypeArguments="x:String" x:Key="mail_CC">[Matches_Mail + ", " + MailCC]</InArgument>
                                                                      <InArgument x:TypeArguments="s:String[]" x:Key="mail_Attach">[{Path_File+left(TimeStamp,6)+"\"+RobotName+"\Output\"+FileName}]</InArgument>
                                                                      <InArgument x:TypeArguments="x:String" x:Key="mail_BCC">
                                                                        <Literal x:TypeArguments="x:String" Value="" />
                                                                      </InArgument>
                                                                      <InArgument x:TypeArguments="x:String" x:Key="RobotName">[RobotName]</InArgument>
                                                                    </ui:InvokeWorkflowFile.Arguments>
                                                                  </ui:InvokeWorkflowFile>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="379,60" sap2010:WorkflowViewState.IdRef="Assign_2323">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Boolean">[runFile]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                </Sequence>
                                                              </If.Else>
                                                            </If>
                                                          </If.Else>
                                                        </If>
                                                        <If Condition="[runFile]" DisplayName="If run" sap:VirtualizedContainerService.HintSize="1035,3897" sap2010:WorkflowViewState.IdRef="If_838">
                                                          <If.Then>
                                                            <Sequence DisplayName="Run Robot" sap:VirtualizedContainerService.HintSize="837,3720" sap2010:WorkflowViewState.IdRef="Sequence_989">
                                                              <Sequence.Variables>
                                                                <Variable x:TypeArguments="x:String" Name="stAddressCC" />
                                                              </Sequence.Variables>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <Sequence DisplayName="Check FileName History MS SQL" sap:VirtualizedContainerService.HintSize="795,295" sap2010:WorkflowViewState.IdRef="Sequence_1234">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_795" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                                  <ui:InvokeWorkflowFile.Arguments>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="Query">["SELECT * FROM RPALIB.robot_log_nt WHERE FileName = '"+FileName+"'"]</InArgument>
                                                                    <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_history]</OutArgument>
                                                                  </ui:InvokeWorkflowFile.Arguments>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:InvokeWorkflowFile>
                                                                <If Condition="[dt_history.Rows.Count = 0]" DisplayName="If history data" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_788">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <If.Then>
                                                                    <Sequence DisplayName="Write Log" sap:VirtualizedContainerService.HintSize="376,495" sap2010:WorkflowViewState.IdRef="Sequence_1233">
                                                                      <Sequence.Variables>
                                                                        <Variable x:TypeArguments="x:String" Name="visServer" />
                                                                      </Sequence.Variables>
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_2218">
                                                                        <Assign.To>
                                                                          <OutArgument x:TypeArguments="x:String">[FileName_Mail]</OutArgument>
                                                                        </Assign.To>
                                                                        <Assign.Value>
                                                                          <InArgument x:TypeArguments="x:String">[FileName]</InArgument>
                                                                        </Assign.Value>
                                                                      </Assign>
                                                                      <If Condition="[Mail_Send.IndexOf(&quot;ykk&quot;) = 0 and Mail_Send.Contains(&quot;_vis_info@ykk.com&quot;)]" DisplayName="If VIS_INFO" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_829">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <If.Then>
                                                                          <Sequence sap:VirtualizedContainerService.HintSize="304,334" sap2010:WorkflowViewState.IdRef="Sequence_1324">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2295">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="x:String">[visServer]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="x:String">10.246.194.1</InArgument>
                                                                              </Assign.Value>
                                                                            </Assign>
                                                                            <If Condition="[Mail_Send = &quot;ykkhanoi_vis_info@ykk.com.vn&quot;]" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="If_825">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <If.Then>
                                                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2296">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:String">[visServer]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:String">10.247.194.1</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                              </If.Then>
                                                                            </If>
                                                                            <Switch x:TypeArguments="x:String" DisplayName="Switch" Expression="[RobotName.ToUpper]" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="Switch`1_54">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <Sequence x:Key="EXTRACT EAP" DisplayName="EXTRACT EAP" sap:VirtualizedContainerService.HintSize="526,564" sap2010:WorkflowViewState.IdRef="Sequence_1321">
                                                                                <Sequence.Variables>
                                                                                  <Variable x:TypeArguments="sd:DataTable" Name="dt_Temp" />
                                                                                  <Variable x:TypeArguments="x:String" Name="strSQL" />
                                                                                </Sequence.Variables>
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <Assign sap:VirtualizedContainerService.HintSize="484,64" sap2010:WorkflowViewState.IdRef="Assign_2297">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:String" xml:space="preserve">SELECT USER_EMAIL
FROM AWADLIB.EAP#08 E8
LEFT JOIN AWADLIB.CM#S01 S1 ON E8.MODIFY_USER=S1.USER_ID
WHERE MY_FORM_ID='((1))' AND PROCESS_SEQ=1</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                                <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Temp]" DisplayName="GET LIST PP" sap:VirtualizedContainerService.HintSize="484,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_2" ProviderName="System.Data.Odbc" Sql="[strSQL.Replace(&quot;((1))&quot;,FileName_Mail.Substring(FileName_Mail.IndexOf(&quot;_Extract EAP Form_&quot;)).Replace(&quot;_Extract EAP Form_&quot;,&quot;&quot;).Replace(&quot;.xlsx&quot;,&quot;&quot;))]" ConnectionString="[&quot;Driver={ISeries Access ODBC Driver};system=&quot;+visServer+&quot;;library=WAVEDLIB;querytimeout=0;uid=VNPRT;pwd=VNPRT&quot;]">
                                                                                  <ui:ExecuteQuery.Parameters>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                                                  </ui:ExecuteQuery.Parameters>
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                </ui:ExecuteQuery>
                                                                                <If Condition="[dt_Temp.Rows.Count &gt; 0]" DisplayName="If found email requestor" sap:VirtualizedContainerService.HintSize="484,240" sap2010:WorkflowViewState.IdRef="If_826">
                                                                                  <If.Then>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2298">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Mail_Send]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[dt_Temp.Rows(0)(0).ToString.Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </If.Then>
                                                                                </If>
                                                                              </Sequence>
                                                                              <Sequence x:Key="ISSUE PO SYSTEM" DisplayName="ISSUE PO SYSTEM" sap:VirtualizedContainerService.HintSize="526,369" sap2010:WorkflowViewState.IdRef="Sequence_1322">
                                                                                <Sequence.Variables>
                                                                                  <Variable x:TypeArguments="sd:DataTable" Name="dt_Temp" />
                                                                                  <Variable x:TypeArguments="x:String" Name="strSQL" />
                                                                                </Sequence.Variables>
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <Assign sap:VirtualizedContainerService.HintSize="484,64" sap2010:WorkflowViewState.IdRef="Assign_2299">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:String" xml:space="preserve">SELECT USER_EMAIL
FROM AWADLIB.PO#P06 P6
LEFT JOIN AWADLIB.CM#S01 S1 ON P6.CREATE_USER=S1.USER_ID
WHERE PO_NO='((1))'</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                                <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Temp]" DisplayName="GET LIST PP" sap:VirtualizedContainerService.HintSize="484,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_3" ProviderName="System.Data.Odbc" Sql="[strSQL.Replace(&quot;((1))&quot;,FileName_Mail.Substring(FileName_Mail.IndexOf(&quot;_RPA(Issue_PO)_PO&quot;)).Replace(&quot;_RPA(Issue_PO)_&quot;,&quot;&quot;).Replace(&quot;.xlsx&quot;,&quot;&quot;))]" ConnectionString="[&quot;Driver={ISeries Access ODBC Driver};system=&quot;+visServer+&quot;;library=WAVEDLIB;querytimeout=0;uid=VNPRT;pwd=VNPRT&quot;]">
                                                                                  <ui:ExecuteQuery.Parameters>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                                                  </ui:ExecuteQuery.Parameters>
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                </ui:ExecuteQuery>
                                                                                <If Condition="[dt_Temp.Rows.Count &gt; 0]" DisplayName="If found email requestor" sap:VirtualizedContainerService.HintSize="484,52" sap2010:WorkflowViewState.IdRef="If_827">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <If.Then>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2300">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Mail_Send]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[dt_Temp.Rows(0)(0).ToString.Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </If.Then>
                                                                                </If>
                                                                              </Sequence>
                                                                              <Sequence x:Key="ISSUE PO SYSTEM HN" DisplayName="ISSUE PO SYSTEM" sap:VirtualizedContainerService.HintSize="526,555" sap2010:WorkflowViewState.IdRef="Sequence_1323">
                                                                                <Sequence.Variables>
                                                                                  <Variable x:TypeArguments="sd:DataTable" Name="dt_Temp" />
                                                                                  <Variable x:TypeArguments="x:String" Name="strSQL" />
                                                                                </Sequence.Variables>
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <Assign sap:VirtualizedContainerService.HintSize="484,64" sap2010:WorkflowViewState.IdRef="Assign_2301">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:String" xml:space="preserve">SELECT USER_EMAIL
FROM AWADLIB.PO#P06 P6
LEFT JOIN AWADLIB.CM#S01 S1 ON P6.CREATE_USER=S1.USER_ID
WHERE PO_NO='((1))'</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                                <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dt_Temp]" DisplayName="GET LIST PP" sap:VirtualizedContainerService.HintSize="484,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_4" ProviderName="System.Data.Odbc" Sql="[strSQL.Replace(&quot;((1))&quot;,FileName_Mail.Substring(FileName_Mail.IndexOf(&quot;_RPA(Issue_PO)_PO&quot;)).Replace(&quot;_RPA(Issue_PO)_&quot;,&quot;&quot;).Replace(&quot;.xlsx&quot;,&quot;&quot;))]" ConnectionString="[&quot;Driver={ISeries Access ODBC Driver};system=&quot;+visServer+&quot;;library=WAVEDLIB;querytimeout=0;uid=VNPRT;pwd=VNPRT&quot;]">
                                                                                  <ui:ExecuteQuery.Parameters>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                                                  </ui:ExecuteQuery.Parameters>
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                </ui:ExecuteQuery>
                                                                                <If Condition="[dt_Temp.Rows.Count &gt; 0]" DisplayName="If found email requestor" sap:VirtualizedContainerService.HintSize="484,240" sap2010:WorkflowViewState.IdRef="If_828">
                                                                                  <If.Then>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2302">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[Mail_Send]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[dt_Temp.Rows(0)(0).ToString.Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </If.Then>
                                                                                </If>
                                                                              </Sequence>
                                                                            </Switch>
                                                                          </Sequence>
                                                                        </If.Then>
                                                                      </If>
                                                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_796" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                                        <ui:InvokeWorkflowFile.Arguments>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="Query">["INSERT INTO RPALIB.robot_log_nt(IpAddress,ProcessName,UserName,FileName,ReveivedTime) VALUES('"+IP_Address+"','"+RobotName+"','"+Mail_Send+"','"+FileName+"','"+DateTime.Now.ToString+"')"]</InArgument>
                                                                          <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                                                        </ui:InvokeWorkflowFile.Arguments>
                                                                      </ui:InvokeWorkflowFile>
                                                                      <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_2325">
                                                                        <Assign.To>
                                                                          <OutArgument x:TypeArguments="x:String">[stAddressCC]</OutArgument>
                                                                        </Assign.To>
                                                                        <Assign.Value>
                                                                          <InArgument x:TypeArguments="x:String">
                                                                            <Literal x:TypeArguments="x:String" Value="" />
                                                                          </InArgument>
                                                                        </Assign.Value>
                                                                      </Assign>
                                                                    </Sequence>
                                                                  </If.Then>
                                                                  <If.Else>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2324">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[stAddressCC]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[dt_history.Rows(0)(8).ToString]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                  </If.Else>
                                                                </If>
                                                              </Sequence>
                                                              <Sequence DisplayName="Send mail receive fIle" sap:VirtualizedContainerService.HintSize="795,66" sap2010:WorkflowViewState.IdRef="Sequence_996">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="707,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_430" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                                  <ui:InvokeWorkflowFile.Arguments>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="Query">["SELECT * FROM RPALIB.ROBOT_LOG_NT WHERE FILENAME = '" + FileName + "'"]</InArgument>
                                                                    <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_MailSend]</OutArgument>
                                                                  </ui:InvokeWorkflowFile.Arguments>
                                                                </ui:InvokeWorkflowFile>
                                                                <If sap2010:Annotation.AnnotationText="Kiểm tra Robot có được phép gửi mail không và gửi mail xác nhận đang thực hiện quá trình" Condition="[String.IsNullOrEmpty(dt_MailSend.Rows(0)(1).ToString)]" DisplayName="If send mail receive" sap:VirtualizedContainerService.HintSize="707,1061" sap2010:WorkflowViewState.IdRef="If_610">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <If.Then>
                                                                    <If sap2010:Annotation.AnnotationText="Kiểm tra nếu không phải mail EAP thì gửi mail xác nhận" Condition="[Mail_Send.IndexOf(&quot;ykk&quot;) = 0 and Mail_Send.Contains(&quot;_vis_info@ykk.com&quot;)]" sap:VirtualizedContainerService.HintSize="671,853" sap2010:WorkflowViewState.IdRef="If_819">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <If.Else>
                                                                        <Sequence sap:VirtualizedContainerService.HintSize="526,664" sap2010:WorkflowViewState.IdRef="Sequence_1325">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Send received" sap:VirtualizedContainerService.HintSize="484,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_816" UnSafe="False" WorkflowFileName="Template\WORKFLOW - GET USERNAME FROM HR BY EMAIL.xaml">
                                                                            <ui:InvokeWorkflowFile.Arguments>
                                                                              <InArgument x:TypeArguments="x:String" x:Key="stUserEmail">[Mail_Send]</InArgument>
                                                                              <OutArgument x:TypeArguments="x:String" x:Key="stUserName">[stUserName]</OutArgument>
                                                                            </ui:InvokeWorkflowFile.Arguments>
                                                                          </ui:InvokeWorkflowFile>
                                                                          <If sap2010:Annotation.AnnotationText="Kiểm tra Robot có gửi cc thêm ai không" Condition="[String.IsNullOrEmpty(MailCC.Trim)]" DisplayName="If send mail receive" sap:VirtualizedContainerService.HintSize="484,268" sap2010:WorkflowViewState.IdRef="If_790">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <If.Then>
                                                                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2304">
                                                                                <Assign.To>
                                                                                  <OutArgument x:TypeArguments="x:String">[MailCC]</OutArgument>
                                                                                </Assign.To>
                                                                                <Assign.Value>
                                                                                  <InArgument x:TypeArguments="x:String">["ducna@ykk.com, "]</InArgument>
                                                                                </Assign.Value>
                                                                              </Assign>
                                                                            </If.Then>
                                                                          </If>
                                                                          <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Send mail received" sap:VirtualizedContainerService.HintSize="484,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_797" UnSafe="False" WorkflowFileName="Template\WORKFLOW - SEND MAIL FOR RPA TEAM.xaml">
                                                                            <ui:InvokeWorkflowFile.Arguments>
                                                                              <InArgument x:TypeArguments="x:String" x:Key="mail_Subject">["[RPA] Receive File : " + RobotName]</InArgument>
                                                                              <InArgument x:TypeArguments="x:String" x:Key="mail_Content" xml:space="preserve">["&lt;p&gt;&lt;b&gt;Dear "+ stUserName +" san,&lt;/b&gt;&lt;/p&gt;" + 
"&lt;p&gt;The robot "+IP_Address+" has received a request from you and is starting the running process &lt;br/&gt;Please wait until the robot has completed the process and will send the resulting file to you&lt;br/&gt;Request File : " + Path.GetFileName(FileName) + "&lt;/p&gt;"]</InArgument>
                                                                              <InArgument x:TypeArguments="x:String" x:Key="specialReceiver">[Mail_Send]</InArgument>
                                                                              <InArgument x:TypeArguments="x:String" x:Key="mail_CC">[stAddressCC + ", " + MailCC]</InArgument>
                                                                              <InArgument x:TypeArguments="s:String[]" x:Key="mail_Attach">[{Path_File+left(TimeStamp,6)+"\"+RobotName+"\Output\"+FileName}]</InArgument>
                                                                              <InArgument x:TypeArguments="x:String" x:Key="mail_BCC">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                              <InArgument x:TypeArguments="x:String" x:Key="RobotName">[RobotName]</InArgument>
                                                                            </ui:InvokeWorkflowFile.Arguments>
                                                                          </ui:InvokeWorkflowFile>
                                                                        </Sequence>
                                                                      </If.Else>
                                                                    </If>
                                                                  </If.Then>
                                                                </If>
                                                              </Sequence>
                                                              <Sequence DisplayName="Start Log" sap:VirtualizedContainerService.HintSize="795,373" sap2010:WorkflowViewState.IdRef="Sequence_1236">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="334,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_313">
                                                                  <ui:MultipleAssign.AssignOperations>
                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_969">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[StartDay_ErrorLog]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_970">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[StartDay_SQL]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                    </scg:List>
                                                                  </ui:MultipleAssign.AssignOperations>
                                                                </ui:MultipleAssign>
                                                                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_799" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                                  <ui:InvokeWorkflowFile.Arguments>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.robot_log_nt SET STATUS='',StartDay = '"+StartDay_SQL+"', IpAddress = '"+IP_Address+"' WHERE FileName = '"+FileName+"'"]</InArgument>
                                                                    <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                                                  </ui:InvokeWorkflowFile.Arguments>
                                                                </ui:InvokeWorkflowFile>
                                                              </Sequence>
                                                              <Sequence DisplayName="Start Status" sap:VirtualizedContainerService.HintSize="795,66" sap2010:WorkflowViewState.IdRef="Sequence_987">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1724">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[EndStatus]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">[Content_Status]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1725">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[EndMessage]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">[Content_Message]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </Sequence>
                                                              <TryCatch DisplayName="Try Catch Run Robot" sap:VirtualizedContainerService.HintSize="795,2668" sap2010:WorkflowViewState.IdRef="TryCatch_134">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <TryCatch.Try>
                                                                  <Sequence sap:VirtualizedContainerService.HintSize="718,3100" sap2010:WorkflowViewState.IdRef="Sequence_1278">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="676,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_806" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                        <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.server_nt SET WARNING ='', Date = '"+DateTime.Now.ToString+"', RobotName = '"+RobotName+"',FileName='"+FileName+"' WHERE ServerName = '"+IP_Address+"'"]</InArgument>
                                                                        <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                    </ui:InvokeWorkflowFile>
                                                                    <Sequence DisplayName="Move hide sheet to last" sap:VirtualizedContainerService.HintSize="676,66" sap2010:WorkflowViewState.IdRef="Sequence_1339">
                                                                      <Sequence.Variables>
                                                                        <Variable x:TypeArguments="ui:WorkbookApplication" Name="wbInput" />
                                                                      </Sequence.Variables>
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ui:ExcelApplicationScope Password="{x:Null}" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="434,449" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_1" InstanceCachePeriod="3000" Workbook="[wbInput]" WorkbookPath="[Path_File+left(TimeStamp,6)+&quot;\&quot;+RobotName+&quot;\Output\&quot;+FileName]">
                                                                        <ui:ExcelApplicationScope.Body>
                                                                          <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                            <ActivityAction.Argument>
                                                                              <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                            </ActivityAction.Argument>
                                                                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,340" sap2010:WorkflowViewState.IdRef="Sequence_1340">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <ui:InvokeVBA OutputValue="{x:Null}" CodeFilePath="D:\Server\YkkNT\VBA\VBA.vb" DisplayName="Invoke VBA" EntryMethodName="MoveHidedSheet" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeVBA_1" />
                                                                              <ui:ExcelSaveWorkbook DisplayName="Save Workbook" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="ExcelSaveWorkbook_1" />
                                                                              <ui:ExcelCloseWorkbook DisplayName="Close Workbook" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_1" Workbook="[wbInput]" />
                                                                            </Sequence>
                                                                          </ActivityAction>
                                                                        </ui:ExcelApplicationScope.Body>
                                                                      </ui:ExcelApplicationScope>
                                                                    </Sequence>
                                                                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke workflow file" sap:VirtualizedContainerService.HintSize="676,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_434" UnSafe="False" WorkflowFileName="[RobotName.ToUpper+&quot;.xaml&quot;]">
                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                        <InArgument x:TypeArguments="x:String" x:Key="FileName">[FileName]</InArgument>
                                                                        <InArgument x:TypeArguments="x:String" x:Key="TimeStamp">[TimeStamp]</InArgument>
                                                                        <InArgument x:TypeArguments="x:String" x:Key="RobotName">[RobotName]</InArgument>
                                                                        <InOutArgument x:TypeArguments="x:String" x:Key="EndStatus">[EndStatus]</InOutArgument>
                                                                        <InOutArgument x:TypeArguments="x:String" x:Key="EndMessage">[EndMessage]</InOutArgument>
                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                    </ui:InvokeWorkflowFile>
                                                                    <If Condition="[not EndStatus=&quot;SEND MAIL&quot;]" DisplayName="Check send mail function robot " sap:VirtualizedContainerService.HintSize="676,1459" sap2010:WorkflowViewState.IdRef="If_840">
                                                                      <If.Then>
                                                                        <If sap2010:Annotation.AnnotationText="Kiểm tra Robot có được phép gửi mail không" Condition="[String.IsNullOrEmpty(SendMail.ToString.Trim)]" DisplayName="If send mail result" sap:VirtualizedContainerService.HintSize="640,1282" sap2010:WorkflowViewState.IdRef="If_613">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <If.Then>
                                                                            <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="604,1074" sap2010:WorkflowViewState.IdRef="TryCatch_132">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <TryCatch.Try>
                                                                                <If Condition="[Mail_Send.Contains(&quot;_vis_info@ykk.com&quot;)]" sap:VirtualizedContainerService.HintSize="566,847" sap2010:WorkflowViewState.IdRef="If_805">
                                                                                  <If.Else>
                                                                                    <Sequence DisplayName="Send result mail" sap:VirtualizedContainerService.HintSize="421,689" sap2010:WorkflowViewState.IdRef="Sequence_1318">
                                                                                      <Sequence.Variables>
                                                                                        <Variable x:TypeArguments="x:String" Name="stmailCC" />
                                                                                        <Variable x:TypeArguments="sd:DataTable" Name="dt_MailCC" />
                                                                                        <Variable x:TypeArguments="x:String" Name="userAccount" />
                                                                                      </Sequence.Variables>
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Get User for send result" sap:VirtualizedContainerService.HintSize="379,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_818" UnSafe="False" WorkflowFileName="Template\WORKFLOW - GET USERNAME FROM HR BY EMAIL.xaml">
                                                                                        <ui:InvokeWorkflowFile.Arguments>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="stUserEmail">[Mail_Send]</InArgument>
                                                                                          <OutArgument x:TypeArguments="x:String" x:Key="stUserName">[stUserName]</OutArgument>
                                                                                        </ui:InvokeWorkflowFile.Arguments>
                                                                                      </ui:InvokeWorkflowFile>
                                                                                      <If sap2010:Annotation.AnnotationText="Kiểm tra Robot có gửi cc thêm ai không" Condition="[String.IsNullOrEmpty(MailCC.Trim)]" DisplayName="If send mail result" sap:VirtualizedContainerService.HintSize="379,93" sap2010:WorkflowViewState.IdRef="If_789">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <If.Then>
                                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2287">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[MailCC]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </Assign.Value>
                                                                                          </Assign>
                                                                                        </If.Then>
                                                                                      </If>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="379,60" sap2010:WorkflowViewState.IdRef="Assign_2288">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[userAccount]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[System.Security.Principal.WindowsIdentity.GetCurrent().Name]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="379,60" sap2010:WorkflowViewState.IdRef="Assign_2289">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[userAccount]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[userAccount.Substring(userAccount.LastIndexOf("\")+1)]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Send result email" sap:VirtualizedContainerService.HintSize="379,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_808" UnSafe="False" WorkflowFileName="Template\WORKFLOW - SEND MAIL FOR RPA TEAM.xaml">
                                                                                        <ui:InvokeWorkflowFile.Arguments>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="mail_Subject">["[RPA] " + EndStatus + ": " + RobotName + " - " + userAccount]</InArgument>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="mail_Content" xml:space="preserve">["&lt;p&gt;&lt;b&gt;Dear "+ stUserName +" san,&lt;/b&gt;&lt;/p&gt;" + 
"&lt;p&gt;" + EndMessage +" &lt;br/&gt;Xin vui lòng kiểm tra lại file kết quả. &lt;br/&gt;Cảm ơn!&lt;p&gt;Filename: "+FileName+"&lt;/p&gt;"]</InArgument>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="specialReceiver">[Mail_Send]</InArgument>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="mail_CC">[stAddressCC + ", " + MailCC]</InArgument>
                                                                                          <InArgument x:TypeArguments="s:String[]" x:Key="mail_Attach">[{Path_File+left(TimeStamp,6)+"\"+RobotName+"\Output\"+FileName}]</InArgument>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="mail_BCC">
                                                                                            <Literal x:TypeArguments="x:String" Value="" />
                                                                                          </InArgument>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="RobotName">[RobotName]</InArgument>
                                                                                        </ui:InvokeWorkflowFile.Arguments>
                                                                                      </ui:InvokeWorkflowFile>
                                                                                    </Sequence>
                                                                                  </If.Else>
                                                                                </If>
                                                                              </TryCatch.Try>
                                                                              <TryCatch.Catches>
                                                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="570,21" sap2010:WorkflowViewState.IdRef="Catch`1_133">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                                                    <ActivityAction.Argument>
                                                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                                    </ActivityAction.Argument>
                                                                                    <Sequence sap:VirtualizedContainerService.HintSize="421,356" sap2010:WorkflowViewState.IdRef="Sequence_1337">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Get User PIC" sap:VirtualizedContainerService.HintSize="379,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_819" UnSafe="False" WorkflowFileName="Template\WORKFLOW - GET USERNAME FROM HR BY EMAIL.xaml">
                                                                                        <ui:InvokeWorkflowFile.Arguments>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="stUserEmail">[Mail_PIC]</InArgument>
                                                                                          <OutArgument x:TypeArguments="x:String" x:Key="stUserName">[stUserName]</OutArgument>
                                                                                        </ui:InvokeWorkflowFile.Arguments>
                                                                                      </ui:InvokeWorkflowFile>
                                                                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="send result exception email" sap:VirtualizedContainerService.HintSize="379,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_809" UnSafe="False" WorkflowFileName="Template\WORKFLOW - SEND MAIL FOR RPA TEAM.xaml">
                                                                                        <ui:InvokeWorkflowFile.Arguments>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="mail_Subject">["[RPA] " + EndStatus + ": " + RobotName]</InArgument>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="mail_Content" xml:space="preserve">["&lt;p&gt;&lt;b&gt;Dear "+ stUserName +" san,&lt;/b&gt;&lt;/p&gt;" + 
"&lt;p&gt;" + EndMessage +" &lt;br/&gt;Xin vui lòng kiểm tra lại file kết quả. &lt;br/&gt;Cảm ơn!&lt;p&gt;Filename: "+FileName+"&lt;/p&gt;"]</InArgument>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="specialReceiver">[Mail_PIC]</InArgument>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="mail_CC">
                                                                                            <Literal x:TypeArguments="x:String" Value="" />
                                                                                          </InArgument>
                                                                                          <InArgument x:TypeArguments="s:String[]" x:Key="mail_Attach">[{Path_File+left(TimeStamp,6)+"\"+RobotName+"\Output\"+FileName}]</InArgument>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="mail_BCC">
                                                                                            <Literal x:TypeArguments="x:String" Value="" />
                                                                                          </InArgument>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="RobotName">[RobotName]</InArgument>
                                                                                        </ui:InvokeWorkflowFile.Arguments>
                                                                                      </ui:InvokeWorkflowFile>
                                                                                    </Sequence>
                                                                                  </ActivityAction>
                                                                                </Catch>
                                                                              </TryCatch.Catches>
                                                                              <TryCatch.Finally>
                                                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2224">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:Boolean">[Status_Sendmail]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                              </TryCatch.Finally>
                                                                            </TryCatch>
                                                                          </If.Then>
                                                                        </If>
                                                                      </If.Then>
                                                                    </If>
                                                                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="676,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_810" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                        <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.server_nt SET Date = '"+DateTime.Now.ToString+"', RobotName = '',WARNING = '',FileName='' WHERE ServerName = '"+IP_Address+"'"]</InArgument>
                                                                        <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                    </ui:InvokeWorkflowFile>
                                                                    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="676,98" sap2010:WorkflowViewState.IdRef="MultipleAssign_314">
                                                                      <ui:MultipleAssign.AssignOperations>
                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_971">
                                                                            <ui:AssignOperation.To>
                                                                              <OutArgument x:TypeArguments="x:String">[EndDay_SQL]</OutArgument>
                                                                            </ui:AssignOperation.To>
                                                                            <ui:AssignOperation.Value>
                                                                              <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString]</InArgument>
                                                                            </ui:AssignOperation.Value>
                                                                          </ui:AssignOperation>
                                                                        </scg:List>
                                                                      </ui:MultipleAssign.AssignOperations>
                                                                    </ui:MultipleAssign>
                                                                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="676,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_811" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                        <InArgument x:TypeArguments="x:String" x:Key="Query" xml:space="preserve">["UPDATE RPALIB.robot_log_nt SET Status = '"+EndStatus+"', StartDay = '"+
StartDay_SQL+"', EndDay = '"+EndDay_SQL+"', IpAddress = '"+IP_Address+"' WHERE FileName = '"+FileName+"'"]</InArgument>
                                                                        <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                    </ui:InvokeWorkflowFile>
                                                                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="676,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_812" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                                      <ui:InvokeWorkflowFile.Arguments>
                                                                        <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.robot_name_nt set runFlag='"+dirSavedFile.GetFiles("*.xls*").Count.ToString+"' where name='"+RobotName+"'"]</InArgument>
                                                                        <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                                                      </ui:InvokeWorkflowFile.Arguments>
                                                                    </ui:InvokeWorkflowFile>
                                                                  </Sequence>
                                                                </TryCatch.Try>
                                                                <TryCatch.Catches>
                                                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="761,2506" sap2010:WorkflowViewState.IdRef="Catch`1_135">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ActivityAction x:TypeArguments="s:Exception">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                      </ActivityAction.Argument>
                                                                      <Sequence DisplayName="Write error &amp; close all PGM" sap:VirtualizedContainerService.HintSize="755,2437" sap2010:WorkflowViewState.IdRef="Sequence_1287">
                                                                        <Sequence.Variables>
                                                                          <Variable x:TypeArguments="x:String" Name="ErrorDay" />
                                                                          <Variable x:TypeArguments="x:String" Name="stFileName" />
                                                                        </Sequence.Variables>
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <Assign sap:VirtualizedContainerService.HintSize="713,60" sap2010:WorkflowViewState.IdRef="Assign_2282">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="x:String">[ErrorDay]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString]</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="713,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_800" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                                          <ui:InvokeWorkflowFile.Arguments>
                                                                            <InArgument x:TypeArguments="x:String" x:Key="Query" xml:space="preserve">["INSERT INTO RPALIB.robot_log_error_nt VALUES('"+StartDay_SQL+"','"+ErrorDay+"','"+
RobotName+"','"+Mail_Send+"','"+FileName+"','"+IP_Address+"','"+exception.Message.Replace("'","''")+"')"]</InArgument>
                                                                            <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                                                          </ui:InvokeWorkflowFile.Arguments>
                                                                        </ui:InvokeWorkflowFile>
                                                                        <Sequence DisplayName=" GET SCREENSHOT WHEN ERROR" sap:VirtualizedContainerService.HintSize="713,66" sap2010:WorkflowViewState.IdRef="Sequence_1243">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2227">
                                                                            <Assign.To>
                                                                              <OutArgument x:TypeArguments="x:String">[stFileName]</OutArgument>
                                                                            </Assign.To>
                                                                            <Assign.Value>
                                                                              <InArgument x:TypeArguments="x:String">["H:\_SCANNER\RPA\Error\"+RobotName+"_"+DateTime.Now.ToString("yyyyMMdd_hhmmss")+"_"+IP_Address+".jpg"]</InArgument>
                                                                            </Assign.Value>
                                                                          </Assign>
                                                                          <Sequence DisplayName="Take Screenshot" sap:VirtualizedContainerService.HintSize="262,66" sap2010:WorkflowViewState.IdRef="Sequence_1241">
                                                                            <Sequence.Variables>
                                                                              <Variable x:TypeArguments="ui:Image" Name="imgFile" />
                                                                            </Sequence.Variables>
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <ui:TakeScreenshot WaitBefore="{x:Null}" DisplayName="Take Screenshot" sap:VirtualizedContainerService.HintSize="334,68" sap2010:WorkflowViewState.IdRef="TakeScreenshot_1" Screenshot="[imgFile]">
                                                                              <ui:TakeScreenshot.Target>
                                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" Id="80eba1f3-0b2c-4488-8ddb-51fe7730bb8d">
                                                                                  <ui:Target.TimeoutMS>
                                                                                    <InArgument x:TypeArguments="x:Int32" />
                                                                                  </ui:Target.TimeoutMS>
                                                                                  <ui:Target.WaitForReady>
                                                                                    <InArgument x:TypeArguments="ui:WaitForReady" />
                                                                                  </ui:Target.WaitForReady>
                                                                                </ui:Target>
                                                                              </ui:TakeScreenshot.Target>
                                                                            </ui:TakeScreenshot>
                                                                            <ui:SaveImage DisplayName="Save image____5" FileName="[stFileName]" sap:VirtualizedContainerService.HintSize="334,92" sap2010:WorkflowViewState.IdRef="SaveImage_1" Image="[imgFile]" />
                                                                          </Sequence>
                                                                          <Sequence DisplayName="Convert Image to binary" sap:VirtualizedContainerService.HintSize="262,66" sap2010:WorkflowViewState.IdRef="Sequence_1242">
                                                                            <Sequence.Variables>
                                                                              <Variable x:TypeArguments="s:Byte[]" Name="image" />
                                                                              <Variable x:TypeArguments="x:String" Name="imgStr" />
                                                                            </Sequence.Variables>
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_2228">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="s:Byte[]">[image]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="s:Byte[]">[system.IO.File.ReadAllBytes(stFileName)]</InArgument>
                                                                              </Assign.Value>
                                                                            </Assign>
                                                                            <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_2229">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="x:String">[imgStr]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="x:String">[Convert.ToBase64String(image)]</InArgument>
                                                                              </Assign.Value>
                                                                            </Assign>
                                                                            <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_2230">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="x:String">[imgStr]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="x:String">["&lt;img src='data:image/jpeg;base64,"+imgStr+"'&gt;"]</InArgument>
                                                                              </Assign.Value>
                                                                            </Assign>
                                                                            <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="334,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_315">
                                                                              <ui:MultipleAssign.AssignOperations>
                                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_972">
                                                                                    <ui:AssignOperation.To>
                                                                                      <OutArgument x:TypeArguments="x:String">[EndMessage]</OutArgument>
                                                                                    </ui:AssignOperation.To>
                                                                                    <ui:AssignOperation.Value>
                                                                                      <InArgument x:TypeArguments="x:String">[EndMessage+"&lt;p&gt; Error: "+ exception.ToString +" &lt;/p&gt;" + "&lt;p&gt;"+imgStr+"&lt;/p&gt;"]</InArgument>
                                                                                    </ui:AssignOperation.Value>
                                                                                  </ui:AssignOperation>
                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_973">
                                                                                    <ui:AssignOperation.To>
                                                                                      <OutArgument x:TypeArguments="x:String">[EndStatus]</OutArgument>
                                                                                    </ui:AssignOperation.To>
                                                                                    <ui:AssignOperation.Value>
                                                                                      <InArgument x:TypeArguments="x:String">ERROR</InArgument>
                                                                                    </ui:AssignOperation.Value>
                                                                                  </ui:AssignOperation>
                                                                                </scg:List>
                                                                              </ui:MultipleAssign.AssignOperations>
                                                                            </ui:MultipleAssign>
                                                                          </Sequence>
                                                                        </Sequence>
                                                                        <ui:WriteTextFile DisplayName="Write Text File" FileName="[&quot;H:\_SCANNER\RPA\Error\&quot;+RobotName+&quot;_&quot;+DateTime.Now.ToString(&quot;yyyyMMdd_hhmmss&quot;)+&quot;_&quot;+IP_Address+&quot;.txt&quot;]" sap:VirtualizedContainerService.HintSize="713,132" sap2010:WorkflowViewState.IdRef="WriteTextFile_1" Text="[exception.ToString]" />
                                                                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="713,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_772" UnSafe="False" WorkflowFileName="REFRESH FUNCTION.xaml">
                                                                          <ui:InvokeWorkflowFile.Arguments>
                                                                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                                          </ui:InvokeWorkflowFile.Arguments>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </ui:InvokeWorkflowFile>
                                                                        <Sequence DisplayName="MOVE FILE TO INPUT" sap:VirtualizedContainerService.HintSize="713,1663" sap2010:WorkflowViewState.IdRef="Sequence_1281">
                                                                          <Sequence.Variables>
                                                                            <Variable x:TypeArguments="x:Boolean" Name="moveFile" />
                                                                            <Variable x:TypeArguments="s:String[]" Name="arrRobotName" />
                                                                            <Variable x:TypeArguments="x:String" Name="errorMess" />
                                                                            <Variable x:TypeArguments="sd:DataTable" Name="dtAuto" />
                                                                          </Sequence.Variables>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <Assign sap:VirtualizedContainerService.HintSize="671,60" sap2010:WorkflowViewState.IdRef="Assign_2266">
                                                                            <Assign.To>
                                                                              <OutArgument x:TypeArguments="x:Boolean">[moveFile]</OutArgument>
                                                                            </Assign.To>
                                                                            <Assign.Value>
                                                                              <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                                                            </Assign.Value>
                                                                          </Assign>
                                                                          <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Lấy Mail bộ phận RPA" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="671,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_768" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                                            <ui:InvokeWorkflowFile.Arguments>
                                                                              <InArgument x:TypeArguments="x:String" x:Key="Query" xml:space="preserve">["SELECT FunctionList FROM RPALIB.AUTO_RUN WHERE '"+exception.Message.ToString.Replace("'","''")+"'  LIKE NameError || '%'"]</InArgument>
                                                                              <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dtAuto]</OutArgument>
                                                                            </ui:InvokeWorkflowFile.Arguments>
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                          </ui:InvokeWorkflowFile>
                                                                          <If Condition="[dtAuto.Rows.Count&gt;0]" DisplayName="If AUTORUN" sap:VirtualizedContainerService.HintSize="671,51" sap2010:WorkflowViewState.IdRef="If_808">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <If.Then>
                                                                              <Sequence sap:VirtualizedContainerService.HintSize="326,324" sap2010:WorkflowViewState.IdRef="Sequence_1279">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <p:SplitString DisplayName="Split string" sap:VirtualizedContainerService.HintSize="284,132" sap2010:WorkflowViewState.IdRef="SplitString_3" Input="[dtAuto.Rows(0)(0).ToString.Trim]" Result="[arrRobotName]" Separator="," StringSplitOptions="RemoveEmptyEntries" />
                                                                                <Assign sap:VirtualizedContainerService.HintSize="284,60" sap2010:WorkflowViewState.IdRef="Assign_2267">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:Boolean">[moveFile]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:Boolean">[arrRobotName.Contains(RobotName)]</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                              </Sequence>
                                                                            </If.Then>
                                                                          </If>
                                                                          <If Condition="[RobotName.IndexOf(&quot;PRINT DELIVERY NOTE&quot;)=0 AND exception.Message.ToUpper.Contains(&quot;TERMINAL&quot;) AND exception.Message.ToUpper.Contains(&quot;ERROR&quot;)]" DisplayName="If PRINT DELIVERY NOTE" sap:VirtualizedContainerService.HintSize="671,51" sap2010:WorkflowViewState.IdRef="If_809">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <If.Then>
                                                                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2268">
                                                                                <Assign.To>
                                                                                  <OutArgument x:TypeArguments="x:Boolean">[moveFile]</OutArgument>
                                                                                </Assign.To>
                                                                                <Assign.Value>
                                                                                  <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                                </Assign.Value>
                                                                              </Assign>
                                                                            </If.Then>
                                                                          </If>
                                                                          <If Condition="[RobotName.IndexOf(&quot;EXTRACT EAP&quot;)=0]" DisplayName="If EXTRACT EAP" sap:VirtualizedContainerService.HintSize="671,51" sap2010:WorkflowViewState.IdRef="If_820">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <If.Then>
                                                                              <Sequence DisplayName="CHECK LOG" sap:VirtualizedContainerService.HintSize="611,662" sap2010:WorkflowViewState.IdRef="Sequence_1338">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <Assign sap:VirtualizedContainerService.HintSize="569,60" sap2010:WorkflowViewState.IdRef="Assign_2317">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:String">["Select COUNT(*) From RPALIB.ROBOT_LOG_ERROR_NT Where FILENAME='(1)'"]</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                                <Assign sap:VirtualizedContainerService.HintSize="569,60" sap2010:WorkflowViewState.IdRef="Assign_2318">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:String">[strSQL]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:String">[strSQL.Replace("(1)","MOVED: "+ FileName)]</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Check Log" sap:VirtualizedContainerService.HintSize="569,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_820" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                                                  <ui:InvokeWorkflowFile.Arguments>
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="Query">[strSQL]</InArgument>
                                                                                    <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dtTemp]</OutArgument>
                                                                                  </ui:InvokeWorkflowFile.Arguments>
                                                                                </ui:InvokeWorkflowFile>
                                                                                <If Condition="[Int32.Parse(dtTemp.Rows(0)(0).ToString) &gt; 2]" sap:VirtualizedContainerService.HintSize="569,218" sap2010:WorkflowViewState.IdRef="If_832">
                                                                                  <If.Then>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2285">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:Boolean">[moveFile]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </If.Then>
                                                                                  <If.Else>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2319">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:Boolean">[moveFile]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </If.Else>
                                                                                </If>
                                                                              </Sequence>
                                                                            </If.Then>
                                                                          </If>
                                                                          <If Condition="[moveFile]" DisplayName="If move to INPUT" sap:VirtualizedContainerService.HintSize="671,1015" sap2010:WorkflowViewState.IdRef="If_810">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <If.Then>
                                                                              <Sequence sap:VirtualizedContainerService.HintSize="426,857" sap2010:WorkflowViewState.IdRef="Sequence_1280">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <ui:MoveFile ContinueOnError="{x:Null}" Destination="[Path_File+left(TimeStamp,6)+&quot;\&quot;+RobotName+&quot;\Input\&quot;+FileName]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="MoveFile_21" Overwrite="True" Path="[Path_File+left(TimeStamp,6)+&quot;\&quot;+RobotName+&quot;\Output\&quot;+FileName]" />
                                                                                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="384,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_801" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                                                  <ui:InvokeWorkflowFile.Arguments>
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.robot_name_nt set runFlag='"+dirSavedFile.GetFiles("*.xls*").Count.ToString+"' where name='"+RobotName+"'"]</InArgument>
                                                                                    <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                                                                  </ui:InvokeWorkflowFile.Arguments>
                                                                                </ui:InvokeWorkflowFile>
                                                                                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="384,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_802" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                                                  <ui:InvokeWorkflowFile.Arguments>
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="Query" xml:space="preserve">["UPDATE RPALIB.robot_log_error_nt SET FileName='MOVED: "+ FileName+"' WHERE StartDay='"+StartDay_SQL+"' AND ErrorDay='"+ErrorDay+"' AND ProcessName='"+
RobotName+"' AND UserName='"+Mail_Send+"' AND IpAddress='"+IP_Address+"'"]</InArgument>
                                                                                    <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                                                                  </ui:InvokeWorkflowFile.Arguments>
                                                                                </ui:InvokeWorkflowFile>
                                                                                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="384,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_803" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                                                                  <ui:InvokeWorkflowFile.Arguments>
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="Query" xml:space="preserve">["UPDATE RPALIB.robot_log_nt SET Status='MOVED' WHERE FileName='"+FileName+"' AND ProcessName='"+
RobotName+"' AND UserName='"+Mail_Send+"' AND IpAddress='"+IP_Address+"'"]</InArgument>
                                                                                    <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                                                                  </ui:InvokeWorkflowFile.Arguments>
                                                                                </ui:InvokeWorkflowFile>
                                                                                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Moved to INPUT" sap:VirtualizedContainerService.HintSize="384,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_804" UnSafe="False" WorkflowFileName="Template\WORKFLOW - SEND MAIL FOR RPA TEAM.xaml">
                                                                                  <ui:InvokeWorkflowFile.Arguments>
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="mail_Subject">["[RPA] MOVED TO INPUT FOLDER: "+RobotName]</InArgument>
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="mail_Content" xml:space="preserve">["&lt;p&gt;&lt;strong&gt;Dear Dev Team,&lt;/strong&gt;&lt;/p&gt;" +
"&lt;p&gt;&lt;/p&gt;&lt;p&gt;Robot xảy ra lỗi bất thường quá trình bị dừng. Đã copy file vào thư mục INPUT để robot tự chạy lại.&lt;/p&gt;" +
"&lt;p&gt;Project : " + RobotName + "&lt;/p&gt;" +
"&lt;p&gt;File name : " + FileName + "&lt;/p&gt;" +
"&lt;p&gt;Machine ROBOT : " + IP_Address + "&lt;/p&gt;" +
"&lt;p&gt;Lỗi ghi nhận : &lt;/p&gt;" +
"&lt;p&gt;--------------------------------------------------&lt;/p&gt;" +
"&lt;p&gt;Activity name : " + exception.Source + "&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" +
"&lt;p&gt;" + exception.Message + "&lt;/p&gt;" + 
"&lt;p&gt;" + exception.ToString + "&lt;/p&gt;"]</InArgument>
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="specialReceiver">[Mail_PIC]</InArgument>
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="mail_CC">
                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                    </InArgument>
                                                                                    <InArgument x:TypeArguments="s:String[]" x:Key="mail_Attach">[{Path_File+left(TimeStamp,6)+"\"+RobotName+"\Input\"+FileName}]</InArgument>
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="mail_BCC">
                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                    </InArgument>
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="RobotName">[RobotName]</InArgument>
                                                                                  </ui:InvokeWorkflowFile.Arguments>
                                                                                </ui:InvokeWorkflowFile>
                                                                              </Sequence>
                                                                            </If.Then>
                                                                            <If.Else>
                                                                              <Sequence sap:VirtualizedContainerService.HintSize="304,258" sap2010:WorkflowViewState.IdRef="Sequence_1315">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <Sequence DisplayName="Send Mail Function" sap:VirtualizedContainerService.HintSize="611,1973" sap2010:WorkflowViewState.IdRef="Sequence_1312">
                                                                                  <Sequence.Variables>
                                                                                    <Variable x:TypeArguments="s:String[]" Name="stTo" />
                                                                                    <Variable x:TypeArguments="x:String" Name="stCC" />
                                                                                    <Variable x:TypeArguments="s:String[]" Name="stBCC" />
                                                                                    <Variable x:TypeArguments="x:String" Name="stBody" />
                                                                                    <Variable x:TypeArguments="x:String" Name="stSubject" />
                                                                                    <Variable x:TypeArguments="s:String[]" Name="stAttColection" />
                                                                                    <Variable x:TypeArguments="sd:DataTable" Name="dtMail" />
                                                                                  </Sequence.Variables>
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <If Condition="[Mail_Send.Contains(&quot;vis_info@ykk.com&quot;)]" sap:VirtualizedContainerService.HintSize="569,218" sap2010:WorkflowViewState.IdRef="If_818">
                                                                                    <If.Then>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2283">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[stCC]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">
                                                                                            <Literal x:TypeArguments="x:String" Value="" />
                                                                                          </InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                    </If.Then>
                                                                                    <If.Else>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2286">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[stCC]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">[Mail_Send]</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                    </If.Else>
                                                                                  </If>
                                                                                  <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="569,160" sap2010:WorkflowViewState.IdRef="MultipleAssign_318">
                                                                                    <ui:MultipleAssign.AssignOperations>
                                                                                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                        <ui:AssignOperation sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AssignOperation_980">
                                                                                          <ui:AssignOperation.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[stSubject]</OutArgument>
                                                                                          </ui:AssignOperation.To>
                                                                                          <ui:AssignOperation.Value>
                                                                                            <InArgument x:TypeArguments="x:String">["[RPA] Robot Stop Warning: " + RobotName.ToUpper]</InArgument>
                                                                                          </ui:AssignOperation.Value>
                                                                                        </ui:AssignOperation>
                                                                                        <ui:AssignOperation sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AssignOperation_981">
                                                                                          <ui:AssignOperation.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[stBody]</OutArgument>
                                                                                          </ui:AssignOperation.To>
                                                                                          <ui:AssignOperation.Value>
                                                                                            <InArgument x:TypeArguments="x:String" xml:space="preserve">["&lt;p&gt;&lt;strong&gt;Dear Dev Team,&lt;/strong&gt;&lt;/p&gt;" +
"&lt;p&gt;&lt;/p&gt;&lt;p&gt;Robot xảy ra lỗi bất thường quá trình bị dừng. Vui lòng kiểm tra lại&lt;/p&gt;" +
"&lt;p&gt;Project : " + RobotName + "&lt;/p&gt;" +
"&lt;p&gt;File name : " + FileName + "&lt;/p&gt;" +
"&lt;p&gt;Machine ROBOT : " + IP_Address + "&lt;/p&gt;" +
"&lt;p&gt;Lỗi ghi nhận : ((2))&lt;/p&gt;" +
"&lt;p&gt;--------------------------------------------------&lt;/p&gt;" +
"&lt;p&gt;Activity name : " + exception.Source + "&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" +
"&lt;p&gt;" + exception.ToString + "&lt;/p&gt;((1))"]</InArgument>
                                                                                          </ui:AssignOperation.Value>
                                                                                        </ui:AssignOperation>
                                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_982">
                                                                                          <ui:AssignOperation.To>
                                                                                            <OutArgument x:TypeArguments="s:String[]">[stAttColection]</OutArgument>
                                                                                          </ui:AssignOperation.To>
                                                                                          <ui:AssignOperation.Value>
                                                                                            <InArgument x:TypeArguments="s:String[]">[{Path_File+left(TimeStamp,6)+"\"+RobotName+"\Output\"+FileName}]</InArgument>
                                                                                          </ui:AssignOperation.Value>
                                                                                        </ui:AssignOperation>
                                                                                      </scg:List>
                                                                                    </ui:MultipleAssign.AssignOperations>
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                  </ui:MultipleAssign>
                                                                                  <If Condition="[RobotName.ToUpper = &quot;EXTRACT EAP&quot;]" sap:VirtualizedContainerService.HintSize="569,533" sap2010:WorkflowViewState.IdRef="If_835">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <If.Then>
                                                                                      <Sequence sap:VirtualizedContainerService.HintSize="376,356" sap2010:WorkflowViewState.IdRef="Sequence_1347">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <ui:InvokeCode ContinueOnError="{x:Null}" Code="List&lt;String&gt; myList = new List&lt;String&gt;();&#xA;&#xA;foreach (string attFile in arrResult)&#xA;{&#xA;&#x9;myList.Add(attFile);&#xA;}&#xA;&#xA;for (int i=0;i &lt; arrFolder.Length;i++)&#xA;{&#x9;&#xA;&#x9;string path = arrFolder[i];&#xA;&#x9;if(System.IO.Directory.Exists(path))&#xA;&#x9;{&#xA;&#x9;   foreach (string attFile in System.IO.Directory.GetFiles(path))&#xA;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;Console.WriteLine(attFile);&#xA;&#x9;&#x9;&#x9;&#x9;myList.Add(attFile);&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;arrResult = myList.ToArray();" DisplayName="Invoke code" sap:VirtualizedContainerService.HintSize="334,164" sap2010:WorkflowViewState.IdRef="InvokeCode_1" Language="CSharp">
                                                                                          <ui:InvokeCode.Arguments>
                                                                                            <InOutArgument x:TypeArguments="s:String[]" x:Key="arrResult">[stAttColection]</InOutArgument>
                                                                                            <InArgument x:TypeArguments="s:String[]" x:Key="arrFolder">[{"C:\Attach Files\",Path_Downloads}]</InArgument>
                                                                                          </ui:InvokeCode.Arguments>
                                                                                        </ui:InvokeCode>
                                                                                        <Assign sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_2320">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="s:String[]">[stAttColection]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="s:String[]">[System.IO.Directory.GetFiles(Path_Downloads,"*.xls*")]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                      </Sequence>
                                                                                    </If.Then>
                                                                                    <If.Else>
                                                                                      <Sequence sap2010:WorkflowViewState.IdRef="Sequence_1348">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                      </Sequence>
                                                                                    </If.Else>
                                                                                  </If>
                                                                                  <Sequence DisplayName="IMG1" sap:VirtualizedContainerService.HintSize="569,66" sap2010:WorkflowViewState.IdRef="Sequence_1313">
                                                                                    <Sequence.Variables>
                                                                                      <Variable x:TypeArguments="x:String" Name="image_base64" />
                                                                                    </Sequence.Variables>
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2279">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[image_base64]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[Convert.ToBase64String(System.IO.File.ReadAllBytes(stFileName))]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2280">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[image_base64]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">["&lt;p&gt;&lt;img src='data:image/jpeg;base64,"+ image_base64 + "'&gt;&lt;/p&gt;"]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2281">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[stBody]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[stBody.Replace("((1))",image_base64)]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </Sequence>
                                                                                  <Sequence DisplayName="Check FILE READ ONLY" sap:VirtualizedContainerService.HintSize="569,420" sap2010:WorkflowViewState.IdRef="Sequence_1329">
                                                                                    <Sequence.Variables>
                                                                                      <Variable x:TypeArguments="x:String" Name="errMess" />
                                                                                    </Sequence.Variables>
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign sap:VirtualizedContainerService.HintSize="507,60" sap2010:WorkflowViewState.IdRef="Assign_2308">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[errMess]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[exception.Message.Replace("'","''")]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <If Condition="[errMess.ToString.Replace(&quot;'&quot;,&quot;''&quot;).Contains(&quot; is read only and can not be overwritten. It has been saved as file &quot;) And &#xA;errMess.ToString.IndexOf(&quot;File &quot;) = 0]" sap:VirtualizedContainerService.HintSize="507,228" sap2010:WorkflowViewState.IdRef="If_830">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <If.Then>
                                                                                        <Sequence DisplayName="Check file opening" sap:VirtualizedContainerService.HintSize="376,378" sap2010:WorkflowViewState.IdRef="Sequence_1335">
                                                                                          <Sequence.Variables>
                                                                                            <Variable x:TypeArguments="x:String" Name="fileOpening" />
                                                                                            <Variable x:TypeArguments="x:String" Name="stUser" />
                                                                                            <Variable x:TypeArguments="x:String" Name="variable1" />
                                                                                          </Sequence.Variables>
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <ui:StartProcess Arguments="{x:Null}" WorkingDirectory="{x:Null}" DisplayName="Start Process" FileName="[errMess.Substring(0,errMess.IndexOf(&quot; is read only and can not be overwritten. It has been saved as file &quot;)).Replace(&quot;File &quot;,&quot;&quot;)]" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="StartProcess_1" />
                                                                                          <ui:GetValue ContinueOnError="True" DisplayName="Get Text 'excel.exe  File in Use'" sap:VirtualizedContainerService.HintSize="334,68" sap2010:WorkflowViewState.IdRef="GetValue_1">
                                                                                            <ui:GetValue.Target>
                                                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="44838ed1-184d-440d-b2d0-be8cb2d54a8f" Selector="&lt;wnd app='excel.exe' cls='bosa_sdm_XL9' title='File in Use' /&gt;&lt;ctrl name='by *' role='text' /&gt;" TimeoutMS="5000">
                                                                                                <ui:Target.WaitForReady>
                                                                                                  <InArgument x:TypeArguments="ui:WaitForReady" />
                                                                                                </ui:Target.WaitForReady>
                                                                                              </ui:Target>
                                                                                            </ui:GetValue.Target>
                                                                                            <ui:GetValue.Value>
                                                                                              <OutArgument x:TypeArguments="x:String">[stUser]</OutArgument>
                                                                                            </ui:GetValue.Value>
                                                                                          </ui:GetValue>
                                                                                          <If Condition="[not String.IsNullOrEmpty(stUser)]" DisplayName="If File in use" sap:VirtualizedContainerService.HintSize="611,522" sap2010:WorkflowViewState.IdRef="If_831">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                            <If.Then>
                                                                                              <Sequence sap:VirtualizedContainerService.HintSize="304,364" sap2010:WorkflowViewState.IdRef="Sequence_1334">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2309">
                                                                                                  <Assign.To>
                                                                                                    <OutArgument x:TypeArguments="x:String">[stUser]</OutArgument>
                                                                                                  </Assign.To>
                                                                                                  <Assign.Value>
                                                                                                    <InArgument x:TypeArguments="x:String">[stUser.Replace("by '","").Replace("'.","")]</InArgument>
                                                                                                  </Assign.Value>
                                                                                                </Assign>
                                                                                                <Sequence DisplayName=" GET SCREENSHOT WHEN ERROR" sap:VirtualizedContainerService.HintSize="304,364" sap2010:WorkflowViewState.IdRef="Sequence_1332">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2310">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[fileOpening]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">["H:\_SCANNER\RPA\Error\"+RobotName+"_"+DateTime.Now.ToString("yyyyMMdd_hhmmss")+"_"+IP_Address+".jpg"]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                  <Sequence DisplayName="Take Screenshot" sap:VirtualizedContainerService.HintSize="262,66" sap2010:WorkflowViewState.IdRef="Sequence_1330">
                                                                                                    <Sequence.Variables>
                                                                                                      <Variable x:TypeArguments="ui:Image" Name="imgFile" />
                                                                                                    </Sequence.Variables>
                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                      </scg:Dictionary>
                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                    <ui:TakeScreenshot WaitBefore="{x:Null}" DisplayName="Take Screenshot 'excel.exe  File in Use'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="TakeScreenshot_2" Screenshot="[imgFile]">
                                                                                                      <ui:TakeScreenshot.Target>
                                                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="80eba1f3-0b2c-4488-8ddb-51fe7730bb8d" InformativeScreenshot="12aa52bb30dc36a81b0789d487ff03ef" Selector="&lt;wnd app='excel.exe' cls='bosa_sdm_XL9' title='File in Use' /&gt;" TimeoutMS="3000">
                                                                                                          <ui:Target.WaitForReady>
                                                                                                            <InArgument x:TypeArguments="ui:WaitForReady" />
                                                                                                          </ui:Target.WaitForReady>
                                                                                                        </ui:Target>
                                                                                                      </ui:TakeScreenshot.Target>
                                                                                                    </ui:TakeScreenshot>
                                                                                                    <ui:SaveImage DisplayName="Save image____5" FileName="[fileOpening]" sap:VirtualizedContainerService.HintSize="334,92" sap2010:WorkflowViewState.IdRef="SaveImage_2" Image="[imgFile]" />
                                                                                                  </Sequence>
                                                                                                  <Sequence DisplayName="Convert Image to binary" sap:VirtualizedContainerService.HintSize="262,66" sap2010:WorkflowViewState.IdRef="Sequence_1331">
                                                                                                    <Sequence.Variables>
                                                                                                      <Variable x:TypeArguments="s:Byte[]" Name="image" />
                                                                                                      <Variable x:TypeArguments="x:String" Name="imgStr" />
                                                                                                    </Sequence.Variables>
                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                      </scg:Dictionary>
                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2311">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="s:Byte[]">[image]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="s:Byte[]">[system.IO.File.ReadAllBytes(fileOpening)]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2312">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[imgStr]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[Convert.ToBase64String(image)]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2313">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[imgStr]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">["&lt;img src='data:image/jpeg;base64,"+imgStr+"'&gt;"]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2314">
                                                                                                      <Assign.To>
                                                                                                        <OutArgument x:TypeArguments="x:String">[stBody]</OutArgument>
                                                                                                      </Assign.To>
                                                                                                      <Assign.Value>
                                                                                                        <InArgument x:TypeArguments="x:String">[stBody.Replace("((2))","&lt;/br&gt;" +imgStr)]</InArgument>
                                                                                                      </Assign.Value>
                                                                                                    </Assign>
                                                                                                  </Sequence>
                                                                                                </Sequence>
                                                                                                <Sequence DisplayName="Close Excel" sap:VirtualizedContainerService.HintSize="262,66" sap2010:WorkflowViewState.IdRef="Sequence_1333">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" SimulateClick="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'push button  Cancel'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_1" KeyModifiers="None" MouseButton="BTN_LEFT">
                                                                                                    <ui:Click.CursorPosition>
                                                                                                      <ui:CursorPosition Position="Center">
                                                                                                        <ui:CursorPosition.OffsetX>
                                                                                                          <InArgument x:TypeArguments="x:Int32" />
                                                                                                        </ui:CursorPosition.OffsetX>
                                                                                                        <ui:CursorPosition.OffsetY>
                                                                                                          <InArgument x:TypeArguments="x:Int32" />
                                                                                                        </ui:CursorPosition.OffsetY>
                                                                                                      </ui:CursorPosition>
                                                                                                    </ui:Click.CursorPosition>
                                                                                                    <ui:Click.Target>
                                                                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="d2015e58-04c8-4b0a-be4b-1bd97c14564b" InformativeScreenshot="17b57e476c8f48bf54c820e28df7e053" Selector="&lt;wnd app='excel.exe' cls='bosa_sdm_XL9' title='File in Use' /&gt;&lt;ctrl name='Cancel' role='push button' /&gt;">
                                                                                                        <ui:Target.TimeoutMS>
                                                                                                          <InArgument x:TypeArguments="x:Int32" />
                                                                                                        </ui:Target.TimeoutMS>
                                                                                                        <ui:Target.WaitForReady>
                                                                                                          <InArgument x:TypeArguments="ui:WaitForReady" />
                                                                                                        </ui:Target.WaitForReady>
                                                                                                      </ui:Target>
                                                                                                    </ui:Click.Target>
                                                                                                  </ui:Click>
                                                                                                  <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" SimulateClick="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'Button  Close'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_2" KeyModifiers="None" MouseButton="BTN_LEFT">
                                                                                                    <ui:Click.CursorPosition>
                                                                                                      <ui:CursorPosition Position="Center">
                                                                                                        <ui:CursorPosition.OffsetX>
                                                                                                          <InArgument x:TypeArguments="x:Int32" />
                                                                                                        </ui:CursorPosition.OffsetX>
                                                                                                        <ui:CursorPosition.OffsetY>
                                                                                                          <InArgument x:TypeArguments="x:Int32" />
                                                                                                        </ui:CursorPosition.OffsetY>
                                                                                                      </ui:CursorPosition>
                                                                                                    </ui:Click.CursorPosition>
                                                                                                    <ui:Click.Target>
                                                                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="ec4bdd5b-4be6-4d95-9710-ec0083726197" InformativeScreenshot="a3e2f0018d471d2a4e9aac9599751bee" Selector="&lt;wnd app='excel.exe' cls='XLMAIN' title='Book*' /&gt;&lt;uia cls='MsoCommandBar' helpText='Ribbon toolbar' /&gt;&lt;uia cls='NetUIAppFrameHelper' name='Close' /&gt;">
                                                                                                        <ui:Target.TimeoutMS>
                                                                                                          <InArgument x:TypeArguments="x:Int32" />
                                                                                                        </ui:Target.TimeoutMS>
                                                                                                        <ui:Target.WaitForReady>
                                                                                                          <InArgument x:TypeArguments="ui:WaitForReady" />
                                                                                                        </ui:Target.WaitForReady>
                                                                                                      </ui:Target>
                                                                                                    </ui:Click.Target>
                                                                                                  </ui:Click>
                                                                                                </Sequence>
                                                                                              </Sequence>
                                                                                            </If.Then>
                                                                                            <If.Else>
                                                                                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2316">
                                                                                                <Assign.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[stBody]</OutArgument>
                                                                                                </Assign.To>
                                                                                                <Assign.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">[stBody.Replace("((2))","")]</InArgument>
                                                                                                </Assign.Value>
                                                                                              </Assign>
                                                                                            </If.Else>
                                                                                          </If>
                                                                                        </Sequence>
                                                                                      </If.Then>
                                                                                      <If.Else>
                                                                                        <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2315">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[stBody]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[stBody.Replace("((2))","")]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                      </If.Else>
                                                                                    </If>
                                                                                  </Sequence>
                                                                                  <ui:AppendLine DisplayName="Append Line" FileName="[&quot;C:\&quot; + DateTime.Now.ToString(&quot;yyyyMMdd&quot;)+&quot;_ERR.txt&quot;]" sap:VirtualizedContainerService.HintSize="569,132" sap2010:WorkflowViewState.IdRef="AppendLine_1" Text="[DateTime.Now.ToString +&quot;: &quot; + RobotName + Environment.NewLine + exception.ToString]" UseDefaultEncoding="False" />
                                                                                  <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Error email" sap:VirtualizedContainerService.HintSize="569,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_805" UnSafe="False" WorkflowFileName="Template\WORKFLOW - SEND MAIL FOR RPA TEAM.xaml">
                                                                                    <ui:InvokeWorkflowFile.Arguments>
                                                                                      <InArgument x:TypeArguments="x:String" x:Key="mail_Subject">[stSubject]</InArgument>
                                                                                      <InArgument x:TypeArguments="x:String" x:Key="mail_Content">[stBody]</InArgument>
                                                                                      <InArgument x:TypeArguments="x:String" x:Key="specialReceiver">[Mail_PIC]</InArgument>
                                                                                      <InArgument x:TypeArguments="x:String" x:Key="mail_CC">[stCC]</InArgument>
                                                                                      <InArgument x:TypeArguments="s:String[]" x:Key="mail_Attach">[stAttColection]</InArgument>
                                                                                      <InArgument x:TypeArguments="x:String" x:Key="mail_BCC">
                                                                                        <Literal x:TypeArguments="x:String" Value="" />
                                                                                      </InArgument>
                                                                                      <InArgument x:TypeArguments="x:String" x:Key="RobotName">[RobotName]</InArgument>
                                                                                    </ui:InvokeWorkflowFile.Arguments>
                                                                                  </ui:InvokeWorkflowFile>
                                                                                </Sequence>
                                                                                <Assign DisplayName="Lock send mail function" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2231">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:String">[SendMail]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                    </InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                              </Sequence>
                                                                            </If.Else>
                                                                          </If>
                                                                        </Sequence>
                                                                      </Sequence>
                                                                    </ActivityAction>
                                                                  </Catch>
                                                                </TryCatch.Catches>
                                                              </TryCatch>
                                                            </Sequence>
                                                          </If.Then>
                                                        </If>
                                                      </Sequence>
                                                    </If.Then>
                                                    <If.Else>
                                                      <Sequence sap:VirtualizedContainerService.HintSize="421,356" sap2010:WorkflowViewState.IdRef="Sequence_1336">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke WORKFLOW - GET USERNAME FROM HR BY EMAIL workflow" sap:VirtualizedContainerService.HintSize="379,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_817" UnSafe="False" WorkflowFileName="Template\WORKFLOW - GET USERNAME FROM HR BY EMAIL.xaml">
                                                          <ui:InvokeWorkflowFile.Arguments>
                                                            <InArgument x:TypeArguments="x:String" x:Key="stUserEmail">[Mail_Send]</InArgument>
                                                            <OutArgument x:TypeArguments="x:String" x:Key="stUserName">[stUserName]</OutArgument>
                                                          </ui:InvokeWorkflowFile.Arguments>
                                                        </ui:InvokeWorkflowFile>
                                                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="If send mail maintainer" sap:VirtualizedContainerService.HintSize="379,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_794" UnSafe="False" WorkflowFileName="Template\WORKFLOW - SEND MAIL FOR RPA TEAM.xaml">
                                                          <ui:InvokeWorkflowFile.Arguments>
                                                            <InArgument x:TypeArguments="x:String" x:Key="mail_Subject">["[RPA] MAINTAINER : " + RobotName]</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="mail_Content" xml:space="preserve">["&lt;p&gt;&lt;b&gt;Dear "+ stUserName +" san,&lt;/b&gt;&lt;/p&gt;" + 
"&lt;p&gt;Hiện tại Robot đang tạm dừng để bảo trì hệ thống&lt;br/&gt;Xin vui lòng kiểm thực hiện công việc thủ công. &lt;br/&gt;Cảm ơn !&lt;/p&gt;"]</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="specialReceiver">[Mail_Send]</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="mail_CC">[MailCC]</InArgument>
                                                            <InArgument x:TypeArguments="s:String[]" x:Key="mail_Attach">[{Path_File+left(TimeStamp,6)+"\"+RobotName+"\Output\"+FileName}]</InArgument>
                                                          </ui:InvokeWorkflowFile.Arguments>
                                                        </ui:InvokeWorkflowFile>
                                                      </Sequence>
                                                    </If.Else>
                                                  </If>
                                                </Sequence>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ForEach.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ForEach>
                                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="1663,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_775" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="Query">["UPDATE RPALIB.robot_name_nt set runFlag='' where name='"+RobotName+"'"]</InArgument>
                                            <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                          </ui:InvokeWorkflowFile.Arguments>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:InvokeWorkflowFile>
                                        <If Condition="[stopFlag]" sap:VirtualizedContainerService.HintSize="1663,237" sap2010:WorkflowViewState.IdRef="If_816">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <ui:Break sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Break_2" />
                                          </If.Then>
                                        </If>
                                      </Sequence>
                                    </Sequence>
                                  </Sequence>
                                </ActivityAction>
                              </ui:ForEachRow.Body>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:ForEachRow>
                          </Sequence>
                        </Sequence>
                      </TryCatch.Try>
                      <TryCatch.Catches>
                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="1927,21" sap2010:WorkflowViewState.IdRef="Catch`1_1">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ActivityAction x:TypeArguments="s:Exception">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="Function Refresh" sap:VirtualizedContainerService.HintSize="376,356" sap2010:WorkflowViewState.IdRef="Sequence_1295">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_813" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <InArgument x:TypeArguments="x:String" x:Key="Query" xml:space="preserve">["INSERT INTO RPALIB.robot_log_error_nt VALUES('"+StartDay_SQL+"','"+DateTime.Now.ToString+"','"+
RobotName+"','"+Mail_Send+"','"+FileName+"','"+IP_Address+"','"+
"ProcessMailError_" + exception.Message.Replace("'","''") +
"____" + exception.Source.Replace("'","''") +
"____" + exception.ToString.Replace("'","''") +"')"]</InArgument>
                                  <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result" />
                                </ui:InvokeWorkflowFile.Arguments>
                              </ui:InvokeWorkflowFile>
                              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_771" UnSafe="False" WorkflowFileName="REFRESH FUNCTION.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                </ui:InvokeWorkflowFile.Arguments>
                              </ui:InvokeWorkflowFile>
                            </Sequence>
                          </ActivityAction>
                        </Catch>
                      </TryCatch.Catches>
                    </TryCatch>
                  </Sequence>
                  <FlowStep.Next>
                    <FlowStep x:Name="__ReferenceID9">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">190,503</av:Point>
                          <av:Size x:Key="ShapeSize">200,66</av:Size>
                          <av:PointCollection x:Key="ConnectorLocation">290,569 290,603</av:PointCollection>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Sequence DisplayName="Check mail robot" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1360">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="sd:DataTable" Name="dt_MailAddress" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Get IP Server checking mail robot" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="484,143" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_831" UnSafe="False" WorkflowFileName="Connect SQL.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <InArgument x:TypeArguments="x:String" x:Key="Query">SELECT SERVERNAME FROM RPALIB.SERVER_NT WHERE ROBOTNAME='CHECKING MAIL ROBOT...' ORDER BY WARNING LIMIT 1</InArgument>
                            <OutArgument x:TypeArguments="sd:DataTable" x:Key="dt_Result">[dt_MailAddress]</OutArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:InvokeWorkflowFile>
                        <If Condition="[dt_MailAddress.Rows.Count &lt; 1]" DisplayName="If don't have server checking mail" sap:VirtualizedContainerService.HintSize="484,289" sap2010:WorkflowViewState.IdRef="If_841">
                          <If.Then>
                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke MailServer workflow" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_832" UnSafe="False" WorkflowFileName="MailServer.xaml">
                              <ui:InvokeWorkflowFile.Arguments>
                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                              </ui:InvokeWorkflowFile.Arguments>
                            </ui:InvokeWorkflowFile>
                          </If.Then>
                          <If.Else>
                            <Sequence sap2010:WorkflowViewState.IdRef="Sequence_1359">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </Sequence>
                          </If.Else>
                        </If>
                      </Sequence>
                      <FlowStep.Next>
                        <FlowStep x:Name="__ReferenceID8">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">190,603</av:Point>
                              <av:Size x:Key="ShapeSize">200,51</av:Size>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke WORKFLOW - RUN QUERY BY SCHEDULE workflow" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_830" UnSafe="False" WorkflowFileName="Template\WORKFLOW - RUN QUERY BY SCHEDULE.xaml">
                            <ui:InvokeWorkflowFile.Arguments>
                              <scg:Dictionary x:TypeArguments="x:String, Argument" />
                            </ui:InvokeWorkflowFile.Arguments>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:InvokeWorkflowFile>
                        </FlowStep>
                      </FlowStep.Next>
                    </FlowStep>
                  </FlowStep.Next>
                </FlowStep>
              </FlowStep.Next>
            </FlowStep>
          </FlowStep.Next>
        </FlowStep>
      </FlowStep.Next>
    </FlowStep>
    <x:Reference>__ReferenceID5</x:Reference>
    <x:Reference>__ReferenceID6</x:Reference>
    <x:Reference>__ReferenceID7</x:Reference>
    <x:Reference>__ReferenceID8</x:Reference>
    <x:Reference>__ReferenceID9</x:Reference>
  </Flowchart>
</Activity>